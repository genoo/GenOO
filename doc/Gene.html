<head>
<!-- Generated by perlmod2www.pl -->
<title>
Gene documentation.
</title>
<link rel="stylesheet" type="text/css" href="perl.css">
</head>
<body bgcolor="white">
<span id="modRootPath">GenOO</span>
<span id="modName">Gene</span>
<div id="sep"></div>
<a name="TOP" id="TOP"></a>
<table id="daArea" width="100%"><tr><td id="daEntry" ><a href="#SUMMARY">Summary</a></td><td id="daEntry" ><a href="#libs">Included libraries</a></td><td id="daEntry" ><a href="#vardefs">Package variables</a></td><td id="daEntry" ><a href="#SYNOPSIS">Synopsis</a></td><td id="daEntry" ><a href="#DESCRIPTION">Description</a></td><td id="daEntry" ><a href="#General">General documentation</a></td><td id="daEntry" ><a href="#Methods">Methods</a></td></tr></table>
<div id="sep"></div>
<div id="descTitle">Summary</div>
<div id="descArea"><B>GenOO::Gene</B> - Gene object, with features</div>
<div id="sep"></div>
<a name="vardefs" id="vardefs"></a><div id="descTitle">Package variables</div>
<div id="descArea"><div id="libEntry"><div id="descSubTitle">Privates (from <b>"my"</b> definitions)</div>
</div>
<div id="libEntry"><span id="var">%all_gene_ensgids</span>;</div>
<div id="libEntry"><span id="var">%all_gene_names</span>;</div>
<div id="libEntry"><span id="var">$DBconnector</span>;</div>
<div id="libEntry"><span id="var">$accessPolicy</span> = <span id="module"><a href="DBconnector.html">GenOO::DBconnector</a></span>-&gt;<span id="method">global_access</span><span id="braces">(</span><span id="braces">)</span></div>
<div id="libEntry"><span id="var">%all_gene_ids</span>;</div>
<div id="libEntry"><span id="var">$select_all_from_genes_where_ensgid</span>;</div>
<div id="libEntry"><span id="var">$select_all_from_genes_where_ensgid_Query</span> = <span id="perlFunc">qq</span><span id="dqStr">/<span id="regExp">/</span>/</span>SELECT * FROM diana_protein_genes WHERE diana_protein_genes.ensgid=?/</div>
</div>
<div id="sep"></div>
<div id="descTitle">Included modules</div>
<div id="descArea"><div id="libEntry"><span id="use"><a href="DBconnector.html">GenOO::DBconnector</a></span> </div>
<div id="libEntry"><span id="use"><a href="Helper/Locus.html">GenOO::Helper::Locus</a></span> </div>
<div id="libEntry"><span id="use">Object::ID</span> </div>
</div>
<div id="sep"></div>
<a name="libs" id="libs"></a>
<div id="descTitle">Inherit</div>
<div id="descArea"><span id="isa"><a href="Locus.html">GenOO::Locus</a></span> </div>
<div id="sep"></div>
<a name="SYNOPSIS" id="SYNOPSIS"></a>
<div id="descTitle">Synopsis</div>
<div id="descArea"><pre id="podParagraph">    # This is the main gene object
    # It represents a gene (a genomic region and a collection of transcripts)
    
    # To initialize 
    my $transcript = GenOO::Transcript->new({
        INTERNAL_ID    => undef,
        SPECIES        => undef,
        STRAND         => undef,
        CHR            => undef,
        START          => undef,
        STOP           => undef,
        ENSGID         => undef,
        NAME           => undef,
        REFSEQ         => undef,
        TRANSCRIPTS    => undef, # [] reference to array of gene objects
        DESCRIPTION    => undef,
        EXTRA_INFO     => undef,
    });</pre>
</div>
<div id="sep"></div>
<a name="DESCRIPTION" id="DESCRIPTION"></a>
<div id="descTitle">Description</div>
<div id="descArea"><pre id="podParagraph">    <B>GenOO::Gene</B> describes a gene. A gene is defined as a locus and as a collection of transcript. This means that it has
    genomic location attributes which are set in respect to the start and stop positions of its contained transcripts. 
    Whenever a transcript is added to a gene object the genomic coordinates of the gene are automatically updated. 
    It is not clear if the gene should have attributes like the biotype as it is not definite whether its contained
    transcripts would all have the same biotype or not.
    Whenever a gene object is created a unique id is associated with the object until it gets out of scope.</pre>
</div>
<div id="sep"></div>
<a name="Methods" id="Methods"></a>
<div id="descTitle">Methods</div>
<table id="methIndArea" width="100%" cellspacing="0"><tr><td id="methIndEntry">_add_to_all</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE1">Code</a></td></tr>
<tr><td id="methIndEntry">_delete_from_all</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE2">Code</a></td></tr>
<tr><td id="methIndEntry">_init</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE3">Code</a></td></tr>
<tr><td id="methIndEntry">_read_file_with_descriptions</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE4">Code</a></td></tr>
<tr><td id="methIndEntry">_read_file_with_names</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE5">Code</a></td></tr>
<tr><td id="methIndEntry">_read_file_with_refseqs</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE6">Code</a></td></tr>
<tr><td id="methIndEntry">add_refseq</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE7">Code</a></td></tr>
<tr><td id="methIndEntry">add_transcript</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE8">Code</a></td></tr>
<tr><td id="methIndEntry">allow_database_access</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE9">Code</a></td></tr>
<tr><td id="methIndEntry">annotate_constitutive_coding_exons</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE10">Code</a></td></tr>
<tr><td id="methIndEntry">annotate_constitutive_exons</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE11">Code</a></td></tr>
<tr><td id="methIndEntry">create_new_gene_from_database</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE12">Code</a></td></tr>
<tr><td id="methIndEntry">database_access</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE13">Code</a></td></tr>
<tr><td id="methIndEntry">delete_all</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE14">Code</a></td></tr>
<tr><td id="methIndEntry">deny_database_access</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE15">Code</a></td></tr>
<tr><td id="methIndEntry">get_all</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE16">Code</a></td></tr>
<tr><td id="methIndEntry">get_by_ensgid</td><td id="methIndEntry"><a href="#POD1">Description</a></td><td id="methIndEntry"><a href="#CODE17">Code</a></td></tr>
<tr><td id="methIndEntry">get_by_id</td><td id="methIndEntry"><a href="#POD2">Description</a></td><td id="methIndEntry"><a href="#CODE18">Code</a></td></tr>
<tr><td id="methIndEntry">get_by_name</td><td id="methIndEntry"><a href="#POD3">Description</a></td><td id="methIndEntry"><a href="#CODE19">Code</a></td></tr>
<tr><td id="methIndEntry">get_coding_transcripts</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE20">Code</a></td></tr>
<tr><td id="methIndEntry">get_constitutive_coding_exons</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE21">Code</a></td></tr>
<tr><td id="methIndEntry">get_constitutive_exons</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE22">Code</a></td></tr>
<tr><td id="methIndEntry">get_db_connector</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE23">Code</a></td></tr>
<tr><td id="methIndEntry">get_description</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE24">Code</a></td></tr>
<tr><td id="methIndEntry">get_ensgid</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE25">Code</a></td></tr>
<tr><td id="methIndEntry">get_exon_length</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE26">Code</a></td></tr>
<tr><td id="methIndEntry">get_id</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE27">Code</a></td></tr>
<tr><td id="methIndEntry">get_internalID</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE28">Code</a></td></tr>
<tr><td id="methIndEntry">get_merged_exons</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE29">Code</a></td></tr>
<tr><td id="methIndEntry">get_name</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE30">Code</a></td></tr>
<tr><td id="methIndEntry">get_non_coding_transcripts</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE31">Code</a></td></tr>
<tr><td id="methIndEntry">get_refseq</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE32">Code</a></td></tr>
<tr><td id="methIndEntry">get_transcripts</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE33">Code</a></td></tr>
<tr><td id="methIndEntry">has_coding_transcript</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE34">Code</a></td></tr>
<tr><td id="methIndEntry">push_transcript</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE35">Code</a></td></tr>
<tr><td id="methIndEntry">read_description</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE36">Code</a></td></tr>
<tr><td id="methIndEntry">read_names</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE37">Code</a></td></tr>
<tr><td id="methIndEntry">read_refseqs</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE38">Code</a></td></tr>
<tr><td id="methIndEntry">set_description</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE39">Code</a></td></tr>
<tr><td id="methIndEntry">set_ensgid</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE40">Code</a></td></tr>
<tr><td id="methIndEntry">set_internalID</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE41">Code</a></td></tr>
<tr><td id="methIndEntry">set_name</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE42">Code</a></td></tr>
<tr><td id="methIndEntry">set_refseq</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE43">Code</a></td></tr>
<tr><td id="methIndEntry">set_transcripts</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE44">Code</a></td></tr>
<tr><td id="methIndEntry">update_info_from_transcript</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE45">Code</a></td></tr>
</table>
<div id="sep"></div>
<a name="MethDesc" id="MethDesc"></a>
<div id="mainTitle">Methods description</div>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_by_ensgid" id="_pod_get_by_ensgid"></a><a name="POD1" id="POD1"></a>get_by_ensgid</td><td ><a href="#CODE17">code</a></td><td >&nbsp;&nbsp;&nbsp;&nbsp;</td><td ><a href="#POD2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : string $ensgid
               The Ensembl id of the gene.
  Example    : <B>GenOO::Gene</B>->get_by_ensgid;
  Description: Class method that returns the object which corresponds to the provided Ensembl gene id.
               If no object is found, then depending on the database access policy the method either attempts
               to create a new object or returns undef
  Returntype : <B>GenOO::Gene</B> / undef
  Caller     : ?
  Status     : Stable</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_by_id" id="_pod_get_by_id"></a><a name="POD2" id="POD2"></a>get_by_id</td><td ><a href="#CODE18">code</a></td><td ><a href="#POD1">prev</a></td><td ><a href="#POD3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : string $id
               The primary id of the gene.
  Example    : <B>GenOO::Gene</B>->get_by_id;
  Description: Class method that returns the object which corresponds to the provided primary gene id.
               If no object is found returns undef
  Returntype : <B>GenOO::Gene</B> / undef
  Caller     : ?
  Status     : Under development</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_by_name" id="_pod_get_by_name"></a><a name="POD3" id="POD3"></a>get_by_name</td><td ><a href="#CODE19">code</a></td><td ><a href="#POD2">prev</a></td><td ><a href="#POD4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : string $ensgid
               The name of the gene.
  Example    : <B>GenOO::Gene</B>->get_by_name;
  Description: Class method that returns a reference to an array of object which correspond to the provided gene name.
               If no matching object is found a reference to an empty array is returned.
  Returntype : <B>GenOO::Gene</B> / []
  Caller     : ?
  Status     : Stable</pre></td></tr></table>
<div id="sep"></div>
<a name="MethCode" id="MethCode"></a>
<div id="mainTitle">Methods code</div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE1" id="CODE1"></a>_add_to_all</td><td >description</td><td >prev</td><td ><a href="#CODE2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_add_to_all</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$obj</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="var">$all_gene_ids</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_id</span><span id="braces">}</span> = <span id="var">$obj</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$obj</span>-&gt;<span id="method">get_ensgid</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$all_gene_ensgids</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_ensgid</span><span id="braces">}</span> = <span id="var">$obj</span>;
		<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$obj</span>-&gt;<span id="method">get_name</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$all_gene_names</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_name</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$all_gene_names</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_name</span><span id="braces">}</span> = <span id="braces">[</span><span id="braces">]</span>;
			<span id="braces">}</span>
			<span id="perlFunc">push</span> @<span id="braces">{</span><span id="var">$all_gene_names</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_name</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$obj</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE2" id="CODE2"></a>_delete_from_all</td><td >description</td><td ><a href="#CODE1">prev</a></td><td ><a href="#CODE3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_delete_from_all</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$obj</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlFunc">delete</span> <span id="var">$all_gene_ids</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_id</span><span id="braces">}</span>;
		<span id="perlFunc">delete</span> <span id="var">$all_gene_ensgids</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_ensgid</span><span id="braces">}</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$all_gene_names</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_name</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span>=0;<span id="var">$i</span>&lt;@<span id="braces">{</span><span id="var">$all_gene_names</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_name</span><span id="braces">}</span><span id="braces">}</span>;<span id="var">$i</span>++<span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$all_gene_names</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_name</span><span id="braces">}</span>-&gt;<span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>-&gt;<span id="method">get_id</span> <span id="perlKey">eq</span> <span id="var">$obj</span>-&gt;<span id="method">get_id</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlFunc">splice</span><span id="braces">(</span>@<span id="braces">{</span><span id="var">$all_gene_names</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_name</span><span id="braces">}</span><span id="braces">}</span>,<span id="var">$i</span>,1<span id="braces">)</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE3" id="CODE3"></a>_init</td><td >description</td><td ><a href="#CODE2">prev</a></td><td ><a href="#CODE4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_init</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$data</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="var">$self</span>-&gt;<span id="method">SUPER</span>::<span id="method">_init</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_internalID</span><span id="braces">(</span>$$data<span id="braces">{</span>INTERNAL_ID<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_ensgid</span><span id="braces">(</span>$$data<span id="braces">{</span>ENSGID<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_name</span><span id="braces">(</span>$$data<span id="braces">{</span>NAME<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_refseq</span><span id="braces">(</span>$$data<span id="braces">{</span>REFSEQ<span id="braces">}</span><span id="braces">)</span>; <span id="comment"># [] reference to array of refseqs</span><br />	<span id="var">$self</span>-&gt;<span id="method">set_transcripts</span><span id="braces">(</span>$$data<span id="braces">{</span>TRANSCRIPTS<span id="braces">}</span><span id="braces">)</span>; <span id="comment"># [] reference to array of transcripts</span><br />	<span id="var">$self</span>-&gt;<span id="method">set_description</span><span id="braces">(</span>$$data<span id="braces">{</span>DESCRIPTION<span id="braces">}</span><span id="braces">)</span>;
	
	<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
	<span id="var">$class</span>-&gt;<span id="method">_add_to_all</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span>;
	
	<span id="perlKey">return</span> <span id="var">$self</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE4" id="CODE4"></a>_read_file_with_descriptions</td><td >description</td><td ><a href="#CODE3">prev</a></td><td ><a href="#CODE5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_read_file_with_descriptions</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$file</span><span id="braces">)</span>=<span id="var">@_</span>;
		
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$IN</span>,<span id="dqStr">"&lt;"</span>,<span id="var">$file</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file <span id="var">$file</span>: $!"</span>;
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$line</span> = &lt;<span id="var">$IN</span>&gt;<span id="braces">)</span><span id="braces">{</span>
			<span id="perlFunc">chomp</span><span id="braces">(</span><span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$ensgid</span>,<span id="var">$description</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="var">$geneObj</span> = <span id="var">$class</span>-&gt;<span id="method">get_by_ensgid</span><span id="braces">(</span><span id="var">$ensgid</span><span id="braces">)</span>;
			<span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$geneObj</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$geneObj</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
							   ENSGID   =&gt; <span id="var">$ensgid</span>,
							<span id="braces">}</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="var">$geneObj</span>-&gt;<span id="method">set_description</span><span id="braces">(</span><span id="var">$description</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlFunc">close</span> <span id="var">$IN</span>;
		
		<span id="perlKey">return</span> <span id="var">%all_gene_ids</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE5" id="CODE5"></a>_read_file_with_names</td><td >description</td><td ><a href="#CODE4">prev</a></td><td ><a href="#CODE6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_read_file_with_names</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$file</span><span id="braces">)</span>=<span id="var">@_</span>;
		
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$IN</span>,<span id="dqStr">"&lt;"</span>,<span id="var">$file</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file <span id="var">$file</span>: $!"</span>;
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$line</span> = &lt;<span id="var">$IN</span>&gt;<span id="braces">)</span><span id="braces">{</span>
			<span id="perlFunc">chomp</span><span id="braces">(</span><span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$ensgid</span>,<span id="var">$commonName</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="var">$geneObj</span> = <span id="var">$class</span>-&gt;<span id="method">get_by_ensgid</span><span id="braces">(</span><span id="var">$ensgid</span><span id="braces">)</span>;
			<span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$geneObj</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$geneObj</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
							   ENSGID   =&gt; <span id="var">$ensgid</span>,
							<span id="braces">}</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="var">$geneObj</span>-&gt;<span id="method">set_name</span><span id="braces">(</span><span id="var">$commonName</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlFunc">close</span> <span id="var">$IN</span>;
		
		<span id="perlKey">return</span> <span id="var">%all_gene_ids</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE6" id="CODE6"></a>_read_file_with_refseqs</td><td >description</td><td ><a href="#CODE5">prev</a></td><td ><a href="#CODE7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_read_file_with_refseqs</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$file</span><span id="braces">)</span>=<span id="var">@_</span>;
		
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$IN</span>,<span id="dqStr">"&lt;"</span>,<span id="var">$file</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file <span id="var">$file</span>: $!"</span>;
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$line</span> = &lt;<span id="var">$IN</span>&gt;<span id="braces">)</span><span id="braces">{</span>
			<span id="perlFunc">chomp</span><span id="braces">(</span><span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$ensgid</span>,<span id="var">$refseq</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="var">$geneObj</span> = <span id="var">$class</span>-&gt;<span id="method">get_by_ensgid</span><span id="braces">(</span><span id="var">$ensgid</span><span id="braces">)</span>;
			<span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$geneObj</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$geneObj</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
							   ENSGID   =&gt; <span id="var">$ensgid</span>,
							<span id="braces">}</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="var">$geneObj</span>-&gt;<span id="method">add_refseq</span><span id="braces">(</span><span id="var">$refseq</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlFunc">close</span> <span id="var">$IN</span>;
		
		<span id="perlKey">return</span> <span id="var">%all_gene_ids</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE7" id="CODE7"></a>add_refseq</td><td >description</td><td ><a href="#CODE6">prev</a></td><td ><a href="#CODE8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">add_refseq</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlFunc">push</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="braces">{</span>REFSEQ<span id="braces">}</span><span id="braces">}</span>,<span id="var">$value</span><span id="braces">)</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$value</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE8" id="CODE8"></a>add_transcript</td><td >description</td><td ><a href="#CODE7">prev</a></td><td ><a href="#CODE9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">add_transcript</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$transcript</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span> and <span id="braces">(</span><span id="var">$transcript</span>-&gt;<span id="method">isa</span><span id="braces">(</span><span id="sqStr">'GenOO::Transcript'</span><span id="braces">)</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">update_info_from_transcript</span><span id="braces">(</span><span id="var">$transcript</span><span id="braces">)</span>;
		<span id="perlFunc">push</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="braces">{</span>TRANSCRIPTS<span id="braces">}</span><span id="braces">}</span>,<span id="var">$transcript</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlFunc">warn</span> <span id="sqStr">'Object &quot;'</span>.<span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$transcript</span><span id="braces">)</span>.<span id="sqStr">'&quot; is not GenOO::Transcript.    skipped'</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE9" id="CODE9"></a>allow_database_access</td><td >description</td><td ><a href="#CODE8">prev</a></td><td ><a href="#CODE10">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">allow_database_access</span>
{<pre>		<span id="var">$accessPolicy</span> = <span id="sqStr">'ALLOW'</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE10" id="CODE10"></a>annotate_constitutive_coding_exons</td><td >description</td><td ><a href="#CODE9">prev</a></td><td ><a href="#CODE11">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">annotate_constitutive_coding_exons</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$coding_transcripts_count</span> = 0;
	<span id="perlKey">my</span> <span id="var">%counts</span>;
	<span id="perlKey">my</span> <span id="var">$coding_transcripts</span> = <span id="var">$self</span>-&gt;<span id="method">get_coding_transcripts</span>;
	<span id="perlKey">my</span> <span id="var">$non_coding_transcripts</span> = <span id="var">$self</span>-&gt;<span id="method">get_non_coding_transcripts</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@$coding_transcripts<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$counts</span><span id="braces">{</span><span id="var">$exon</span>-&gt;<span id="method">get_id</span><span id="braces">}</span>++;
		<span id="braces">}</span>
	<span id="braces">}</span>
	
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@$coding_transcripts<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$counts</span><span id="braces">{</span><span id="var">$exon</span>-&gt;<span id="method">get_id</span><span id="braces">}</span> == @$coding_transcripts<span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$exon</span>-&gt;<span id="method">is_constitutive</span><span id="braces">(</span>1<span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="var">$exon</span>-&gt;<span id="method">is_constitutive</span><span id="braces">(</span>0<span id="braces">)</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@$non_coding_transcripts<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$exon</span>-&gt;<span id="method">is_constitutive</span><span id="braces">(</span>0<span id="braces">)</span>;
		<span id="braces">}</span>
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE11" id="CODE11"></a>annotate_constitutive_exons</td><td >description</td><td ><a href="#CODE10">prev</a></td><td ><a href="#CODE12">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">annotate_constitutive_exons</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">%counts</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$counts</span><span id="braces">{</span><span id="var">$exon</span>-&gt;<span id="method">get_id</span><span id="braces">}</span>++;
		<span id="braces">}</span>
	<span id="braces">}</span>
	
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$counts</span><span id="braces">{</span><span id="var">$exon</span>-&gt;<span id="method">get_id</span><span id="braces">}</span> == @<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$exon</span>-&gt;<span id="method">is_constitutive</span><span id="braces">(</span>1<span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="var">$exon</span>-&gt;<span id="method">is_constitutive</span><span id="braces">(</span>0<span id="braces">)</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE12" id="CODE12"></a>create_new_gene_from_database</td><td >description</td><td ><a href="#CODE11">prev</a></td><td ><a href="#CODE13">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">create_new_gene_from_database</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$ensgid</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">$DBconnector</span> = <span id="var">$class</span>-&gt;<span id="method">get_db_connector</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$DBconnector</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$dbh</span> = <span id="var">$DBconnector</span>-&gt;<span id="method">get_handle</span><span id="braces">(</span><span id="braces">)</span>;
			<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$select_all_from_genes_where_ensgid</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$select_all_from_genes_where_ensgid</span> = <span id="var">$dbh</span>-&gt;<span id="method">prepare</span><span id="braces">(</span><span id="var">$select_all_from_genes_where_ensgid_Query</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="var">$select_all_from_genes_where_ensgid</span>-&gt;<span id="method">execute</span><span id="braces">(</span><span id="var">$ensgid</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="var">$fetch_hash_ref</span> = <span id="var">$select_all_from_genes_where_ensgid</span>-&gt;<span id="method">fetchrow_hashref</span>;
			<span id="var">$select_all_from_genes_where_ensgid</span>-&gt;<span id="method">finish</span><span id="braces">(</span><span id="braces">)</span>; <span id="comment"># there should be only one result so I have to indicate that fetching is over</span><br />			
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> $$fetch_hash_ref<span id="braces">{</span>internal_gid<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$gene</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
							   INTERNAL_ID      =&gt; $$fetch_hash_ref<span id="braces">{</span>internal_gid<span id="braces">}</span>,
							   ENSGID           =&gt; $$fetch_hash_ref<span id="braces">{</span>ensgid<span id="braces">}</span>,
							<span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">return</span> <span id="var">$gene</span>;
			<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="perlFunc">warn</span> <span id="dqStr">"Gene\&quot; $ensgid\&quot; could not be found in database. Please check that the gene already exists\n"</span>;
				<span id="perlKey">return</span> <span id="perlFunc">undef</span>;
			<span id="braces">}</span>
			
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE13" id="CODE13"></a>database_access</td><td >description</td><td ><a href="#CODE12">prev</a></td><td ><a href="#CODE14">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">database_access</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">while</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$accessPolicy</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">print</span> STDERR <span id="dqStr">"Would you like to enable database access to retrieve data for class <span id="var">$class</span>? (y/n) [n]"</span>;
			<span id="perlKey">my</span> <span id="var">$userChoice</span> = &lt;&gt;;
			<span id="perlFunc">chomp</span> <span id="braces">(</span><span id="var">$userChoice</span><span id="braces">)</span>;
			<span id="perlKey">if</span>    <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">''</span><span id="braces">)</span>  <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">deny_database_access</span>;<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">'y'</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">allow_database_access</span>;<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">'n'</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">deny_database_access</span>;<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span><span id="perlFunc">print</span> STDERR <span id="sqStr">'Choice not recognised. Please specify (y/n)'</span>.<span id="dqStr">"\n"</span>;<span id="braces">}</span>
		<span id="braces">}</span>
		
		<span id="perlKey">return</span> <span id="var">$accessPolicy</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE14" id="CODE14"></a>delete_all</td><td >description</td><td ><a href="#CODE13">prev</a></td><td ><a href="#CODE15">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">delete_all</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="var">%all_gene_ids</span> = <span id="braces">(</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE15" id="CODE15"></a>deny_database_access</td><td >description</td><td ><a href="#CODE14">prev</a></td><td ><a href="#CODE16">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">deny_database_access</span>
{<pre>		<span id="var">$accessPolicy</span> = <span id="sqStr">'DENY'</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE16" id="CODE16"></a>get_all</td><td >description</td><td ><a href="#CODE15">prev</a></td><td ><a href="#CODE17">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_all</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlKey">return</span> <span id="perlFunc">values</span> <span id="var">%all_gene_ids</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE17" id="CODE17"></a>get_by_ensgid</td><td ><a href="#POD1">description</a></td><td ><a href="#CODE16">prev</a></td><td ><a href="#CODE18">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_by_ensgid</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$ensgid</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$all_gene_ensgids</span><span id="braces">{</span><span id="var">$ensgid</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="var">$all_gene_ensgids</span><span id="braces">{</span><span id="var">$ensgid</span><span id="braces">}</span>;
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$class</span>-&gt;<span id="method">database_access</span> <span id="perlKey">eq</span> <span id="sqStr">'ALLOW'</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="var">$class</span>-&gt;<span id="method">create_new_gene_from_database</span><span id="braces">(</span><span id="var">$ensgid</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="perlFunc">undef</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE18" id="CODE18"></a>get_by_id</td><td ><a href="#POD2">description</a></td><td ><a href="#CODE17">prev</a></td><td ><a href="#CODE19">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_by_id</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$id</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$all_gene_ids</span><span id="braces">{</span><span id="var">$id</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="var">$all_gene_ids</span><span id="braces">{</span><span id="var">$id</span><span id="braces">}</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="perlFunc">undef</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE19" id="CODE19"></a>get_by_name</td><td ><a href="#POD3">description</a></td><td ><a href="#CODE18">prev</a></td><td ><a href="#CODE20">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_by_name</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$name</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$all_gene_names</span><span id="braces">{</span><span id="var">$name</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="var">$all_gene_names</span><span id="braces">{</span><span id="var">$name</span><span id="braces">}</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="braces">[</span><span id="braces">]</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE20" id="CODE20"></a>get_coding_transcripts</td><td >description</td><td ><a href="#CODE19">prev</a></td><td ><a href="#CODE21">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_coding_transcripts</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">@coding_transcripts</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$transcript</span>-&gt;<span id="method">is_coding</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span> <span id="var">@coding_transcripts</span>,<span id="var">$transcript</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span>\@ coding_transcripts;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE21" id="CODE21"></a>get_constitutive_coding_exons</td><td >description</td><td ><a href="#CODE20">prev</a></td><td ><a href="#CODE22">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_constitutive_coding_exons</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="var">$self</span>-&gt;<span id="method">annotate_constitutive_coding_exons</span><span id="braces">(</span><span id="braces">)</span>;
	
	<span id="perlKey">my</span> <span id="var">@constitutive_exons</span>;
	<span id="perlKey">my</span> <span id="var">%already_found</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$exon</span>-&gt;<span id="method">is_constitutive</span><span id="braces">(</span><span id="braces">)</span> and !<span id="perlFunc">exists</span> <span id="var">$already_found</span><span id="braces">{</span><span id="var">$exon</span>-&gt;<span id="method">get_id</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$new_exon</span> = <span id="var">$exon</span>-&gt;<span id="method">clone</span><span id="braces">(</span><span id="braces">)</span>;
				<span id="var">$new_exon</span>-&gt;<span id="method">set_where</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span>;
				<span id="perlFunc">push</span> <span id="var">@constitutive_exons</span>, <span id="var">$new_exon</span>;
				<span id="var">$already_found</span><span id="braces">{</span><span id="var">$exon</span>-&gt;<span id="method">get_id</span><span id="braces">}</span> = 1;
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span>\@ constitutive_exons;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE22" id="CODE22"></a>get_constitutive_exons</td><td >description</td><td ><a href="#CODE21">prev</a></td><td ><a href="#CODE23">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_constitutive_exons</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="var">$self</span>-&gt;<span id="method">annotate_constitutive_exons</span><span id="braces">(</span><span id="braces">)</span>;
	
	<span id="perlKey">my</span> <span id="var">@constitutive_exons</span>;
	<span id="perlKey">my</span> <span id="var">%already_found</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$exon</span>-&gt;<span id="method">is_constitutive</span><span id="braces">(</span><span id="braces">)</span> and !<span id="perlFunc">exists</span> <span id="var">$already_found</span><span id="braces">{</span><span id="var">$exon</span>-&gt;<span id="method">get_id</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$new_exon</span> = <span id="var">$exon</span>-&gt;<span id="method">clone</span><span id="braces">(</span><span id="braces">)</span>;
				<span id="var">$new_exon</span>-&gt;<span id="method">set_where</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span>;
				<span id="perlFunc">push</span> <span id="var">@constitutive_exons</span>, <span id="var">$new_exon</span>;
				<span id="var">$already_found</span><span id="braces">{</span><span id="var">$exon</span>-&gt;<span id="method">get_id</span><span id="braces">}</span> = 1;
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span>\@ constitutive_exons;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE23" id="CODE23"></a>get_db_connector</td><td >description</td><td ><a href="#CODE22">prev</a></td><td ><a href="#CODE24">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_db_connector</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> || <span id="var">$class</span>;
		
		<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$DBconnector</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">while</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$accessPolicy</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">print</span> STDERR <span id="dqStr">"Would you like to enable database access to retrieve data for class <span id="var">$class</span>? (y/n) [n]"</span>;
				<span id="perlKey">my</span> <span id="var">$userChoice</span> = &lt;&gt;;
				<span id="perlFunc">chomp</span> <span id="braces">(</span><span id="var">$userChoice</span><span id="braces">)</span>;
				<span id="perlKey">if</span>    <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">''</span><span id="braces">)</span>  <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">deny_database_access</span>;<span id="braces">}</span>
				<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">'y'</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">allow_database_access</span>;<span id="braces">}</span>
				<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">'n'</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">deny_database_access</span>;<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span><span id="perlFunc">print</span> STDERR <span id="sqStr">'Choice not recognised. Please specify (y/n)'</span>.<span id="dqStr">"\n"</span>;<span id="braces">}</span>
			<span id="braces">}</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$accessPolicy</span> <span id="perlKey">eq</span> <span id="sqStr">'ALLOW'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="module"><a href="DBconnector.html">GenOO::DBconnector</a></span>-&gt;<span id="perlFunc">exists</span><span id="braces">(</span><span id="dqStr">"core"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$DBconnector</span> = <span id="module"><a href="DBconnector.html">GenOO::DBconnector</a></span>-&gt;<span id="method">get_dbconnector</span><span id="braces">(</span><span id="dqStr">"core"</span><span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span>
					<span id="perlFunc">print</span> STDERR <span id="dqStr">"\nRequesting database connector for class $class\n"</span>;
					<span id="var">$DBconnector</span> = <span id="module"><a href="DBconnector.html">GenOO::DBconnector</a></span>-&gt;<span id="method">get_dbconnector</span><span id="braces">(</span><span id="var">$class</span><span id="braces">)</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlKey">return</span> <span id="var">$DBconnector</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE24" id="CODE24"></a>get_description</td><td >description</td><td ><a href="#CODE23">prev</a></td><td ><a href="#CODE25">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_description</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>DESCRIPTION<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE25" id="CODE25"></a>get_ensgid</td><td >description</td><td ><a href="#CODE24">prev</a></td><td ><a href="#CODE26">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_ensgid</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>ENSGID<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE26" id="CODE26"></a>get_exon_length</td><td >description</td><td ><a href="#CODE25">prev</a></td><td ><a href="#CODE27">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_exon_length</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">@exons</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span> <span id="var">@exons</span>, <span id="var">$exon</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	
	<span id="perlKey">my</span> <span id="var">$merged_exons</span> = <span id="module"><a href="Helper/Locus.html">GenOO::Helper::Locus</a></span>::<span id="method">merge</span><span id="braces">(</span>\<span id="var">@exons</span><span id="braces">)</span>;
	
	<span id="perlKey">my</span> <span id="var">$exon_length</span> = 0;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@$merged_exons<span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$exon_length</span> += <span id="var">$exon</span>-&gt;<span id="method">get_length</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">return</span> <span id="var">$exon_length</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE27" id="CODE27"></a>get_id</td><td >description</td><td ><a href="#CODE26">prev</a></td><td ><a href="#CODE28">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_id</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">object_id</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE28" id="CODE28"></a>get_internalID</td><td >description</td><td ><a href="#CODE27">prev</a></td><td ><a href="#CODE29">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_internalID</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>INTERNAL_ID<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE29" id="CODE29"></a>get_merged_exons</td><td >description</td><td ><a href="#CODE28">prev</a></td><td ><a href="#CODE30">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_merged_exons</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">@exons</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$exon</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span> <span id="var">@exons</span>, <span id="var">$exon</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	
	<span id="perlKey">return</span> <span id="module"><a href="Helper/Locus.html">GenOO::Helper::Locus</a></span>::<span id="method">merge</span><span id="braces">(</span>\<span id="var">@exons</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE30" id="CODE30"></a>get_name</td><td >description</td><td ><a href="#CODE29">prev</a></td><td ><a href="#CODE31">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_name</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>NAME<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE31" id="CODE31"></a>get_non_coding_transcripts</td><td >description</td><td ><a href="#CODE30">prev</a></td><td ><a href="#CODE32">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_non_coding_transcripts</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">@non_coding_transcripts</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span>!<span id="var">$transcript</span>-&gt;<span id="method">is_coding</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span> <span id="var">@non_coding_transcripts</span>,<span id="var">$transcript</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span>\@ non_coding_transcripts;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE32" id="CODE32"></a>get_refseq</td><td >description</td><td ><a href="#CODE31">prev</a></td><td ><a href="#CODE33">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_refseq</span>
{<pre>	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>REFSEQ<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>REFSEQ<span id="braces">}</span>-&gt;<span id="braces">[</span><span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span><span id="braces">]</span>; <span id="comment">#return the requested item</span><br />		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>REFSEQ<span id="braces">}</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="braces">[</span><span id="braces">]</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE33" id="CODE33"></a>get_transcripts</td><td >description</td><td ><a href="#CODE32">prev</a></td><td ><a href="#CODE34">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_transcripts</span>
{<pre>	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TRANSCRIPTS<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">return</span> $<span id="braces">{</span><span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TRANSCRIPTS<span id="braces">}</span><span id="braces">}</span><span id="braces">[</span><span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span><span id="braces">]</span>; <span id="comment">#return the requested gene</span><br />		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TRANSCRIPTS<span id="braces">}</span>; <span id="comment"># return the reference to the array with the gene objects</span><br />		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="braces">[</span><span id="braces">]</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE34" id="CODE34"></a>has_coding_transcript</td><td >description</td><td ><a href="#CODE33">prev</a></td><td ><a href="#CODE35">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">has_coding_transcript</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$has_coding_transcript</span> = 0;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_transcripts</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$transcript</span>-&gt;<span id="method">is_coding</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$has_coding_transcript</span> = 1;
			<span id="perlKey">last</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	
	<span id="perlKey">return</span> <span id="var">$has_coding_transcript</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE35" id="CODE35"></a>push_transcript</td><td >description</td><td ><a href="#CODE34">prev</a></td><td ><a href="#CODE36">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">push_transcript</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$transcript</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlFunc">warn</span> <span id="dqStr">"Method "</span>.<span id="braces">(</span><span id="perlFunc">caller</span><span id="braces">(</span>0<span id="braces">)</span><span id="braces">)</span><span id="braces">[</span>3<span id="braces">]</span>.<span id="dqStr">" is deprecated. Consider using method\&quot; add_transcript\&quot; instead.\n"</span>;
	<span id="var">$self</span>-&gt;<span id="method">add_transcript</span><span id="braces">(</span><span id="var">$transcript</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE36" id="CODE36"></a>read_description</td><td >description</td><td ><a href="#CODE35">prev</a></td><td ><a href="#CODE37">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">read_description</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"FILE"</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$filename</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>;
			<span id="perlKey">return</span> <span id="var">$class</span>-&gt;<span id="method">_read_file_with_descriptions</span><span id="braces">(</span><span id="var">$filename</span><span id="braces">)</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE37" id="CODE37"></a>read_names</td><td >description</td><td ><a href="#CODE36">prev</a></td><td ><a href="#CODE38">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">read_names</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"FILE"</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$filename</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>;
			<span id="perlKey">return</span> <span id="var">$class</span>-&gt;<span id="method">_read_file_with_names</span><span id="braces">(</span><span id="var">$filename</span><span id="braces">)</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE38" id="CODE38"></a>read_refseqs</td><td >description</td><td ><a href="#CODE37">prev</a></td><td ><a href="#CODE39">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">read_refseqs</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"FILE"</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$filename</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>;
			<span id="perlKey">return</span> <span id="var">$class</span>-&gt;<span id="method">_read_file_with_refseqs</span><span id="braces">(</span><span id="var">$filename</span><span id="braces">)</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE39" id="CODE39"></a>set_description</td><td >description</td><td ><a href="#CODE38">prev</a></td><td ><a href="#CODE40">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_description</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>DESCRIPTION<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE40" id="CODE40"></a>set_ensgid</td><td >description</td><td ><a href="#CODE39">prev</a></td><td ><a href="#CODE41">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_ensgid</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>ENSGID<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE41" id="CODE41"></a>set_internalID</td><td >description</td><td ><a href="#CODE40">prev</a></td><td ><a href="#CODE42">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_internalID</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>INTERNAL_ID<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE42" id="CODE42"></a>set_name</td><td >description</td><td ><a href="#CODE41">prev</a></td><td ><a href="#CODE43">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_name</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>NAME<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE43" id="CODE43"></a>set_refseq</td><td >description</td><td ><a href="#CODE42">prev</a></td><td ><a href="#CODE44">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_refseq</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>REFSEQ<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE44" id="CODE44"></a>set_transcripts</td><td >description</td><td ><a href="#CODE43">prev</a></td><td ><a href="#CODE45">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_transcripts</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$transcripts_ref</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@$transcripts_ref<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$transcript</span>-&gt;<span id="method">isa</span><span id="braces">(</span><span id="sqStr">'GenOO::Transcript'</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">die</span> <span id="sqStr">'Object &quot;'</span>.<span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$transcript</span><span id="braces">)</span>.<span id="sqStr">'&quot; is not GenOO::Transcript.'</span>;
		<span id="braces">}</span>
		<span id="var">$self</span>-&gt;<span id="method">update_info_from_transcript</span><span id="braces">(</span><span id="var">$transcript</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="var">$self</span>-&gt;<span id="braces">{</span>TRANSCRIPTS<span id="braces">}</span> = <span id="var">$transcripts_ref</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE45" id="CODE45"></a>update_info_from_transcript</td><td >description</td><td ><a href="#CODE44">prev</a></td><td >next</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">update_info_from_transcript</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$transcript</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_species</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">set_species</span><span id="braces">(</span><span id="var">$transcript</span>-&gt;<span id="method">get_species</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_species</span> <span id="perlKey">ne</span> <span id="var">$transcript</span>-&gt;<span id="method">get_species</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">die</span> <span id="dqStr">"Inconsistency found when trying to update gene info from transcript. Gene species: "</span>.<span id="var">$self</span>-&gt;<span id="method">get_species</span>.<span id="dqStr">"\tTranscript species: "</span>.<span id="var">$transcript</span>-&gt;<span id="method">get_species</span>.<span id="dqStr">"\n"</span>;
	<span id="braces">}</span>
	
	
	<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_strand</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">set_strand</span><span id="braces">(</span><span id="var">$transcript</span>-&gt;<span id="method">get_strand</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_strand</span> <span id="perlKey">ne</span> <span id="var">$transcript</span>-&gt;<span id="method">get_strand</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">die</span> <span id="dqStr">"Inconsistency found when trying to update gene info from transcript. Gene strand: "</span>.<span id="var">$self</span>-&gt;<span id="method">get_strand</span>.<span id="dqStr">"\tTranscript strand: "</span>.<span id="var">$transcript</span>-&gt;<span id="method">get_strand</span>.<span id="dqStr">"\n"</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_chr</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">set_chr</span><span id="braces">(</span><span id="var">$transcript</span>-&gt;<span id="method">get_chr</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_chr</span> <span id="perlKey">ne</span> <span id="var">$transcript</span>-&gt;<span id="method">get_chr</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">die</span> <span id="dqStr">"Inconsistency found when trying to update gene info from transcript. Gene chr: "</span>.<span id="var">$self</span>-&gt;<span id="method">get_chr</span>.<span id="dqStr">"\tTranscript chr: "</span>.<span id="var">$transcript</span>-&gt;<span id="method">get_chr</span>.<span id="dqStr">"\n"</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_start</span> or <span id="var">$transcript</span>-&gt;<span id="method">get_start</span> &lt; <span id="var">$self</span>-&gt;<span id="method">get_start</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">set_start</span><span id="braces">(</span><span id="var">$transcript</span>-&gt;<span id="method">get_start</span><span id="braces">)</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_stop</span> or <span id="var">$transcript</span>-&gt;<span id="method">get_stop</span> &gt; <span id="var">$self</span>-&gt;<span id="method">get_stop</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">set_stop</span><span id="braces">(</span><span id="var">$transcript</span>-&gt;<span id="method">get_stop</span><span id="braces">)</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<a name="General" id="General"></a>
<div id="mainTitle">General documentation</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_EXAMPLES" id="_pod_EXAMPLES"></a>EXAMPLES</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"><pre id="podParagraph">    my $gene = <B>GenOO::Gene</B>->get_by_ensgid('ENSG00000000143'); # using the class method to get the corresponding object</pre></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_AUTHOR - Manolis Maragkakis, Panagiotis Alexiou" id="_pod_AUTHOR - Manolis Maragkakis, Panagiotis Alexiou"></a>AUTHOR - Manolis Maragkakis, Panagiotis Alexiou</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">Email <a href="mailto:em.maragkakis@gmail.com" id="podEmail">em.maragkakis@gmail.com</a>, <a href="mailto:pan.alexiou@fleming.gr" id="podEmail">pan.alexiou@fleming.gr</a></div>
<div id="sep"></div>
</body>
</html>
