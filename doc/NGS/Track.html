<head>
<!-- Generated by perlmod2www.pl -->
<title>
Track documentation.
</title>
<link rel="stylesheet" type="text/css" href="../perl.css">
</head>
<body bgcolor="white">
<span id="modRootPath">MyBio::NGS</span>
<span id="modName">Track</span>
<div id="sep"></div>
<a name="TOP" id="TOP"></a>
<table id="daArea" width="100%"><tr><td id="daEntry" ><a href="#SUMMARY">Summary</a></td><td id="daEntry" ><a href="#libs">Included libraries</a></td><td id="daEntry" ><a href="#vardefs">Package variables</a></td><td id="daEntry" ><a href="#SYNOPSIS">Synopsis</a></td><td id="daEntry" ><a href="#DESCRIPTION">Description</a></td><td id="daEntry" ><a href="#General">General documentation</a></td><td id="daEntry" ><a href="#Methods">Methods</a></td></tr></table>
<div id="sep"></div>
<div id="descTitle">Summary</div>
<div id="descArea"><B>MyBio::NGS::Track</B> - Object for a collection of MyBio::Locus objects, with features</div>
<div id="sep"></div>
<a name="vardefs" id="vardefs"></a><div id="descTitle">Package variables</div>
<div id="descArea"><div id="libEntry">No package variables defined.</div>
</div>
<div id="sep"></div>
<div id="descTitle">Included modules</div>
<div id="descArea"><div id="libEntry"><span id="use">FileHandle</span></div>
<div id="libEntry"><span id="use"><a href="../Data/File/BioFile.html">MyBio::Data::File::BioFile</a></span> </div>
<div id="libEntry"><span id="use"><a href="../MySub.html">MyBio::MySub</a></span> </div>
<div id="libEntry"><span id="use"><a href="Tag.html">MyBio::NGS::Tag</a></span> </div>
</div>
<div id="sep"></div>
<a name="libs" id="libs"></a>
<div id="descTitle">Inherit</div>
<div id="descArea"><span id="isa"><a href="../_Initializable.html">MyBio::_Initializable</a></span> </div>
<div id="sep"></div>
<a name="SYNOPSIS" id="SYNOPSIS"></a>
<div id="descTitle">Synopsis</div>
<div id="descArea"><pre id="podParagraph">    # Object that manages a collection of <a href="../Locus.html" target="urlWin" id="podUrl"><b>MyBio::Locus</b></a> objects. <br />    # It simulates tracks used in UCSC genome browser<br />
    # To initialize 
    my $track = <B>MyBio::NGS::Track</B>->new({
        NAME            => undef,
        SPECIES         => undef,
        DESCRIPTION     => undef,
        VISIBILITY      => undef,
        COLOR           => undef,
        RGB_FLAG        => undef,
        COLOR_BY_STRAND => undef,
        USE_SCORE       => undef,
        BROWSER         => undef,
        TAGS            => undef,
        FILE            => undef,
        FILETYPE        => undef,
        EXTRA_INFO      => undef,
       	TAG_SCORE_MEAN  => undef,
	TAG_COUNT       => undef,
	TAG_SCORE_SUM   => undef,
	TAG_SCORE_VARIANCE => undef,
    });</pre>
</div>
<div id="sep"></div>
<a name="DESCRIPTION" id="DESCRIPTION"></a>
<div id="descTitle">Description</div>
<div id="descArea"><pre id="podParagraph">    The primary data structure of this object is a 2D hash whose primary key is the strand 
    and its secondary key is the chromosome name. Each such pair of keys correspond to an
    array reference which stores objects of the class <a href="../Locus.html" target="urlWin" id="podUrl"><b>MyBio::Locus</b></a> sorted by start position.</pre>
</div>
<div id="sep"></div>
<a name="Methods" id="Methods"></a>
<div id="descTitle">Methods</div>
<table id="methIndArea" width="100%" cellspacing="0"><tr><td id="methIndEntry">_init</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE1">Code</a></td></tr>
<tr><td id="methIndEntry">add_tag</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE2">Code</a></td></tr>
<tr><td id="methIndEntry">delete_from_all</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE3">Code</a></td></tr>
<tr><td id="methIndEntry">get_all_tags</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE4">Code</a></td></tr>
<tr><td id="methIndEntry">get_all_tags_score</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE5">Code</a></td></tr>
<tr><td id="methIndEntry">get_browser</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE6">Code</a></td></tr>
<tr><td id="methIndEntry">get_color</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE7">Code</a></td></tr>
<tr><td id="methIndEntry">get_color_by_strand</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE8">Code</a></td></tr>
<tr><td id="methIndEntry">get_description</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE9">Code</a></td></tr>
<tr><td id="methIndEntry">get_extra</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE10">Code</a></td></tr>
<tr><td id="methIndEntry">get_file</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE11">Code</a></td></tr>
<tr><td id="methIndEntry">get_filetype</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE12">Code</a></td></tr>
<tr><td id="methIndEntry">get_id</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE13">Code</a></td></tr>
<tr><td id="methIndEntry">get_longest_tag_length</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE14">Code</a></td></tr>
<tr><td id="methIndEntry">get_name</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE15">Code</a></td></tr>
<tr><td id="methIndEntry">get_quantile</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE16">Code</a></td></tr>
<tr><td id="methIndEntry">get_rgb_flag</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE17">Code</a></td></tr>
<tr><td id="methIndEntry">get_species</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE18">Code</a></td></tr>
<tr><td id="methIndEntry">get_tag_count</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE19">Code</a></td></tr>
<tr><td id="methIndEntry">get_tag_score_mean</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE20">Code</a></td></tr>
<tr><td id="methIndEntry">get_tag_score_stdev</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE21">Code</a></td></tr>
<tr><td id="methIndEntry">get_tag_score_sum</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE22">Code</a></td></tr>
<tr><td id="methIndEntry">get_tag_score_variance</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE23">Code</a></td></tr>
<tr><td id="methIndEntry">get_tags</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE24">Code</a></td></tr>
<tr><td id="methIndEntry">get_use_score</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE25">Code</a></td></tr>
<tr><td id="methIndEntry">get_visibility</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE26">Code</a></td></tr>
<tr><td id="methIndEntry">normalize</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE27">Code</a></td></tr>
<tr><td id="methIndEntry">output_track_line</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE28">Code</a></td></tr>
<tr><td id="methIndEntry">print_all_tags</td><td id="methIndEntry"><a href="#POD1">Description</a></td><td id="methIndEntry"><a href="#CODE29">Code</a></td></tr>
<tr><td id="methIndEntry">print_all_tags_BED</td><td id="methIndEntry"><a href="#POD2">Description</a></td><td id="methIndEntry"><a href="#CODE30">Code</a></td></tr>
<tr><td id="methIndEntry">print_all_tags_FASTA</td><td id="methIndEntry"><a href="#POD3">Description</a></td><td id="methIndEntry"><a href="#CODE31">Code</a></td></tr>
<tr><td id="methIndEntry">print_all_tags_WIG</td><td id="methIndEntry"><a href="#POD4">Description</a></td><td id="methIndEntry"><a href="#CODE32">Code</a></td></tr>
<tr><td id="methIndEntry">print_track_line</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE33">Code</a></td></tr>
<tr><td id="methIndEntry">push_to_browser</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE34">Code</a></td></tr>
<tr><td id="methIndEntry">set_browser</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE35">Code</a></td></tr>
<tr><td id="methIndEntry">set_color</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE36">Code</a></td></tr>
<tr><td id="methIndEntry">set_color_by_strand</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE37">Code</a></td></tr>
<tr><td id="methIndEntry">set_description</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE38">Code</a></td></tr>
<tr><td id="methIndEntry">set_extra</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE39">Code</a></td></tr>
<tr><td id="methIndEntry">set_file</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE40">Code</a></td></tr>
<tr><td id="methIndEntry">set_filetype</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE41">Code</a></td></tr>
<tr><td id="methIndEntry">set_id</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE42">Code</a></td></tr>
<tr><td id="methIndEntry">set_name</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE43">Code</a></td></tr>
<tr><td id="methIndEntry">set_rgb_flag</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE44">Code</a></td></tr>
<tr><td id="methIndEntry">set_species</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE45">Code</a></td></tr>
<tr><td id="methIndEntry">set_tag_count</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE46">Code</a></td></tr>
<tr><td id="methIndEntry">set_tag_score_mean</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE47">Code</a></td></tr>
<tr><td id="methIndEntry">set_tag_score_sum</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE48">Code</a></td></tr>
<tr><td id="methIndEntry">set_tag_score_variance</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE49">Code</a></td></tr>
<tr><td id="methIndEntry">set_tags</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE50">Code</a></td></tr>
<tr><td id="methIndEntry">set_use_score</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE51">Code</a></td></tr>
<tr><td id="methIndEntry">set_visibility</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE52">Code</a></td></tr>
</table>
<div id="sep"></div>
<a name="MethDesc" id="MethDesc"></a>
<div id="mainTitle">Methods description</div>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_print_all_tags" id="_pod_print_all_tags"></a><a name="POD1" id="POD1"></a>print_all_tags</td><td ><a href="#CODE29">code</a></td><td >&nbsp;&nbsp;&nbsp;&nbsp;</td><td ><a href="#POD2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : hash reference
               A hash reference containing the parameters for the output. Important: The type of output (BED, FASTA, WIG) must be specified!
  Example    : print_all_tags({METHOD=>"BED"})
  Description: Prints all tags for the track object.
  Returntype : NULL
  Caller     : ?
  Status     : Under development</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_print_all_tags_BED" id="_pod_print_all_tags_BED"></a><a name="POD2" id="POD2"></a>print_all_tags_BED</td><td ><a href="#CODE30">code</a></td><td ><a href="#POD1">prev</a></td><td ><a href="#POD3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : hash reference
               A hash reference containing the parameters for the output
               Required parameters are:
                  1/ OUTPUT: STDOUT or filename
  Example    : print_all_tags({
                  OUTPUT       =>"STDOUT"
               })      
  Description: Prints all tags for a track object in BED format.
  Returntype : NULL
  Caller     : ?
  Status     : Stable</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_print_all_tags_FASTA" id="_pod_print_all_tags_FASTA"></a><a name="POD3" id="POD3"></a>print_all_tags_FASTA</td><td ><a href="#CODE31">code</a></td><td ><a href="#POD2">prev</a></td><td ><a href="#POD4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : hash reference
               A hash reference containing the parameters for the output.
               Required parameters are:
                  1/ OUTPUT: STDOUT or filename
                  2/ CHR_FOLDER: The folder containing the fasta files of the chromosomes
  Example    : print_all_tags({
                  OUTPUT           => "STDOUT",
                  CHR_FOLDER       => "/chromosomes/hg19/"
                  UPDATE_SEQUENCE  => "1"
               })
  Description: Prints all tags for a track object in FASTA format.
  Returntype : NULL
  Caller     : ?
  Status     : Stable</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_print_all_tags_WIG" id="_pod_print_all_tags_WIG"></a><a name="POD4" id="POD4"></a>print_all_tags_WIG</td><td ><a href="#CODE32">code</a></td><td ><a href="#POD3">prev</a></td><td ><a href="#POD5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : hash reference
               A hash reference containing the parameters for the output
               Required parameters are:
                  1/ OUTPUT: STDOUT or filename
                  2/ WINDOW: The size in nucleotides of each bin in the WIG filehandle
                  3/ STEP: The distance in nucleotides between adjacent bins in the WIG file
                  4/ SCORE_TYPE: It take the values "RPKM", "SUM" or "SIMPLE". "SUM" adds the scores of all tags in the window. "RPKM" divides this by the length of the window in kb. "SIMPLE" counts tags in the window
  Example    : print_all_tags({
                  OUTPUT       => "STDOUT",
                  WINDOW       => 1000,
                  STEP         => 100,
                  SCORE_TYPE   => "RPKM"
               })
  Description: Prints all tags for a track object in WIG format.
  Returntype : NULL
  Caller     : ?
  Status     : Stable</pre></td></tr></table>
<div id="sep"></div>
<a name="MethCode" id="MethCode"></a>
<div id="mainTitle">Methods code</div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE1" id="CODE1"></a>_init</td><td >description</td><td >prev</td><td ><a href="#CODE2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_init</span>
{<pre>	
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$data</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="var">$self</span>-&gt;<span id="method">set_name</span><span id="braces">(</span>$$data<span id="braces">{</span>NAME<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_species</span><span id="braces">(</span>$$data<span id="braces">{</span>SPECIES<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_description</span><span id="braces">(</span>$$data<span id="braces">{</span>DESCRIPTION<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_visibility</span><span id="braces">(</span>$$data<span id="braces">{</span>VISIBILITY<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_color</span><span id="braces">(</span>$$data<span id="braces">{</span>COLOR<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_rgb_flag</span><span id="braces">(</span>$$data<span id="braces">{</span>RGB_FLAG<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_color_by_strand</span><span id="braces">(</span>$$data<span id="braces">{</span>COLOR_BY_STRAND<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_use_score</span><span id="braces">(</span>$$data<span id="braces">{</span>USE_SCORE<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_browser</span><span id="braces">(</span>$$data<span id="braces">{</span>BROWSER<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_tags</span><span id="braces">(</span>$$data<span id="braces">{</span>TAGS<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_file</span><span id="braces">(</span>$$data<span id="braces">{</span>FILE<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_filetype</span><span id="braces">(</span>$$data<span id="braces">{</span>FILETYPE<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_extra</span><span id="braces">(</span>$$data<span id="braces">{</span>EXTRA_INFO<span id="braces">}</span><span id="braces">)</span>;
	<span id="comment">#statistics</span><br />	<span id="var">$self</span>-&gt;<span id="method">set_tag_score_mean</span><span id="braces">(</span>$$data<span id="braces">{</span>TAG_SCORE_MEAN<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_tag_count</span><span id="braces">(</span>$$data<span id="braces">{</span>TAG_COUNT<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_tag_score_sum</span><span id="braces">(</span>$$data<span id="braces">{</span>TAG_SCORE_SUM<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_tag_score_variance</span><span id="braces">(</span>$$data<span id="braces">{</span>TAG_SCORE_VARIANCE<span id="braces">}</span><span id="braces">)</span>;
	
	<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_id</span><span id="braces">(</span><span id="var">$class</span>-&gt;<span id="method">_increase_track_counter</span><span id="braces">)</span>;
	<span id="var">$class</span>-&gt;<span id="method">_add_to_all</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span>;
	
	<span id="perlKey">return</span> <span id="var">$self</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE2" id="CODE2"></a>add_tag</td><td >description</td><td ><a href="#CODE1">prev</a></td><td ><a href="#CODE3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">add_tag</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$tag</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlFunc">push</span> @<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_tags</span>-&gt;<span id="braces">{</span><span id="var">$tag</span>-&gt;<span id="method">get_strand</span><span id="braces">}</span>-&gt;<span id="braces">{</span><span id="var">$tag</span>-&gt;<span id="method">get_chr</span><span id="braces">}</span><span id="braces">}</span>,<span id="var">$tag</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE3" id="CODE3"></a>delete_from_all</td><td >description</td><td ><a href="#CODE2">prev</a></td><td ><a href="#CODE4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">delete_from_all</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
	<span id="var">$class</span>-&gt;<span id="method">_delete_from_all</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE4" id="CODE4"></a>get_all_tags</td><td >description</td><td ><a href="#CODE3">prev</a></td><td ><a href="#CODE5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_all_tags</span>
{<pre>	<span id="perlKey">my</span> <span id="var">@out</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">get_tags</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">get_tags</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span> <span id="var">@out</span>, @<span id="braces">{</span><span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">get_tags</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span>-&gt;<span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">@out</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE5" id="CODE5"></a>get_all_tags_score</td><td >description</td><td ><a href="#CODE4">prev</a></td><td ><a href="#CODE6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_all_tags_score</span>
{<pre>	<span id="perlKey">my</span> <span id="var">@out</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">get_tags</span><span id="braces">}</span><span id="braces">)</span>
	<span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">get_tags</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span>
		<span id="braces">{</span>
			<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">get_tags</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span>-&gt;<span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span>
			<span id="braces">{</span>
				<span id="perlFunc">push</span> <span id="var">@out</span>, <span id="var">$tag</span>-&gt;<span id="method">get_score</span><span id="braces">(</span><span id="braces">)</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">@out</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE6" id="CODE6"></a>get_browser</td><td >description</td><td ><a href="#CODE5">prev</a></td><td ><a href="#CODE7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_browser</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>BROWSER<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE7" id="CODE7"></a>get_color</td><td >description</td><td ><a href="#CODE6">prev</a></td><td ><a href="#CODE8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_color</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>COLOR<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE8" id="CODE8"></a>get_color_by_strand</td><td >description</td><td ><a href="#CODE7">prev</a></td><td ><a href="#CODE9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_color_by_strand</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>COLOR_BY_STRAND<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE9" id="CODE9"></a>get_description</td><td >description</td><td ><a href="#CODE8">prev</a></td><td ><a href="#CODE10">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_description</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>DESCRIPTION<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE10" id="CODE10"></a>get_extra</td><td >description</td><td ><a href="#CODE9">prev</a></td><td ><a href="#CODE11">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_extra</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>EXTRA_INFO<span id="braces">}</span> ;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE11" id="CODE11"></a>get_file</td><td >description</td><td ><a href="#CODE10">prev</a></td><td ><a href="#CODE12">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_file</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>FILE<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE12" id="CODE12"></a>get_filetype</td><td >description</td><td ><a href="#CODE11">prev</a></td><td ><a href="#CODE13">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_filetype</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>FILETYPE<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE13" id="CODE13"></a>get_id</td><td >description</td><td ><a href="#CODE12">prev</a></td><td ><a href="#CODE14">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_id</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>ID<span id="braces">}</span> ;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE14" id="CODE14"></a>get_longest_tag_length</td><td >description</td><td ><a href="#CODE13">prev</a></td><td ><a href="#CODE15">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_longest_tag_length</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$longest_tag</span> = 0;
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$tags_ref</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span>-&gt;<span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$tags_ref</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span>-&gt;<span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span>
				<span id="braces">{</span>
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$tag</span>-&gt;<span id="method">get_length</span><span id="braces">(</span><span id="braces">)</span> &gt; <span id="var">$longest_tag</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="var">$longest_tag</span> = <span id="var">$tag</span>-&gt;<span id="method">get_length</span><span id="braces">(</span><span id="braces">)</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">$longest_tag</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE15" id="CODE15"></a>get_name</td><td >description</td><td ><a href="#CODE14">prev</a></td><td ><a href="#CODE16">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_name</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>NAME<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE16" id="CODE16"></a>get_quantile</td><td >description</td><td ><a href="#CODE15">prev</a></td><td ><a href="#CODE17">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_quantile</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">my</span> <span id="var">$quantile</span> = 25;
	<span id="perlKey">my</span> <span id="var">$score_threshold</span> = 0;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'QUANTILE'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span><span id="var">$quantile</span> = <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'QUANTILE'</span><span id="braces">}</span>;<span id="braces">}</span>
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'THRESHOLD'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span><span id="var">$score_threshold</span> = <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'THRESHOLD'</span><span id="braces">}</span>;<span id="braces">}</span>
	<span id="perlKey">my</span> <span id="var">@scores</span> = <span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$b</span> &lt;=&gt; <span id="var">$a</span><span id="braces">}</span> <span id="var">$self</span>-&gt;<span id="method">get_all_tags_score</span>;
	<span id="perlKey">my</span> <span id="var">$size</span>;
	<span id="perlKey">for</span> <span id="braces">(</span><span id="var">$size</span> = 0; <span id="var">$size</span> &lt; <span id="var">@scores</span>; <span id="var">$size</span>++<span id="braces">)</span>
	<span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$scores</span><span id="braces">[</span><span id="var">$size</span><span id="braces">]</span> &lt; <span id="var">$score_threshold</span><span id="braces">)</span><span id="braces">{</span><span id="perlKey">last</span>;<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">my</span> <span id="var">$index</span> = <span id="perlFunc">int</span><span id="braces">(</span><span id="var">$size</span> * <span id="braces">(</span><span id="var">$quantile</span>/100));<br />	<span id="perlFunc">warn</span> <span id="dqStr">"idx: $index\n"</span>;
	<span id="perlKey">return</span> <span id="var">$scores</span><span id="braces">[</span><span id="var">$index</span><span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE17" id="CODE17"></a>get_rgb_flag</td><td >description</td><td ><a href="#CODE16">prev</a></td><td ><a href="#CODE18">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_rgb_flag</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>RGB_FLAG<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE18" id="CODE18"></a>get_species</td><td >description</td><td ><a href="#CODE17">prev</a></td><td ><a href="#CODE19">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_species</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>SPECIES<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE19" id="CODE19"></a>get_tag_count</td><td >description</td><td ><a href="#CODE18">prev</a></td><td ><a href="#CODE20">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_tag_count</span>
{<pre>	<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_COUNT<span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
		<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">calculate_tag_count</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_COUNT<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE20" id="CODE20"></a>get_tag_score_mean</td><td >description</td><td ><a href="#CODE19">prev</a></td><td ><a href="#CODE21">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_tag_score_mean</span>
{<pre>	<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_MEAN<span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
		<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">calculate_tag_score_mean</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_MEAN<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE21" id="CODE21"></a>get_tag_score_stdev</td><td >description</td><td ><a href="#CODE20">prev</a></td><td ><a href="#CODE22">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_tag_score_stdev</span>
{<pre>	<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_VARIANCE<span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
		<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">calculate_tag_score_variance</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="perlFunc">sqrt</span><span id="braces">(</span><span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_VARIANCE<span id="braces">}</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE22" id="CODE22"></a>get_tag_score_sum</td><td >description</td><td ><a href="#CODE21">prev</a></td><td ><a href="#CODE23">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_tag_score_sum</span>
{<pre>	<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_SUM<span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
		<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">calculate_tag_score_sum</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_SUM<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE23" id="CODE23"></a>get_tag_score_variance</td><td >description</td><td ><a href="#CODE22">prev</a></td><td ><a href="#CODE24">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_tag_score_variance</span>
{<pre>	<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_VARIANCE<span id="braces">}</span><span id="braces">)</span><span id="braces">{</span>
		<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">calculate_tag_score_variance</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_VARIANCE<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE24" id="CODE24"></a>get_tags</td><td >description</td><td ><a href="#CODE23">prev</a></td><td ><a href="#CODE25">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_tags</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAGS<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE25" id="CODE25"></a>get_use_score</td><td >description</td><td ><a href="#CODE24">prev</a></td><td ><a href="#CODE26">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_use_score</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>USE_SCORE<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE26" id="CODE26"></a>get_visibility</td><td >description</td><td ><a href="#CODE25">prev</a></td><td ><a href="#CODE27">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_visibility</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>VISIBILITY<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE27" id="CODE27"></a>normalize</td><td >description</td><td ><a href="#CODE26">prev</a></td><td ><a href="#CODE28">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">normalize</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">my</span> <span id="var">$scaling_factor</span> = 1;
	<span id="perlKey">my</span> <span id="var">$normalization_factor</span> = <span id="var">$self</span>-&gt;<span id="method">get_tag_score_sum</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'SCALE'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span><span id="var">$scaling_factor</span> = <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'SCALE'</span><span id="braces">}</span>;<span id="braces">}</span>
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'NORMALIZATION_FACTOR'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span><span id="var">$normalization_factor</span> = <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'NORMALIZATION_FACTOR'</span><span id="braces">}</span>;<span id="braces">}</span>
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span>
				<span id="braces">{</span>
					<span id="perlKey">my</span> <span id="var">$normal_score</span> = <span id="braces">(</span><span id="var">$tag</span>-&gt;<span id="method">get_score</span> <span id="regExp">/ </span><span id="var">$normalization_factor</span><span id="regExp">) * </span><span id="var">$scaling_factor</span>;<br />					<span id="var">$tag</span>-&gt;<span id="method">set_score</span><span id="braces">(</span><span id="var">$normal_score</span><span id="braces">)</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE28" id="CODE28"></a>output_track_line</td><td >description</td><td ><a href="#CODE27">prev</a></td><td ><a href="#CODE29">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">output_track_line</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$method</span>, <span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"BED"</span><span id="braces">)</span>
	<span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$trackline</span> = <span id="dqStr">"track name="</span>.<span id="var">$self</span>-&gt;<span id="method">get_name</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_description</span><span id="braces">)</span><span id="braces">{</span><span id="var">$trackline</span> .= <span id="dqStr">" description="</span>.<span id="var">$self</span>-&gt;<span id="method">get_description</span>;<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_visibility</span><span id="braces">)</span><span id="braces">{</span><span id="var">$trackline</span> .= <span id="dqStr">" visibility="</span>.<span id="var">$self</span>-&gt;<span id="method">get_visibility</span>;<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_color</span><span id="braces">)</span><span id="braces">{</span><span id="var">$trackline</span> .= <span id="dqStr">" color="</span>.<span id="var">$self</span>-&gt;<span id="method">get_color</span>;<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_rgb_flag</span><span id="braces">)</span><span id="braces">{</span><span id="var">$trackline</span> .= <span id="dqStr">" itemRgb="</span>.<span id="var">$self</span>-&gt;<span id="method">get_rgb_flag</span>;<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_color_by_strand</span><span id="braces">)</span><span id="braces">{</span><span id="var">$trackline</span> .= <span id="dqStr">" colorByStrand="</span>.<span id="var">$self</span>-&gt;<span id="method">get_color_by_strand</span>;<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_use_score</span><span id="braces">)</span><span id="braces">{</span><span id="var">$trackline</span> .= <span id="dqStr">" useScore="</span>.<span id="var">$self</span>-&gt;<span id="method">get_use_score</span>;<span id="braces">}</span>
		<span id="perlKey">return</span> <span id="var">$trackline</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"WIG"</span><span id="braces">)</span>
	<span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$extrainfo</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>; <span id="comment">#will be appended to name</span><br />		<span id="perlKey">my</span> <span id="var">$name</span> = <span id="var">$self</span>-&gt;<span id="method">get_name</span>;
		<span id="var">$name</span> =~ <span id="regExp">s/\&quot;//g</span>;		
		<span id="perlKey">my</span> <span id="var">$trackline</span> = <span id="dqStr">"track type=wiggle_0 name=\&quot;<span id="var">$name</span> $extrainfo\&quot;"</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_description</span><span id="braces">)</span><span id="braces">{</span><span id="var">$trackline</span> .= <span id="dqStr">" description="</span>.<span id="var">$self</span>-&gt;<span id="method">get_description</span>;<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_visibility</span><span id="braces">)</span><span id="braces">{</span><span id="var">$trackline</span> .= <span id="dqStr">" visibility="</span>.<span id="var">$self</span>-&gt;<span id="method">get_visibility</span>;<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_color</span><span id="braces">)</span><span id="braces">{</span><span id="var">$trackline</span> .= <span id="dqStr">" color="</span>.<span id="var">$self</span>-&gt;<span id="method">get_color</span>;<span id="braces">}</span>
		<span id="var">$trackline</span> .= <span id="dqStr">" autoScale=off alwaysZero=on"</span>;
		<span id="perlKey">return</span> <span id="var">$trackline</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE29" id="CODE29"></a>print_all_tags</td><td ><a href="#POD1">description</a></td><td ><a href="#CODE28">prev</a></td><td ><a href="#CODE30">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print_all_tags</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$params</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="dqStr">"HASH"</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
		<span id="perlFunc">die</span> <span id="dqStr">"\n\nDon't panic - Just change the way you call method\&quot; print_all_tags\&quot; through <span id="var">$class</span> in your calling script $0\n\n"</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">my</span> <span id="var">$method</span> = <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'METHOD'</span><span id="braces">}</span>;
	<span id="perlFunc">delete</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'METHOD'</span><span id="braces">}</span>;
	<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$method</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
		<span id="perlFunc">die</span> <span id="dqStr">"\nNo print method specified in $class\::print_all_tags"</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"BED"</span><span id="braces">)</span><span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">print_all_tags_BED</span><span id="braces">(</span><span id="var">$params</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"FASTA"</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">print_all_tags_FASTA</span><span id="braces">(</span><span id="var">$params</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"WIG"</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">print_all_tags_WIG</span><span id="braces">(</span><span id="var">$params</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
		<span id="perlFunc">die</span> <span id="dqStr">"\nUnknown print method\&quot; $method\&quot; specified in $class\::print_all_tags. Try (BED|WIG|FASTA)"</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE30" id="CODE30"></a>print_all_tags_BED</td><td ><a href="#POD2">description</a></td><td ><a href="#CODE29">prev</a></td><td ><a href="#CODE31">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print_all_tags_BED</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$OUT</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="braces">(</span>!<span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span> <span id="perlKey">eq</span> <span id="dqStr">"STDOUT"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;&amp;="</span>,STDOUT<span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlFunc">open</span><span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;"</span>,<span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file "</span>.<span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span>.<span id="dqStr">". $!"</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span>
				<span id="braces">{</span>
					<span id="perlFunc">print</span> <span id="var">$OUT</span> <span id="var">$tag</span>-&gt;<span id="method">to_string</span><span id="braces">(</span><span id="dqStr">"BED"</span><span id="braces">)</span>.<span id="dqStr">"\n"</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	
	<span id="perlKey">return</span> 0;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE31" id="CODE31"></a>print_all_tags_FASTA</td><td ><a href="#POD3">description</a></td><td ><a href="#CODE30">prev</a></td><td ><a href="#CODE32">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print_all_tags_FASTA</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$chr_folder</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'CHR_FOLDER'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'CHR_FOLDER'</span><span id="braces">}</span> : <span id="perlFunc">die</span> <span id="dqStr">"The method FASTA is requested in\&quot; print_all_tags\&quot; but the folder with chromosome sequences is not provided"</span>;
	<span id="perlKey">my</span> <span id="var">$upflank</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'UP_FLANK'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'UP_FLANK'</span><span id="braces">}</span> : 0;
	<span id="perlKey">my</span> <span id="var">$downflank</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'DOWN_FLANK'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'DOWN_FLANK'</span><span id="braces">}</span> : 0;
	<span id="perlKey">my</span> <span id="var">$maxflank</span> = <span id="var">$upflank</span> &gt; <span id="var">$downflank</span> ? <span id="var">$upflank</span> : <span id="var">$downflank</span>;
	
	<span id="perlKey">my</span> <span id="var">$OUT</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="braces">(</span>!<span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span> <span id="perlKey">eq</span> <span id="dqStr">"STDOUT"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;&amp;="</span>,STDOUT<span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlFunc">open</span><span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;"</span>,<span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">my</span> <span id="var">%available_chrs</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$available_chrs</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span> = 1;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> <span id="var">%available_chrs</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$chr_file</span> = <span id="var">$chr_folder</span>.<span id="dqStr">"/chr<span id="var">$chr</span>.fa"</span>;
		<span id="perlKey">unless</span> <span id="braces">(</span>-e <span id="var">$chr_file</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">warn</span> <span id="dqStr">"Skipping chromosome. File <span id="var">$chr_file</span> does not exist"</span>;
			<span id="perlKey">next</span>;
		<span id="braces">}</span>
		<span id="perlKey">my</span> <span id="var">$chr_seq</span> = <span id="perlFunc">join</span><span id="braces">(</span><span id="sqStr">''</span>,<span id="perlFunc">map</span><span id="braces">{</span><span id="sqStr">'N'</span><span id="braces">}</span> <span id="braces">(</span>1..<span id="var">$maxflank</span><span id="braces">)</span><span id="braces">)</span>.<span id="module"><a href="../MySub.html">MyBio::MySub</a></span>::<span id="method">read_fasta</span><span id="braces">(</span><span id="var">$chr_file</span>,<span id="dqStr">"chr<span id="var">$chr</span>"</span><span id="braces">)</span>.<span id="perlFunc">join</span><span id="braces">(</span><span id="sqStr">''</span>,<span id="perlFunc">map</span><span id="braces">{</span><span id="sqStr">'N'</span><span id="braces">}</span> <span id="braces">(</span>1..<span id="var">$maxflank</span><span id="braces">)</span><span id="braces">)</span>;
		
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$tags_array_ref</span> = $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span>;
				<span id="comment"># Unbelievable as it may be, although the if else statement is not needed, having it here speeds up the script by approximately 8 times</span><br />				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$maxflank</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@$tags_array_ref<span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="var">$tag_seq</span>;
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$strand</span> == 1<span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$tag_seq</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$chr_seq</span>,<span id="var">$tag</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span>+<span id="var">$maxflank</span>-<span id="var">$upflank</span>,<span id="var">$tag</span>-&gt;<span id="method">get_length</span>+<span id="var">$upflank</span>+<span id="var">$downflank</span><span id="braces">)</span>;
						<span id="braces">}</span>
						<span id="perlKey">else</span> <span id="braces">{</span>
							<span id="var">$tag_seq</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$chr_seq</span>,<span id="var">$tag</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span>+<span id="var">$maxflank</span>-<span id="var">$downflank</span>,<span id="var">$tag</span>-&gt;<span id="method">get_length</span>+<span id="var">$upflank</span>+<span id="var">$downflank</span><span id="braces">)</span>;
							<span id="var">$tag_seq</span> = <span id="perlFunc">reverse</span><span id="braces">(</span><span id="var">$tag_seq</span><span id="braces">)</span>;
							<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$tag_seq</span> =~ <span id="regExp">/U/i</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="var">$tag_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/UACGAuacga/</span>;
							<span id="braces">}</span>
							<span id="perlKey">else</span> <span id="braces">{</span>
								<span id="var">$tag_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/TACGAtacga/</span>;
							<span id="braces">}</span>
						<span id="braces">}</span>
						<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'UPDATE_SEQUENCE'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span><span id="var">$tag</span>-&gt;<span id="method">set_sequence</span><span id="braces">(</span><span id="var">$tag_seq</span><span id="braces">)</span>;<span id="braces">}</span>
						<span id="perlKey">my</span> <span id="var">$header</span> = <span id="var">$tag</span>-&gt;<span id="method">to_string</span><span id="braces">(</span><span id="dqStr">"BED"</span><span id="braces">)</span>;
						<span id="var">$header</span> =~ <span id="regExp">s/\t/|/g</span>;
						<span id="perlFunc">print</span> <span id="var">$OUT</span> <span id="dqStr">"&gt;$header\n$tag_seq\n"</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span>
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@$tags_array_ref<span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="var">$tag_seq</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$chr_seq</span>,<span id="var">$tag</span>-&gt;<span id="method">get_start</span>,<span id="var">$tag</span>-&gt;<span id="method">get_length</span><span id="braces">)</span>;
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$strand</span> == -1<span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$tag_seq</span> = <span id="perlFunc">reverse</span><span id="braces">(</span><span id="var">$tag_seq</span><span id="braces">)</span>;
							<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$tag_seq</span> =~ <span id="regExp">/U/i</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="var">$tag_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/UACGAuacga/</span>;
							<span id="braces">}</span>
							<span id="perlKey">else</span> <span id="braces">{</span>
								<span id="var">$tag_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/TACGAtacga/</span>;
							<span id="braces">}</span>
						<span id="braces">}</span>
						<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'UPDATE_SEQUENCE'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span><span id="var">$tag</span>-&gt;<span id="method">set_sequence</span><span id="braces">(</span><span id="var">$tag_seq</span><span id="braces">)</span>;<span id="braces">}</span>
						<span id="perlKey">my</span> <span id="var">$header</span> = <span id="var">$tag</span>-&gt;<span id="method">to_string</span><span id="braces">(</span><span id="dqStr">"BED"</span><span id="braces">)</span>;
						<span id="var">$header</span> =~ <span id="regExp">s/\t/|/g</span>;
						<span id="perlFunc">print</span> <span id="var">$OUT</span> <span id="dqStr">"&gt;$header\n$tag_seq\n"</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> 0;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE32" id="CODE32"></a>print_all_tags_WIG</td><td ><a href="#POD4">description</a></td><td ><a href="#CODE31">prev</a></td><td ><a href="#CODE33">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print_all_tags_WIG</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$OUT</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="braces">(</span>!<span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span> <span id="perlKey">eq</span> <span id="dqStr">"STDOUT"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;&amp;="</span>,STDOUT<span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlFunc">open</span><span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;"</span>,<span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">my</span> <span id="var">$window</span> = <span id="perlFunc">defined</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'WINDOW'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'WINDOW'</span><span id="braces">}</span> : 1000;
	<span id="perlKey">my</span> <span id="var">$step</span> = <span id="perlFunc">defined</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'STEP'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'STEP'</span><span id="braces">}</span> : 100;
	<span id="perlKey">my</span> <span id="var">$scoring_type</span> = <span id="perlFunc">defined</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'SCORE_TYPE'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'SCORE_TYPE'</span><span id="braces">}</span> : <span id="dqStr">"RPKM"</span>;
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="var">$self</span>-&gt;<span id="method">sort_tags</span><span id="braces">(</span><span id="braces">)</span>;
	
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">print_track_line</span><span id="braces">(</span><span id="dqStr">"WIG"</span>, <span id="dqStr">"strand(<span id="var">$strand</span>)"</span><span id="braces">)</span>;
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$lastend</span> = <span id="braces">(</span><span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$a</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span> &lt;=&gt; <span id="var">$b</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span><span id="braces">}</span> @<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span><span id="braces">[</span>-1<span id="braces">]</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="var">$last_positive_tag_index</span> = 0;
				<span id="perlFunc">print</span> <span id="dqStr">"variableStep chrom=chr<span id="var">$chr</span> span=$step\n"</span>;
				<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$start</span> = <span id="var">$window</span>; <span id="var">$start</span> &lt; <span id="var">$lastend</span>; <span id="var">$start</span> += <span id="var">$step</span><span id="braces">)</span>
				<span id="braces">{</span>
					<span id="perlKey">my</span> <span id="var">$wiglocus</span> = <span id="module"><a href="../Locus.html">MyBio::Locus</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
						STRAND       =&gt; <span id="var">$strand</span>,
						CHR          =&gt; <span id="var">$chr</span>,
						START        =&gt; <span id="var">$start</span>,
						STOP         =&gt; <span id="braces">(</span><span id="var">$start</span>+<span id="var">$window</span>-1<span id="braces">)</span>
					<span id="braces">}</span><span id="braces">)</span>;
					<span id="perlKey">my</span> <span id="var">$score</span> = 0;
					<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span> = <span id="var">$last_positive_tag_index</span>; <span id="var">$i</span>&lt; $#<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span>; <span id="var">$i</span>++<span id="braces">)</span>
					<span id="braces">{</span>
						<span id="perlKey">my</span> <span id="var">$tag</span> = $<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>;
						
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$wiglocus</span>-&gt;<span id="method">overlaps</span><span id="braces">(</span><span id="var">$tag</span><span id="braces">)</span><span id="braces">)</span>
						<span id="braces">{</span>
							<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$scoring_type</span> <span id="perlKey">eq</span> <span id="dqStr">"SUM"</span><span id="braces">)</span><span id="braces">{</span><span id="var">$score</span> += <span id="var">$tag</span>-&gt;<span id="method">get_score</span>;<span id="braces">}</span>
							<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$scoring_type</span> <span id="perlKey">eq</span> <span id="dqStr">"RPKM"</span><span id="braces">)</span><span id="braces">{</span><span id="var">$score</span> += <span id="braces">(</span>1000 * <span id="var">$tag</span>-&gt;<span id="method">get_score</span><span id="braces">)</span> <span id="regExp">/ </span><span id="var">$wiglocus</span><span id="regExp">-&gt;get_length;}<br />							elsif (</span><span id="var">$scoring_type</span><span id="regExp"> eq &quot;SIMPLE&quot;){</span><span id="var">$score</span><span id="regExp">++;}<br />							</span><span id="var">$last_positive_tag_index</span><span id="regExp"> = </span><span id="var">$i</span>;<br />						<span id="braces">}</span>
						<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$wiglocus</span>-&gt;<span id="method">get_stop</span> &lt; <span id="var">$tag</span>-&gt;<span id="method">get_start</span><span id="braces">)</span>
						<span id="braces">{</span>
							<span id="perlKey">last</span>;
						<span id="braces">}</span>
					<span id="braces">}</span>
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$score</span> &gt; 0<span id="braces">)</span><span id="braces">{</span><span id="perlFunc">print</span> <span id="var">$wiglocus</span>-&gt;<span id="method">get_start</span>.<span id="dqStr">"\t"</span>.<span id="var">$score</span>.<span id="dqStr">"\n"</span>;<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> 0;
<span id="braces">}</span>

<span id="perlKey">sub</span> sort_tags <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				@<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span> = <span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$a</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span> &lt;=&gt; <span id="var">$b</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">}</span> @<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
<span id="braces">}</span>

=head2 set_all_tags_sequence

  Arg <span id="braces">[</span>1<span id="braces">]</span>    : hash reference
               A hash reference containing the parameters <span id="perlKey">for</span> the output.
               Required parameters are:
                  1<span id="regExp">/ CHR_FOLDER: The folder containing the fasta files of the chromosomes<br />  Example    : set_all_tags_sequence({<br />                 CHR_FOLDER       =&gt; &quot;/chromosomes</span><span id="regExp">/hg19/</span><span id="dqStr">"
               })
  Description: Sets the SEQUENCE for all tags in the Track.
  Returntype : NULL
  Caller     : ?
  Status     : Stable

=cut
sub set_all_tags_sequence {
	my (<span id="var">$self</span>, <span id="var">$params</span>) = <span id="var">@_</span>;
	
	my <span id="var">$chr_folder</span> = exists <span id="var">$params</span>-&gt;{'CHR_FOLDER'} ? <span id="var">$params</span>-&gt;{'CHR_FOLDER'} : die "</span>The method FASTA is requested in\&quot; print_all_tags\&quot; but the folder with chromosome sequences is <span id="perlKey">not</span> provided<span id="dqStr">";
	my <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;get_tags;
	my <span id="var">%available_chrs</span>;
	foreach my <span id="var">$strand</span> (keys %{$tags_ref}) {
		foreach my <span id="var">$chr</span> (keys %{$$tags_ref{$strand}}) {
			<span id="var">$available_chrs</span>{<span id="var">$chr</span>} = 1;
		}
	}
	foreach my <span id="var">$chr</span> (keys <span id="var">%available_chrs</span>) {
		my <span id="var">$chr_file</span> = <span id="var">$chr_folder</span>."</span><span id="regExp">/chr</span><span id="var">$chr</span>.fa&quot;;<br />		<span id="perlKey">unless</span> <span id="braces">(</span>-e <span id="var">$chr_file</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">warn</span> <span id="dqStr">"Skipping chromosome. File <span id="var">$chr_file</span> does not exist"</span>;
			<span id="perlKey">next</span>;
		<span id="braces">}</span>
		<span id="perlKey">my</span> <span id="var">$chr_seq</span> = <span id="module"><a href="../MySub.html">MyBio::MySub</a></span>::<span id="method">read_fasta</span><span id="braces">(</span><span id="var">$chr_file</span>,<span id="dqStr">"chr<span id="var">$chr</span>"</span><span id="braces">)</span>;
		<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$chr_seq</span><span id="braces">)</span><span id="braces">{</span><span id="perlFunc">die</span> <span id="dqStr">"No Chromosome Sequence chr$chr\n"</span>;<span id="braces">}</span>
		
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$tags_array_ref</span> = $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span>;
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@$tags_array_ref<span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="var">$tag_seq</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$chr_seq</span>,<span id="var">$tag</span>-&gt;<span id="method">get_start</span>,<span id="var">$tag</span>-&gt;<span id="method">get_length</span><span id="braces">)</span>;
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$strand</span> == -1<span id="braces">)</span> <span id="braces">{</span>
						<span id="var">$tag_seq</span> = <span id="perlFunc">reverse</span><span id="braces">(</span><span id="var">$tag_seq</span><span id="braces">)</span>;
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$tag_seq</span> =~ <span id="regExp">/U/i</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$tag_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/UACGAuacga/</span>;
						<span id="braces">}</span>
						<span id="perlKey">else</span> <span id="braces">{</span>
							<span id="var">$tag_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/TACGAtacga/</span>;
						<span id="braces">}</span>
					<span id="braces">}</span>
					<span id="var">$tag</span>-&gt;<span id="method">set_sequence</span><span id="braces">(</span><span id="var">$tag_seq</span><span id="braces">)</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> 0;
<span id="braces">}</span>

=head2 calculate_tag_score_mean

  Example    : calculate_tag_score_mean 
  Description: Calculates the mean score of all tags in the track
  Returntype : NULL
  Caller     : ?
  Status     : Experimental <span id="regExp">/ Unstable<br /><br />=cut<br />sub calculate_tag_score_mean<br />{<br />	my (</span><span id="var">$self</span><span id="regExp">) = </span><span id="var">@_</span>;<br />	<span id="perlKey">my</span> <span id="var">$sum</span>;
	<span id="perlKey">my</span> <span id="var">$N</span>;
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span>
				<span id="braces">{</span>
					<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$tag</span>-&gt;<span id="method">get_score</span><span id="braces">)</span>
					<span id="braces">{</span>
						<span id="var">$sum</span> += <span id="var">$tag</span>-&gt;<span id="method">get_score</span>;
						<span id="var">$N</span>++;
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">my</span> <span id="var">$mean_score</span> = <span id="dqStr">"NaN"</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$N</span><span id="braces">)</span><span id="braces">{</span>
		<span id="var">$mean_score</span> = <span id="var">$sum</span> <span id="regExp">/ </span><span id="var">$N</span>;<br />		<span id="var">$self</span>-&gt;<span id="method">set_tag_score_mean</span><span id="braces">(</span><span id="var">$mean_score</span><span id="braces">)</span>;
		<span id="var">$self</span>-&gt;<span id="method">set_tag_count</span><span id="braces">(</span><span id="var">$N</span><span id="braces">)</span>;
		<span id="var">$self</span>-&gt;<span id="method">set_tag_score_sum</span><span id="braces">(</span><span id="var">$sum</span><span id="braces">)</span>;
	<span id="braces">}</span>
	
<span id="braces">}</span>

=head2 calculate_tag_score_variance

  Example    : calculate_tag_score_variance 
  Description: Calculates the variance of the scores of all tags in the track
  Returntype : NULL
  Caller     : ?
  Status     : Experimental <span id="regExp">/ Unstable<br /><br />=cut<br />sub calculate_tag_score_variance<br />{<br />	my (</span><span id="var">$self</span><span id="regExp">) = </span><span id="var">@_</span>;<br />	<span id="perlKey">my</span> <span id="var">$sumsqdiff</span>;
	<span id="perlKey">my</span> <span id="var">$N</span>;
	<span id="perlKey">my</span> <span id="var">$mean</span> = <span id="var">$self</span>-&gt;<span id="method">get_tag_score_mean</span>;
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span>
				<span id="braces">{</span>
					<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$tag</span>-&gt;<span id="method">get_score</span><span id="braces">)</span>
					<span id="braces">{</span>
						<span id="var">$sumsqdiff</span> += <span id="braces">(</span><span id="var">$tag</span>-&gt;<span id="method">get_score</span> - <span id="var">$mean</span><span id="braces">)</span> ** 2;
						<span id="var">$N</span>++;
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$N</span><span id="braces">)</span><span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$variance</span> = <span id="var">$sumsqdiff</span> <span id="regExp">/ </span><span id="var">$N</span>;<br />		<span id="var">$self</span>-&gt;<span id="method">set_tag_score_variance</span><span id="braces">(</span><span id="var">$variance</span><span id="braces">)</span>;
	<span id="braces">}</span>
	
<span id="braces">}</span>

=head2 calculate_tag_score_sum

  Example    : calculate_tag_score_sum 
  Description: Calculates the sum score of all tags in the track
  Returntype : NULL
  Caller     : ?
  Status     : Experimental <span id="regExp">/ Unstable<br /><br />=cut<br />sub calculate_tag_score_sum<br />{<br />	my (</span><span id="var">$self</span><span id="regExp">) = </span><span id="var">@_</span>;<br />	<span id="perlKey">my</span> <span id="var">$sum</span>;
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$tags_ref</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span>-&gt;<span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span>
				<span id="braces">{</span>
					<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$tag</span>-&gt;<span id="method">get_score</span><span id="braces">)</span>
					<span id="braces">{</span>
						<span id="var">$sum</span> += <span id="var">$tag</span>-&gt;<span id="method">get_score</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="var">$self</span>-&gt;<span id="method">set_tag_score_sum</span><span id="braces">(</span><span id="var">$sum</span><span id="braces">)</span>;
	
	
<span id="braces">}</span>

=head2 calculate_tag_count

  Example    : calculate_tag_count 
  Description: Calculates the number of all tags in the track
  Returntype : NULL
  Caller     : ?
  Status     : Experimental <span id="regExp">/ Unstable<br /><br />=cut<br />sub calculate_tag_count<br />{<br />	my (</span><span id="var">$self</span><span id="regExp">) = </span><span id="var">@_</span>;<br />	<span id="perlKey">my</span> <span id="var">$N</span>;
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$tags_ref</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span>-&gt;<span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span>
				<span id="braces">{</span>
					<span id="var">$N</span>++;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="var">$self</span>-&gt;<span id="method">set_tag_count</span><span id="braces">(</span><span id="var">$N</span><span id="braces">)</span>;
<span id="braces">}</span>

=head2 merge_tags

  Arg <span id="braces">[</span>1<span id="braces">]</span>    : string <span id="var">$method</span>
               A descriptor of the desired output method <span id="braces">(</span>MERGE, SPLITSCORE<span id="braces">)</span>
               MERGE: scores of overlapping or whithin a distance tags are summed
               SPLITSCORE: overlapping tags are divided into parts and the score of <span id="perlFunc">each</span> part is the sum of the
                           corresponding overlapping tags
  Arg <span id="braces">[</span>2..<span id="braces">]</span>  : array <span id="var">@attributes</span>
               Additional attributes <span id="perlKey">for</span> the <span id="perlFunc">defined</span> output method
  Example    : <span id="method">merge_tags</span><span id="braces">(</span><span id="dqStr">"MERGE"</span>, 0<span id="braces">)</span> 
               <span id="method">merge_tags</span><span id="braces">(</span><span id="dqStr">"SPLITSCORE"</span>, 10<span id="braces">)</span>
  Description: Merges loci which overlap or are closer than a given distance with <span id="perlFunc">each</span> other <span id="braces">(</span>tags are replaced by merged ones<span id="braces">)</span>
  Returntype : NULL
  Caller     : ?
  Status     : Experimental <span id="regExp">/ Unstable<br /><br />=cut<br />sub merge_tags {<br />	my (</span><span id="var">$self</span><span id="regExp">,</span><span id="var">$method</span><span id="regExp">,</span><span id="var">@attributes</span><span id="regExp">) = </span><span id="var">@_</span>;<br />	
	
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">my</span> <span id="var">%merged_hash</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$merged_hash</span><span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span> = <span id="braces">[</span><span id="braces">]</span>;
				@<span id="braces">{</span><span id="var">$merged_hash</span><span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span> = <span id="var">$self</span>-&gt;<span id="method">merge_tags_in_array</span><span id="braces">(</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="var">$self</span>-&gt;<span id="method">set_tags</span><span id="braces">(</span>\<span id="var">%merged_hash</span><span id="braces">)</span>;
<span id="braces">}</span>

<span id="perlKey">sub</span> collapse_tags <span id="braces">{</span>
	
	<span id="comment">#will collapse tags that have the same position - the score will be the number of tags that collapsed</span><br />	
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">my</span> <span id="var">%collapsed_hash</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$collapsed_hash</span><span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span> = <span id="braces">[</span><span id="braces">]</span>;
				<span id="perlKey">my</span> <span id="var">%count</span>;
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span>
				<span id="braces">{</span>
					<span id="perlKey">my</span> <span id="var">$start</span> = <span id="var">$tag</span>-&gt;<span id="method">get_start</span>;
					<span id="perlKey">my</span> <span id="var">$stop</span> = <span id="var">$tag</span>-&gt;<span id="method">get_stop</span>;
					<span id="var">$count</span><span id="braces">{</span><span id="dqStr">"<span id="var">$start</span>|<span id="var">$stop</span>"</span><span id="braces">}</span>++;
				<span id="braces">}</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$pos</span> <span id="braces">(</span><span id="perlFunc">keys</span> <span id="var">%count</span><span id="braces">)</span>
				<span id="braces">{</span>
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$start</span>, <span id="var">$stop</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\|/</span>,<span id="var">$pos</span><span id="braces">)</span>;
					<span id="perlKey">my</span> <span id="var">$tagObj</span> = <span id="module"><a href="Tag.html">MyBio::NGS::Tag</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
						CHR           =&gt; <span id="var">$chr</span>,
						START         =&gt; <span id="var">$start</span>,
						STOP          =&gt; <span id="var">$stop</span>,
						STRAND        =&gt; <span id="var">$strand</span>,
						NAME          =&gt; <span id="var">$count</span><span id="braces">{</span><span id="var">$pos</span><span id="braces">}</span>,
						SCORE         =&gt; <span id="var">$count</span><span id="braces">{</span><span id="var">$pos</span><span id="braces">}</span>,
					<span id="braces">}</span><span id="braces">)</span>;
					<span id="perlFunc">push</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$collapsed_hash</span><span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$tagObj</span><span id="braces">)</span>;
					
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="var">$self</span>-&gt;<span id="method">set_tags</span><span id="braces">(</span>\<span id="var">%collapsed_hash</span><span id="braces">)</span>;
<span id="braces">}</span>

<span id="perlKey">sub</span> merge_tags_in_array <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$tags_array_ref</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">my</span> <span id="var">@out</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">@temp</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">$offset</span>;
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"MERGE"</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$offset</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">my</span> <span id="var">$region_of_overlap</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@$tags_array_ref<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$region_of_overlap</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$region_of_overlap</span> = <span id="var">$tag</span>-&gt;<span id="method">clone</span><span id="braces">(</span><span id="braces">)</span>; 
			<span id="perlFunc">push</span><span id="braces">(</span><span id="var">@temp</span>, <span id="var">$tag</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$region_of_overlap</span>-&gt;<span id="method">overlaps</span><span id="braces">(</span><span id="var">$tag</span>,<span id="var">$offset</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span><span id="braces">(</span><span id="var">@temp</span>, <span id="var">$tag</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="var">$start</span> = <span id="var">$region_of_overlap</span>-&gt;<span id="method">get_start</span> &lt; <span id="var">$tag</span>-&gt;<span id="method">get_start</span> ? <span id="var">$region_of_overlap</span>-&gt;<span id="method">get_start</span> : <span id="var">$tag</span>-&gt;<span id="method">get_start</span>;
			<span id="perlKey">my</span> <span id="var">$stop</span> = <span id="var">$region_of_overlap</span>-&gt;<span id="method">get_stop</span> &gt; <span id="var">$tag</span>-&gt;<span id="method">get_stop</span> ? <span id="var">$region_of_overlap</span>-&gt;<span id="method">get_stop</span> : <span id="var">$tag</span>-&gt;<span id="method">get_stop</span>;
			<span id="var">$region_of_overlap</span>-&gt;<span id="method">set_start</span><span id="braces">(</span><span id="var">$start</span><span id="braces">)</span>;
			<span id="var">$region_of_overlap</span>-&gt;<span id="method">set_stop</span><span id="braces">(</span><span id="var">$stop</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="var">$region_of_overlap</span> = <span id="var">$tag</span>-&gt;<span id="method">clone</span><span id="braces">(</span><span id="braces">)</span>;
			<span id="perlKey">if</span> <span id="braces">(</span>$#temp == 0<span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@out</span>, <span id="var">$temp</span><span id="braces">[</span>0<span id="braces">]</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="perlFunc">push</span><span id="braces">(</span><span id="var">@out</span>,<span id="var">$self</span>-&gt;<span id="method">resolve_overlaping_tags</span><span id="braces">(</span>\<span id="var">@temp</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="var">@temp</span> = <span id="braces">(</span><span id="braces">)</span>;
			<span id="perlFunc">push</span><span id="braces">(</span><span id="var">@temp</span>, <span id="var">$tag</span><span id="braces">)</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	
	<span id="perlKey">if</span> <span id="braces">(</span>$#temp == 0<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@out</span>, <span id="var">$temp</span><span id="braces">[</span>0<span id="braces">]</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlFunc">push</span><span id="braces">(</span><span id="var">@out</span>,<span id="var">$self</span>-&gt;<span id="method">resolve_overlaping_tags</span><span id="braces">(</span>\<span id="var">@temp</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="var">@temp</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">return</span> <span id="var">@out</span>;
<span id="braces">}</span>
<span id="perlKey">sub</span> resolve_overlaping_tags <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$temp</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"MERGE"</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="method">merge_overlaping_tags</span><span id="braces">(</span><span id="var">$temp</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"SPLITSCORE"</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="method">splitscore_overlaping_tags</span><span id="braces">(</span><span id="var">$temp</span><span id="braces">)</span>;
	<span id="braces">}</span>
<span id="braces">}</span>
<span id="perlKey">sub</span> merge_overlaping_tags <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$temp</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">@tagobjects</span> = <span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$a</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span> &lt;=&gt; <span id="var">$b</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">}</span> @<span id="braces">{</span><span id="var">$temp</span><span id="braces">}</span>;
	
	<span id="perlKey">my</span> <span id="var">@out</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">$newtag</span> = <span id="var">$tagobjects</span><span id="braces">[</span>0<span id="braces">]</span>;
	<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span> = 1; <span id="var">$i</span> &lt; <span id="var">@tagobjects</span>; <span id="var">$i</span>++<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$tagobjects</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span> &lt; <span id="var">$newtag</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$newtag</span>-&gt;<span id="method">set_start</span><span id="braces">(</span><span id="var">$tagobjects</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$tagobjects</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span> &gt; <span id="var">$newtag</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$newtag</span>-&gt;<span id="method">set_stop</span><span id="braces">(</span><span id="var">$tagobjects</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">my</span> <span id="var">$tempscore</span> = <span id="var">$newtag</span>-&gt;<span id="method">get_score</span><span id="braces">(</span><span id="braces">)</span> + <span id="var">$tagobjects</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>-&gt;<span id="method">get_score</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="var">$newtag</span>-&gt;<span id="method">set_score</span><span id="braces">(</span><span id="var">$tempscore</span><span id="braces">)</span>;
		<span id="var">$newtag</span>-&gt;<span id="method">set_name</span><span id="braces">(</span><span id="var">$tempscore</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@out</span>,<span id="var">$newtag</span><span id="braces">)</span>;
	<span id="perlKey">return</span> <span id="var">@out</span>;
<span id="braces">}</span>
<span id="perlKey">sub</span> splitscore_overlaping_tags <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$temp</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">@tagobjects</span> = <span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$a</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span> &lt;=&gt; <span id="var">$b</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">}</span> @<span id="braces">{</span><span id="var">$temp</span><span id="braces">}</span>;
	
	<span id="perlKey">my</span> <span id="var">@out</span> = <span id="var">@tagobjects</span>;
	<span id="perlKey">my</span> <span id="var">$tag1</span>;
	<span id="perlKey">my</span> <span id="var">$tag2</span>;
	<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span>=0;<span id="var">$i</span>&lt;<span id="var">@tagobjects</span>-1;<span id="var">$i</span>++<span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$tag1</span> = <span id="var">$tagobjects</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>;
		<span id="var">$tag2</span> = <span id="var">$tagobjects</span><span id="braces">[</span><span id="var">$i</span>+1<span id="braces">]</span>;
		
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$tag1</span>-&gt;<span id="method">overlaps</span><span id="braces">(</span><span id="var">$tag2</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">@temp</span> = <span id="var">$self</span>-&gt;<span id="method">divide_tags_by_score</span><span id="braces">(</span><span id="var">$tag1</span>,<span id="var">$tag2</span><span id="braces">)</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$i</span> &gt; 0<span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@temp</span>, <span id="var">@tagobjects</span><span id="braces">[</span>0..<span id="braces">(</span><span id="var">$i</span>-1<span id="braces">)</span><span id="braces">]</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$i</span>+2 &lt;= <span id="var">@tagobjects</span>-1<span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@temp</span>, <span id="var">@tagobjects</span><span id="braces">[</span><span id="braces">(</span><span id="var">$i</span>+2<span id="braces">)</span>..<span id="var">@tagobjects</span>-1<span id="braces">]</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="var">@out</span> = <span id="var">$self</span>-&gt;<span id="method">splitscore_overlaping_tags</span><span id="braces">(</span>\<span id="var">@temp</span><span id="braces">)</span>;
			<span id="perlKey">last</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">@out</span>;
<span id="braces">}</span>
<span id="perlKey">sub</span> divide_tags_by_score <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$tagobj1</span>,<span id="var">$tagobj2</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">@out</span> = <span id="braces">(</span><span id="braces">)</span>;
	
	<span id="perlKey">my</span> <span id="var">$chr</span> = <span id="var">$tagobj1</span>-&gt;<span id="method">get_chr</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">$strand</span> = <span id="var">$tagobj1</span>-&gt;<span id="method">get_strand</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$newobj1_start</span>, <span id="var">$newobj1_stop</span>, <span id="var">$newobj1_score</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$newobj2_start</span>, <span id="var">$newobj2_stop</span>, <span id="var">$newobj2_score</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$newobj3_start</span>, <span id="var">$newobj3_stop</span>, <span id="var">$newobj3_score</span><span id="braces">)</span>;
	
	<span id="var">$newobj1_start</span> = <span id="var">$tagobj1</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="var">$newobj1_stop</span> = <span id="var">$tagobj2</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span>-1;
	<span id="var">$newobj1_score</span> = <span id="var">$tagobj1</span>-&gt;<span id="method">get_score</span><span id="braces">(</span><span id="braces">)</span>;
	
	<span id="var">$newobj2_start</span> = <span id="var">$tagobj2</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="var">$newobj2_score</span> = <span id="var">$tagobj1</span>-&gt;<span id="method">get_score</span><span id="braces">(</span><span id="braces">)</span> + <span id="var">$tagobj2</span>-&gt;<span id="method">get_score</span><span id="braces">(</span><span id="braces">)</span>;
		
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$tagobj1</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span> &gt; <span id="var">$tagobj2</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$newobj2_stop</span> = <span id="var">$tagobj2</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="var">$newobj3_start</span> = <span id="var">$tagobj2</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span>+1;
		<span id="var">$newobj3_stop</span> = <span id="var">$tagobj1</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="var">$newobj3_score</span> = <span id="var">$tagobj1</span>-&gt;<span id="method">get_score</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="var">$newobj2_stop</span> = <span id="var">$tagobj1</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="var">$newobj3_start</span> = <span id="var">$tagobj1</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span>+1;
		<span id="var">$newobj3_stop</span> = <span id="var">$tagobj2</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="var">$newobj3_score</span> = <span id="var">$tagobj2</span>-&gt;<span id="method">get_score</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$newobj1_start</span> &lt;= <span id="var">$newobj1_stop</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$tagObj</span> = <span id="module"><a href="Tag.html">MyBio::NGS::Tag</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
			CHR           =&gt; <span id="var">$chr</span>,
			START         =&gt; <span id="var">$newobj1_start</span>,
			STOP          =&gt; <span id="var">$newobj1_stop</span>,
			STRAND        =&gt; <span id="var">$strand</span>,
			NAME          =&gt; <span id="perlFunc">undef</span>,
			SCORE         =&gt; <span id="var">$newobj1_score</span>,
		<span id="braces">}</span><span id="braces">)</span>;
		<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@out</span>, <span id="var">$tagObj</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$newobj2_start</span> &lt;= <span id="var">$newobj2_stop</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$tagObj</span> = <span id="module"><a href="Tag.html">MyBio::NGS::Tag</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
			CHR           =&gt; <span id="var">$chr</span>,
			START         =&gt; <span id="var">$newobj2_start</span>,
			STOP          =&gt; <span id="var">$newobj2_stop</span>,
			STRAND        =&gt; <span id="var">$strand</span>,
			NAME          =&gt; <span id="perlFunc">undef</span>,
			SCORE         =&gt; <span id="var">$newobj2_score</span>,
		<span id="braces">}</span><span id="braces">)</span>;
		<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@out</span>,<span id="var">$tagObj</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$newobj3_start</span> &lt;= <span id="var">$newobj3_stop</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$tagObj</span> = <span id="module"><a href="Tag.html">MyBio::NGS::Tag</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
			CHR           =&gt; <span id="var">$chr</span>,
			START         =&gt; <span id="var">$newobj3_start</span>,
			STOP          =&gt; <span id="var">$newobj3_stop</span>,
			STRAND        =&gt; <span id="var">$strand</span>,
			NAME          =&gt; <span id="perlFunc">undef</span>,
			SCORE         =&gt; <span id="var">$newobj3_score</span>,
		<span id="braces">}</span><span id="braces">)</span>;
		<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@out</span>,<span id="var">$tagObj</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">@out</span>;
<span id="braces">}</span>
<span id="perlKey">sub</span> find_closest_tag_index_to_position <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$target_value</span>,<span id="var">$tags</span>,<span id="var">$fromIndex</span>,<span id="var">$toIndex</span><span id="braces">)</span>=<span id="var">@_</span>; 
	<span id="comment">#target_value = the value we want to match</span><br />	<span id="comment">#tags = a reference to an array of tag objects. the index will match this array </span><br />	<span id="comment">#fromIndex - toIndex = range of indexes that will be used for the search</span><br />	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$toIndex</span> == -1<span id="braces">)</span><span id="braces">{</span><span id="perlKey">return</span> <span id="var">$fromIndex</span>;<span id="braces">}</span>
	<span id="perlKey">my</span> <span id="var">$closest_index</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$fromIndex</span> == <span id="var">$toIndex</span><span id="braces">)</span><span id="braces">{</span><span id="perlKey">return</span> <span id="var">$fromIndex</span>;<span id="braces">}</span>	
	
	<span id="perlKey">my</span> <span id="var">$scanIndex</span>=<span id="perlFunc">int</span><span id="braces">(</span><span id="var">$fromIndex</span>+<span id="braces">(</span><span id="var">$toIndex</span>-<span id="var">$fromIndex</span><span id="braces">)</span><span id="regExp">/2); #begin at half-way point<br /><br />	if (</span><span id="var">$toIndex</span><span id="regExp"> == </span><span id="var">$fromIndex</span><span id="regExp">+1){</span><span id="var">$closest_index</span><span id="regExp"> = </span><span id="var">$self</span><span id="regExp">-&gt;compare_value_to_the_two_others(</span><span id="var">$target_value</span><span id="regExp">,</span><span id="var">$tags</span><span id="regExp">,(</span><span id="var">$scanIndex</span><span id="regExp">+1),</span><span id="var">$scanIndex</span><span id="regExp">);} #end<br />	elsif (</span><span id="var">$target_value</span> == $$tags[$scanIndex]-&gt;get_start()) {$closest_index = $scanIndex;} #end - found exact value<br />	elsif ($target_value &lt;  $$tags[$scanIndex]-&gt;get_start()) {<br />		if   ($target_value &gt;=  $$tags[$scanIndex-1]-&gt;get_start()) {<br />		<br />			$closest_index = $self-&gt;compare_value_to_the_two_others($target_value,$tags,$scanIndex,($scanIndex-1));<br />		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="var">$closest_index</span> = <span id="var">$self</span>-&gt;<span id="method">find_closest_tag_index_to_position</span><span id="braces">(</span><span id="var">$target_value</span>,<span id="var">$tags</span>,<span id="var">$fromIndex</span>,<span id="var">$scanIndex</span><span id="braces">)</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$target_value</span> &gt;  $$tags<span id="braces">[</span><span id="var">$scanIndex</span><span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span>   <span id="braces">(</span><span id="var">$target_value</span> &lt;=  $$tags<span id="braces">[</span><span id="var">$scanIndex</span>+1<span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		
			<span id="var">$closest_index</span> = <span id="var">$self</span>-&gt;<span id="method">compare_value_to_the_two_others</span><span id="braces">(</span><span id="var">$target_value</span>,<span id="var">$tags</span>,<span id="braces">(</span><span id="var">$scanIndex</span>+1<span id="braces">)</span>,<span id="var">$scanIndex</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="var">$closest_index</span> = <span id="var">$self</span>-&gt;<span id="method">find_closest_tag_index_to_position</span><span id="braces">(</span><span id="var">$target_value</span>,<span id="var">$tags</span>,<span id="var">$scanIndex</span>,<span id="var">$toIndex</span><span id="braces">)</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">$closest_index</span>;
<span id="braces">}</span>
<span id="perlKey">sub</span> compare_value_to_the_two_others <span id="braces">{</span>
	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span>,<span id="var">$tags</span>,<span id="var">$index1</span>,<span id="var">$index2</span><span id="braces">)</span>=<span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$dif1</span>=<span id="perlFunc">abs</span><span id="braces">(</span><span id="var">$value</span>-<span id="braces">(</span>$$tags<span id="braces">[</span><span id="var">$index1</span><span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">$dif2</span>=<span id="perlFunc">abs</span><span id="braces">(</span><span id="var">$value</span>-<span id="braces">(</span>$$tags<span id="braces">[</span><span id="var">$index2</span><span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span><span id="braces">)</span>;
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$dif1</span> &lt;= <span id="var">$dif2</span><span id="braces">)</span> <span id="braces">{</span><span id="perlKey">return</span> <span id="var">$index1</span>;<span id="braces">}</span>
	<span id="perlKey">else</span>                <span id="braces">{</span><span id="perlKey">return</span> <span id="var">$index2</span>;<span id="braces">}</span>
<span id="braces">}</span>

=head2 overlaps

  Arg <span id="braces">[</span>1<span id="braces">]</span>    : object <span id="module">MyBio::NGS:Track</span>
               The track against which <span id="var">$self</span> is compared. 
  Arg <span id="braces">[</span>2<span id="braces">]</span>    : hash reference
               A hash reference containing the parameters <span id="perlKey">for</span> the overlap. Important: The type of overlap <span id="braces">(</span>IS_CONTAINED, TOUCHES<span id="braces">)</span> must be specified!
  Example    : <span id="var">$track</span>-&gt;<span id="method">overlaps</span><span id="braces">(</span><span id="var">$track2</span>, <span id="braces">{</span>
                   METHOD  =&gt;<span id="dqStr">"TOUCHES"</span>,
                   OFFSET  =&gt; 0
               <span id="braces">}</span><span id="braces">)</span>
  Description: Sets <span id="perlKey">for</span> all tags in the <span id="var">$self</span> track the overlap attribute.
               This attribute indicates whether the tag overlaps with any of the tags on the reference track
  Returntype : NULL
  Caller     : ?
  Status     : Experimental <span id="regExp">/ Unstable<br /><br />=cut<br />sub overlaps {<br />	my (</span><span id="var">$self</span><span id="regExp">, </span><span id="var">$track2</span><span id="regExp">, </span><span id="var">$params</span><span id="regExp">) = </span><span id="var">@_</span>;<br />	
	<span id="comment"># Check to enable correction of legacy programs. Previously this sub accepted parameters through an array instead of a hash</span><br />	<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$params</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="dqStr">"HASH"</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
		<span id="perlFunc">die</span> <span id="dqStr">"\n\nDon't panic - Just change the way you call method\&quot; overlaps\&quot; through <span id="var">$class</span> in your calling script $0\n\n"</span>;
	<span id="braces">}</span>
	
	<span id="comment"># Get the method to check overlap</span><br />	<span id="perlKey">my</span> <span id="var">$method</span> = <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'METHOD'</span><span id="braces">}</span>; <span id="perlFunc">delete</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'METHOD'</span><span id="braces">}</span>;
	<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$method</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
		<span id="perlFunc">die</span> <span id="dqStr">"\nNo print method specified in $class\::print_all_tags"</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"IS_CONTAINED"</span><span id="braces">)</span><span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">_overlaps_IS_CONTAINED</span><span id="braces">(</span><span id="var">$track2</span>, <span id="var">$params</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"TOUCHES"</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">_overlaps_TOUCHES</span><span id="braces">(</span><span id="var">$track2</span>, <span id="var">$params</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
		<span id="perlFunc">die</span> <span id="dqStr">"\nUnknown overlap method\&quot; $method\&quot; specified in $class\::overlaps. Try (IS_CONTAINED|TOUCHES)"</span>;
	<span id="braces">}</span>
<span id="braces">}</span>

=head2 _overlaps_IS_CONTAINED

  Arg <span id="braces">[</span>1<span id="braces">]</span>    : object <span id="module">MyBio::NGS:Track</span>
               The track against which <span id="var">$self</span> is compared. 
  Example    : <span id="var">$track</span>-&gt;<span id="method">_overlaps_IS_CONTAINED</span><span id="braces">(</span><span id="var">$track2</span><span id="braces">)</span>
  Description: Sets <span id="perlKey">for</span> all tags in the <span id="var">$self</span> track the overlap attribute.
               This attribute indicates whether the tag overlaps with any of the tags on the reference track.
               A tag is said to overlap with another tag <span id="perlKey">if</span> it is contained within <span id="braces">(</span>both start and end position<span id="braces">)</span> the other tag.
  Returntype : NULL
  Caller     : ?
  Status     : Experimental <span id="regExp">/ Unstable<br /><br />=cut<br />sub _overlaps_IS_CONTAINED {<br />	my (</span><span id="var">$self</span><span id="regExp">, </span><span id="var">$track2</span><span id="regExp">, </span><span id="var">$params</span><span id="regExp">) = </span><span id="var">@_</span>;<br />	
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">my</span> <span id="var">$tags2_ref</span> = <span id="var">$track2</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags2_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag2</span> <span id="braces">(</span>@<span id="braces">{</span>$$tags2_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$tag</span>-&gt;<span id="method">get_stop</span> &lt; <span id="var">$tag2</span>-&gt;<span id="method">get_start</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="perlKey">last</span>;
							<span id="braces">}</span>
							<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$tag2</span>-&gt;<span id="method">contains</span><span id="braces">(</span><span id="var">$tag</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="var">$tag</span>-&gt;<span id="method">set_overlap</span><span id="braces">(</span><span id="var">$track2</span>-&gt;<span id="method">get_id</span>,1<span id="braces">)</span>;
							<span id="braces">}</span>
						<span id="braces">}</span>
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
<span id="braces">}</span>

=head2 _overlaps_TOUCHES

  Arg <span id="braces">[</span>1<span id="braces">]</span>    : object <span id="module">MyBio::NGS:Track</span>
               The track against which <span id="var">$self</span> is compared.
  Arg <span id="braces">[</span>2<span id="braces">]</span>    : hash reference
               A hash reference containing the parameters <span id="perlKey">for</span> the overlap.
  Example    : <span id="var">$track</span>-&gt;<span id="method">_overlaps_TOUCHES</span><span id="braces">(</span><span id="var">$track2</span>, <span id="braces">{</span>
                   OFFSET  =&gt; 0
               <span id="braces">}</span><span id="braces">)</span>
  Description: Sets <span id="perlKey">for</span> all tags in the <span id="var">$self</span> track the overlap attribute.
               This attribute indicates whether the tag overlaps with any of the tags on the reference track.
               A tag is said to overlap with another tag <span id="perlKey">if</span> it is located within OFFSET distance from the other tag.
  Returntype : NULL
  Caller     : ?
  Status     : Experimental <span id="regExp">/ Unstable<br /><br />=cut<br />sub _overlaps_TOUCHES {<br />	my (</span><span id="var">$self</span><span id="regExp">, </span><span id="var">$track2</span><span id="regExp">, </span><span id="var">$params</span><span id="regExp">) = </span><span id="var">@_</span>;<br />	
	<span id="perlKey">my</span> <span id="var">$offset</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OFFSET'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OFFSET'</span><span id="braces">}</span> : 0;
	
	<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$self</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">my</span> <span id="var">$tags2_ref</span> = <span id="var">$track2</span>-&gt;<span id="method">get_tags</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$tags2_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag</span> <span id="braces">(</span>@<span id="braces">{</span>$$tags_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$tag2</span> <span id="braces">(</span>@<span id="braces">{</span>$$tags2_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$tag</span>-&gt;<span id="method">get_stop</span> &lt; <span id="var">$tag2</span>-&gt;<span id="method">get_start</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="perlKey">last</span>;
							<span id="braces">}</span>
							<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$tag2</span>-&gt;<span id="method">overlaps</span><span id="braces">(</span><span id="var">$tag</span>, <span id="var">$offset</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="var">$tag</span>-&gt;<span id="method">set_overlap</span><span id="braces">(</span><span id="var">$track2</span>-&gt;<span id="method">get_id</span>,1<span id="braces">)</span>;
								<span id="var">$tag2</span>-&gt;<span id="method">set_overlap</span><span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_id</span>,1<span id="braces">)</span>;
							<span id="braces">}</span>
						<span id="braces">}</span>
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
<span id="braces">}</span>


<span id="comment">#######################################################################</span><br /><span id="comment">##########################   Class Methods   ##########################</span><br /><span id="comment">#######################################################################</span><br /><span id="braces">{</span>
	<span id="perlKey">my</span> <span id="var">%allTracks</span>;
	<span id="perlKey">my</span> <span id="var">$track_counter</span> = 0;
	
	<span id="perlKey">sub</span> _increase_track_counter <span id="braces">{</span>
		<span id="var">$track_counter</span>++;
		<span id="perlKey">return</span> <span id="var">$track_counter</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">sub</span> _add_to_all <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$obj</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="var">$allTracks</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_id</span><span id="braces">}</span> = <span id="var">$obj</span>;
	<span id="braces">}</span>
	<span id="perlKey">sub</span> _delete_from_all <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$obj</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlFunc">delete</span> <span id="var">$allTracks</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_id</span><span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">sub</span> get_all <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlKey">return</span> <span id="var">%allTracks</span>;
	<span id="braces">}</span>
	<span id="perlKey">sub</span> get_all_in_array <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlKey">return</span> <span id="perlFunc">values</span> <span id="var">%allTracks</span>;
	<span id="braces">}</span>
	<span id="perlKey">sub</span> delete_all <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="var">%allTracks</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">sub</span> get_by_id <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$id</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlKey">return</span> <span id="var">$allTracks</span><span id="braces">{</span><span id="var">$id</span><span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">sub</span> get_by_name <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$name</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlKey">my</span> <span id="var">@outtracks</span> = <span id="braces">(</span><span id="braces">)</span>;
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$track</span> <span id="braces">(</span><span id="perlFunc">values</span> <span id="var">%allTracks</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$name</span> <span id="perlKey">eq</span> <span id="var">$track</span>-&gt;<span id="method">get_name</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">push</span> <span id="var">@outtracks</span>, <span id="var">$track</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">@outtracks</span> &gt; 0<span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="var">@outtracks</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="perlFunc">undef</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">sub</span> read_tracks <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
		<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$params</span><span id="braces">)</span> <span id="perlKey">eq</span> <span id="dqStr">"HASH"</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">die</span> <span id="dqStr">"\n\nDon't panic - Just use hash notation when calling "</span>.<span id="braces">(</span><span id="perlFunc">caller</span><span id="braces">(</span>0<span id="braces">)</span><span id="braces">)</span><span id="braces">[</span>3<span id="braces">]</span>.<span id="dqStr">" in script $0\n\n"</span>;
		<span id="braces">}</span>
		
		<span id="perlKey">my</span> <span id="var">%handlers</span> = <span id="braces">(</span>
			<span id="sqStr">'BED'</span> =&gt;\&amp; _read_bedFile_with_multiple_tracks,
		<span id="braces">)</span>;
		
		<span id="perlKey">my</span> <span id="var">$method</span> = <span id="perlFunc">delete</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'METHOD'</span><span id="braces">}</span>;
		<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$handlers</span><span id="braces">{</span><span id="var">$method</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$method</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">die</span> <span id="dqStr">"\nNo method specified in "</span>.<span id="braces">(</span><span id="perlFunc">caller</span><span id="braces">(</span>0<span id="braces">)</span><span id="braces">)</span><span id="braces">[</span>3<span id="braces">]</span>.<span id="dqStr">"\n"</span>;
			<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="perlFunc">die</span> <span id="dqStr">"\nUnknown method\&quot; $method\&quot; in "</span>.<span id="braces">(</span><span id="perlFunc">caller</span><span id="braces">(</span>0<span id="braces">)</span><span id="braces">)</span><span id="braces">[</span>3<span id="braces">]</span>.<span id="dqStr">". Try (BED)"</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
		
		<span id="perlKey">my</span> <span id="var">%tracks</span> = <span id="var">$handlers</span><span id="braces">{</span><span id="var">$method</span><span id="braces">}</span>-&gt;<span id="braces">(</span><span id="var">$class</span>,<span id="var">$params</span><span id="braces">)</span>;
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$track</span> <span id="braces">(</span><span id="perlFunc">values</span> <span id="var">%tracks</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$track</span>-&gt;<span id="method">sort_tags</span>;
		<span id="braces">}</span>
		
		<span id="perlKey">return</span> <span id="var">%tracks</span>;
	<span id="braces">}</span>
	<span id="perlKey">sub</span> _read_bedFile_with_multiple_tracks <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">$filename</span> = <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'FILENAME'</span><span id="braces">}</span>;
		<span id="perlKey">my</span> <span id="var">$trackname</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'TRACK_NAME'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'TRACK_NAME'</span><span id="braces">}</span> : <span id="perlFunc">scalar</span><span id="braces">(</span><span id="perlFunc">localtime</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span>;
		<span id="perlKey">my</span> <span id="var">$tag_score_thres</span> = <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'SCORE_THRESHOLD'</span><span id="braces">}</span>;
		
		<span id="perlKey">my</span> <span id="var">$track</span>;
		<span id="perlKey">my</span> <span id="var">@browser_info</span>;
		<span id="perlKey">my</span> <span id="var">%return_tracks</span>;
		<span id="perlKey">my</span> <span id="var">$BED</span> = <span id="perlKey">new</span> FileHandle;
		<span id="var">$BED</span>-&gt;<span id="perlFunc">open</span><span id="braces">(</span><span id="var">$filename</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file <span id="var">$filename</span> $!"</span>;
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$line</span>=&lt;<span id="var">$BED</span>&gt;<span id="braces">)</span><span id="braces">{</span>
			<span id="perlFunc">chomp</span><span id="braces">(</span><span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$line</span> =~ <span id="regExp">/^track/</span><span id="braces">)</span><span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">%info</span>;
				<span id="perlKey">while</span> <span id="braces">(</span><span id="var">$line</span> =~ <span id="regExp">/(\S+?)=(&quot;.+?&quot;|\d+?)/g</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$info</span><span id="braces">{</span><span id="var">$1</span><span id="braces">}</span> = <span id="var">$2</span>;
				<span id="braces">}</span>
				<span id="var">$track</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
					NAME            =&gt; <span id="var">$info</span><span id="braces">{</span><span id="dqStr">"name"</span><span id="braces">}</span> || <span id="var">$trackname</span>,
					DESCRIPTION     =&gt; <span id="var">$info</span><span id="braces">{</span><span id="dqStr">"description"</span><span id="braces">}</span>,
					VISIBILITY      =&gt; <span id="var">$info</span><span id="braces">{</span><span id="dqStr">"visibility"</span><span id="braces">}</span>,
					COLOR           =&gt; <span id="var">$info</span><span id="braces">{</span><span id="dqStr">"color"</span><span id="braces">}</span>,
					RGB_FLAG        =&gt; <span id="var">$info</span><span id="braces">{</span><span id="dqStr">"itemRgb"</span><span id="braces">}</span>,
					COLOR_BY_STRAND =&gt; <span id="var">$info</span><span id="braces">{</span><span id="dqStr">"colorByStrand"</span><span id="braces">}</span>,
					USE_SCORE       =&gt; <span id="var">$info</span><span id="braces">{</span><span id="dqStr">"useScore"</span><span id="braces">}</span>,
				<span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">if</span> <span id="braces">(</span><span id="var">@browser_info</span> &gt; 0<span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$track</span>-&gt;<span id="method">push_to_browser</span><span id="braces">(</span><span id="var">@browser_info</span><span id="braces">)</span>;
					<span id="var">@browser_info</span> = <span id="braces">(</span><span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="var">$return_tracks</span><span id="braces">{</span><span id="var">$track</span>-&gt;<span id="method">get_name</span><span id="braces">}</span> = <span id="var">$track</span>;
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$line</span> =~ <span id="regExp">/^browser/</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">push</span> <span id="var">@browser_info</span>,<span id="var">$line</span>;
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$line</span> =~ <span id="regExp">/^chr/</span><span id="braces">)</span> <span id="braces">{</span>
				
				<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$track</span><span id="braces">)</span><span id="braces">{</span>
					<span id="var">$track</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
						NAME            =&gt; <span id="var">$trackname</span>
					<span id="braces">}</span><span id="braces">)</span>;
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">@browser_info</span> &gt; 0<span id="braces">)</span> <span id="braces">{</span>
						<span id="var">$track</span>-&gt;<span id="method">push_to_browser</span><span id="braces">(</span><span id="var">@browser_info</span><span id="braces">)</span>;
						<span id="var">@browser_info</span> = <span id="braces">(</span><span id="braces">)</span>;
					<span id="braces">}</span>
					<span id="var">$return_tracks</span><span id="braces">{</span><span id="var">$track</span>-&gt;<span id="method">get_name</span><span id="braces">}</span> = <span id="var">$track</span>;
				<span id="braces">}</span>
				
				
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$chr</span>,<span id="var">$start</span>,<span id="var">$stop</span>,<span id="var">$name</span>,<span id="var">$score</span>,<span id="var">$strand</span>,<span id="var">@others</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
				
				<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$tag_score_thres</span> or <span id="braces">(</span><span id="var">$score</span> &gt;= <span id="var">$tag_score_thres</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="var">$tag</span> = <span id="module"><a href="Tag.html">MyBio::NGS::Tag</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
						STRAND        =&gt; <span id="var">$strand</span>,
						CHR           =&gt; <span id="var">$chr</span>,
						START         =&gt; <span id="var">$start</span>,
						STOP          =&gt; <span id="var">$stop</span> - 1, <span id="comment">#[start,stop)</span><br />						NAME          =&gt; <span id="var">$name</span>,
						SCORE         =&gt; <span id="var">$score</span>,
						THICK_START   =&gt; <span id="var">$others</span><span id="braces">[</span>0<span id="braces">]</span>,
						THICK_STOP    =&gt; <span id="var">$others</span><span id="braces">[</span>1<span id="braces">]</span>,
						RGB           =&gt; <span id="var">$others</span><span id="braces">[</span>2<span id="braces">]</span>,
						BLOCK_COUNT   =&gt; <span id="var">$others</span><span id="braces">[</span>3<span id="braces">]</span>,
						BLOCK_SIZES   =&gt; <span id="var">$others</span><span id="braces">[</span>4<span id="braces">]</span>,
						BLOCK_STARTS  =&gt; <span id="var">$others</span><span id="braces">[</span>5<span id="braces">]</span>,
					<span id="braces">}</span><span id="braces">)</span>;
					
					<span id="var">$track</span>-&gt;<span id="method">add_tag</span><span id="braces">(</span><span id="var">$tag</span><span id="braces">)</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlFunc">close</span> <span id="var">$BED</span>;
		<span id="perlKey">return</span> <span id="var">%return_tracks</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">sub</span> strands <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">%tracks</span> = <span id="module"><a href="Track.html">MyBio::NGS::Track</a></span>-&gt;<span id="method">get_all</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="perlKey">my</span> <span id="var">%available_strands</span>;
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$track</span> <span id="braces">(</span><span id="perlFunc">values</span> <span id="var">%tracks</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$track</span>-&gt;<span id="method">get_tags</span>;
			<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$available_strands</span><span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span> = 1;
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlKey">return</span> <span id="var">%available_strands</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">sub</span> chromosomes <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">%tracks</span> = <span id="module"><a href="Track.html">MyBio::NGS::Track</a></span>-&gt;<span id="method">get_all</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="perlKey">my</span> <span id="var">%available_chrs</span>;
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$track</span> <span id="braces">(</span><span id="perlFunc">values</span> <span id="var">%tracks</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$tags_ref</span> = <span id="var">$track</span>-&gt;<span id="method">get_tags</span>;
			<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$tags_ref</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$available_chrs</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span> = 1;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlKey">return</span> <span id="var">%available_chrs</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">sub</span> read_track <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
		<span id="perlKey">my</span> <span id="var">%handlers</span> = <span id="braces">(</span>
			<span id="sqStr">'BED'</span> =&gt;\&amp; _read_bedFile_with_single_track,
		<span id="braces">)</span>;
		
		<span id="perlKey">my</span> <span id="var">$method</span> = <span id="perlFunc">delete</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'METHOD'</span><span id="braces">}</span>;
		<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$handlers</span><span id="braces">{</span><span id="var">$method</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$method</span><span id="braces">)</span> <span id="braces">{</span><span id="perlFunc">die</span> <span id="dqStr">"\nNo method specified in "</span>.<span id="braces">(</span><span id="perlFunc">caller</span><span id="braces">(</span>0<span id="braces">)</span><span id="braces">)</span><span id="braces">[</span>3<span id="braces">]</span>.<span id="dqStr">"\n"</span>;<span id="braces">}</span>
			<span id="perlKey">else</span>                  <span id="braces">{</span><span id="perlFunc">die</span> <span id="dqStr">"\nUnknown method\&quot; $method\&quot; in "</span>.<span id="braces">(</span><span id="perlFunc">caller</span><span id="braces">(</span>0<span id="braces">)</span><span id="braces">)</span><span id="braces">[</span>3<span id="braces">]</span>.<span id="dqStr">". Try (BED)"</span>;<span id="braces">}</span>
		<span id="braces">}</span>
		
		<span id="perlKey">my</span> <span id="var">$track</span> = <span id="var">$handlers</span><span id="braces">{</span><span id="var">$method</span><span id="braces">}</span>-&gt;<span id="braces">(</span><span id="var">$class</span>,<span id="var">$params</span><span id="braces">)</span>;
		<span id="var">$track</span>-&gt;<span id="method">sort_tags</span>;
		<span id="perlKey">return</span> <span id="var">$track</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">sub</span> _read_bedFile_with_single_track <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">$file</span> = <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'FILENAME'</span><span id="braces">}</span>;
		<span id="perlKey">my</span> <span id="var">$trackname</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'TRACK_NAME'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'TRACK_NAME'</span><span id="braces">}</span> : <span id="perlFunc">scalar</span><span id="braces">(</span><span id="perlFunc">localtime</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span>;
		<span id="perlKey">my</span> <span id="var">$tag_score_thres</span> = <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'SCORE_THRESHOLD'</span><span id="braces">}</span>;
		
		
		<span id="perlKey">my</span> <span id="var">$track</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
			NAME            =&gt; <span id="var">$trackname</span>,
		<span id="braces">}</span><span id="braces">)</span>;
		
		<span id="perlKey">my</span> <span id="var">$bedfile</span> = <span id="module"><a href="../Data/File/BioFile.html">MyBio::Data::File::BioFile</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
			TYPE =&gt; <span id="sqStr">'BED'</span>,
			FILE =&gt; <span id="var">$file</span>,
		<span id="braces">}</span><span id="braces">)</span>;
		
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$entity</span> = <span id="var">$bedfile</span>-&gt;<span id="method">next_entity</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$entity</span>-&gt;<span id="braces">{</span>LOCUS<span id="braces">}</span> and <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$tag_score_thres</span> or <span id="braces">(</span><span id="var">$entity</span>-&gt;<span id="braces">{</span>SCORE<span id="braces">}</span> &gt;= <span id="var">$tag_score_thres</span><span id="braces">)</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$track</span>-&gt;<span id="method">add_tag</span><span id="braces">(</span><span id="module"><a href="Tag.html">MyBio::NGS::Tag</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="var">$entity</span><span id="braces">)</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$entity</span>-&gt;<span id="braces">{</span>TRACK_INFO<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$entity</span>-&gt;<span id="braces">{</span>NAME<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$track</span>-&gt;<span id="method">set_name</span><span id="braces">(</span><span id="var">$entity</span>-&gt;<span id="braces">{</span>NAME<span id="braces">}</span><span id="braces">)</span><span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$entity</span>-&gt;<span id="braces">{</span>DESCRIPTION<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$track</span>-&gt;<span id="method">set_description</span><span id="braces">(</span><span id="var">$entity</span>-&gt;<span id="braces">{</span>DESCRIPTION<span id="braces">}</span><span id="braces">)</span><span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$entity</span>-&gt;<span id="braces">{</span>VISIBILITY<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$track</span>-&gt;<span id="method">set_visibility</span><span id="braces">(</span><span id="var">$entity</span>-&gt;<span id="braces">{</span>VISIBILITY<span id="braces">}</span><span id="braces">)</span><span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$entity</span>-&gt;<span id="braces">{</span>COLOR<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$track</span>-&gt;<span id="method">set_color</span><span id="braces">(</span><span id="var">$entity</span>-&gt;<span id="braces">{</span>COLOR<span id="braces">}</span><span id="braces">)</span><span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$entity</span>-&gt;<span id="braces">{</span>RGB_FLAG<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$track</span>-&gt;<span id="method">set_rgb_flag</span><span id="braces">(</span><span id="var">$entity</span>-&gt;<span id="braces">{</span>RGB_FLAG<span id="braces">}</span><span id="braces">)</span><span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$entity</span>-&gt;<span id="braces">{</span>COLOR_BY_STRAND<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$track</span>-&gt;<span id="method">set_color_by_strand</span><span id="braces">(</span><span id="var">$entity</span>-&gt;<span id="braces">{</span>COLOR_BY_STRAND<span id="braces">}</span><span id="braces">)</span><span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$entity</span>-&gt;<span id="braces">{</span>USE_SCORE<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$track</span>-&gt;<span id="method">set_use_score</span><span id="braces">(</span><span id="var">$entity</span>-&gt;<span id="braces">{</span>USE_SCORE<span id="braces">}</span><span id="braces">)</span><span id="braces">}</span>
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$entity</span>-&gt;<span id="braces">{</span>BROWSER<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$track</span>-&gt;<span id="method">push_to_browser</span><span id="braces">(</span><span id="var">$entity</span>-&gt;<span id="braces">{</span>BROWSER<span id="braces">}</span><span id="braces">)</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlKey">return</span> <span id="var">$track</span>;
	<span id="braces">}</span>
<span id="braces">}</span>

1;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE33" id="CODE33"></a>print_track_line</td><td >description</td><td ><a href="#CODE32">prev</a></td><td ><a href="#CODE34">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print_track_line</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$method</span>, <span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"BED"</span><span id="braces">)</span><span id="braces">{</span>
		<span id="perlFunc">print</span> <span id="var">$self</span>-&gt;<span id="method">output_track_line</span><span id="braces">(</span><span id="dqStr">"BED"</span>, <span id="var">@attributes</span><span id="braces">)</span>.<span id="dqStr">"\n"</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"WIG"</span><span id="braces">)</span><span id="braces">{</span>
		<span id="perlFunc">print</span> <span id="var">$self</span>-&gt;<span id="method">output_track_line</span><span id="braces">(</span><span id="dqStr">"WIG"</span>, <span id="var">@attributes</span><span id="braces">)</span>.<span id="dqStr">"\n"</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE34" id="CODE34"></a>push_to_browser</td><td >description</td><td ><a href="#CODE33">prev</a></td><td ><a href="#CODE35">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">push_to_browser</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">@values</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlFunc">push</span> @<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_browser</span><span id="braces">}</span>,<span id="var">@values</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE35" id="CODE35"></a>set_browser</td><td >description</td><td ><a href="#CODE34">prev</a></td><td ><a href="#CODE36">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_browser</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>BROWSER<span id="braces">}</span> = <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> ? <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> : <span id="braces">[</span><span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE36" id="CODE36"></a>set_color</td><td >description</td><td ><a href="#CODE35">prev</a></td><td ><a href="#CODE37">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_color</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>COLOR<span id="braces">}</span>=<span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE37" id="CODE37"></a>set_color_by_strand</td><td >description</td><td ><a href="#CODE36">prev</a></td><td ><a href="#CODE38">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_color_by_strand</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>COLOR_BY_STRAND<span id="braces">}</span>=<span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE38" id="CODE38"></a>set_description</td><td >description</td><td ><a href="#CODE37">prev</a></td><td ><a href="#CODE39">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_description</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>DESCRIPTION<span id="braces">}</span>=<span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE39" id="CODE39"></a>set_extra</td><td >description</td><td ><a href="#CODE38">prev</a></td><td ><a href="#CODE40">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_extra</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>EXTRA_INFO<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE40" id="CODE40"></a>set_file</td><td >description</td><td ><a href="#CODE39">prev</a></td><td ><a href="#CODE41">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_file</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>FILE<span id="braces">}</span> = <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> ? <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> : <span id="perlFunc">undef</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE41" id="CODE41"></a>set_filetype</td><td >description</td><td ><a href="#CODE40">prev</a></td><td ><a href="#CODE42">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_filetype</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>FILETYPE<span id="braces">}</span> = <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> ? <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> : <span id="perlFunc">undef</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE42" id="CODE42"></a>set_id</td><td >description</td><td ><a href="#CODE41">prev</a></td><td ><a href="#CODE43">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_id</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>ID<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE43" id="CODE43"></a>set_name</td><td >description</td><td ><a href="#CODE42">prev</a></td><td ><a href="#CODE44">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_name</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>NAME<span id="braces">}</span>=<span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE44" id="CODE44"></a>set_rgb_flag</td><td >description</td><td ><a href="#CODE43">prev</a></td><td ><a href="#CODE45">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_rgb_flag</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>RGB_FLAG<span id="braces">}</span>=<span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE45" id="CODE45"></a>set_species</td><td >description</td><td ><a href="#CODE44">prev</a></td><td ><a href="#CODE46">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_species</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>SPECIES<span id="braces">}</span>=<span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE46" id="CODE46"></a>set_tag_count</td><td >description</td><td ><a href="#CODE45">prev</a></td><td ><a href="#CODE47">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_tag_count</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_COUNT<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE47" id="CODE47"></a>set_tag_score_mean</td><td >description</td><td ><a href="#CODE46">prev</a></td><td ><a href="#CODE48">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_tag_score_mean</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_MEAN<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE48" id="CODE48"></a>set_tag_score_sum</td><td >description</td><td ><a href="#CODE47">prev</a></td><td ><a href="#CODE49">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_tag_score_sum</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_SUM<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE49" id="CODE49"></a>set_tag_score_variance</td><td >description</td><td ><a href="#CODE48">prev</a></td><td ><a href="#CODE50">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_tag_score_variance</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAG_SCORE_VARIANCE<span id="braces">}</span> = <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE50" id="CODE50"></a>set_tags</td><td >description</td><td ><a href="#CODE49">prev</a></td><td ><a href="#CODE51">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_tags</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>TAGS<span id="braces">}</span> = <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> ? <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> : <span id="braces">{</span><span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE51" id="CODE51"></a>set_use_score</td><td >description</td><td ><a href="#CODE50">prev</a></td><td ><a href="#CODE52">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_use_score</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>USE_SCORE<span id="braces">}</span>=<span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE52" id="CODE52"></a>set_visibility</td><td >description</td><td ><a href="#CODE51">prev</a></td><td >next</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_visibility</span>
{<pre>	<span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>VISIBILITY<span id="braces">}</span>=<span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$_</span><span id="braces">[</span>1<span id="braces">]</span>;</pre>}</td></div>
<div id="sep"></div>
<a name="General" id="General"></a>
<div id="mainTitle">General documentation</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_EXAMPLES" id="_pod_EXAMPLES"></a>EXAMPLES</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"><pre id="podParagraph">    # Read tracks from a file in BED format
    my %tracks = <B>MyBio::NGS::Track</B>->read_tracks("BED",$filename);
    
    # Parse the above read hash and print tags for each track in FASTA format
    foreach my $track (values %tracks) {
        $track->print_all_tags("FASTA",'STDOUT',"/data1/data/UCSC/hg19/chromosomes/");
    }</pre></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_AUTHOR - Panagiotis Alexiou, Manolis Maragkakis" id="_pod_AUTHOR - Panagiotis Alexiou, Manolis Maragkakis"></a>AUTHOR - Panagiotis Alexiou, Manolis Maragkakis</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">Email <a href="mailto:pan.alexiou@fleming.gr" id="podEmail">pan.alexiou@fleming.gr</a>, <a href="mailto:maragkakis@fleming.gr" id="podEmail">maragkakis@fleming.gr</a></div>
<div id="sep"></div>
</body>
</html>
