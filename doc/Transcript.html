<head>
<!-- Generated by perlmod2www.pl -->
<title>
Transcript documentation.
</title>
<link rel="stylesheet" type="text/css" href="perl.css">
</head>
<body bgcolor="white">
<span id="modRootPath">MyBio</span>
<span id="modName">Transcript</span>
<div id="sep"></div>
<a name="TOP" id="TOP"></a>
<table id="daArea" width="100%"><tr><td id="daEntry" ><a href="#SUMMARY">Summary</a></td><td id="daEntry" ><a href="#libs">Included libraries</a></td><td id="daEntry" ><a href="#vardefs">Package variables</a></td><td id="daEntry" ><a href="#SYNOPSIS">Synopsis</a></td><td id="daEntry" ><a href="#DESCRIPTION">Description</a></td><td id="daEntry" ><a href="#General">General documentation</a></td><td id="daEntry" ><a href="#Methods">Methods</a></td></tr></table>
<div id="sep"></div>
<div id="descTitle">Summary</div>
<div id="descArea"><B>MyBio::Transcript</B> - Transcript object, with features</div>
<div id="sep"></div>
<a name="vardefs" id="vardefs"></a><div id="descTitle">Package variables</div>
<div id="descArea"><div id="libEntry"><div id="descSubTitle">Privates (from <b>"my"</b> definitions)</div>
</div>
<div id="libEntry"><span id="var">%allTranscripts</span>;</div>
<div id="libEntry"><span id="var">$DBconnector</span>;</div>
<div id="libEntry"><span id="var">$accessPolicy</span> = <span id="module"><a href="DBconnector.html">MyBio::DBconnector</a></span>-&gt;<span id="method">global_access</span><span id="braces">(</span><span id="braces">)</span></div>
<div id="libEntry"><span id="var">$select_all_from_transcripts_where_enstid</span>;</div>
<div id="libEntry"><span id="var">$select_all_from_transcripts_where_enstid_Query</span> = <span id="perlFunc">qq</span><span id="dqStr">/<span id="regExp">/</span>/</span>SELECT * FROM diana_transcripts WHERE diana_transcripts.enstid=?/</div>
</div>
<div id="sep"></div>
<div id="descTitle">Included modules</div>
<div id="descArea"><div id="libEntry"><span id="use"><a href="DBconnector.html">MyBio::DBconnector</a></span> </div>
<div id="libEntry"><span id="use"><a href="Gene.html">MyBio::Gene</a></span> </div>
<div id="libEntry"><span id="use"><a href="Helper/Locus.html">MyBio::Helper::Locus</a></span> </div>
<div id="libEntry"><span id="use"><a href="MySub.html">MyBio::MySub</a></span> </div>
<div id="libEntry"><span id="use"><a href="Transcript/CDNA.html">MyBio::Transcript::CDNA</a></span> </div>
<div id="libEntry"><span id="use"><a href="Transcript/CDS.html">MyBio::Transcript::CDS</a></span> </div>
<div id="libEntry"><span id="use"><a href="Transcript/UTR3.html">MyBio::Transcript::UTR3</a></span> </div>
<div id="libEntry"><span id="use"><a href="Transcript/UTR5.html">MyBio::Transcript::UTR5</a></span> </div>
<div id="libEntry"><span id="use">Scalar::Util</span> qw /weaken/ </div>
</div>
<div id="sep"></div>
<a name="libs" id="libs"></a>
<div id="descTitle">Inherit</div>
<div id="descArea"><span id="isa"><a href="SplicedLocus.html">MyBio::SplicedLocus</a></span> </div>
<div id="sep"></div>
<a name="SYNOPSIS" id="SYNOPSIS"></a>
<div id="descTitle">Synopsis</div>
<div id="descArea"><pre id="podParagraph">    # This is the main transcript object
    # It represents a transcript of a gene
    
    # To initialize 
    my $transcript = <B>MyBio::Transcript</B>->new({
        ENSTID         => undef,
        SPECIES        => undef,
        STRAND         => undef,
        CHR            => undef,
        START          => undef,
        STOP           => undef,
        GENE           => undef, # MyBio::Gene
        UTR5           => undef, # MyBio::Transcript::UTR5
        CDS            => undef, # MyBio::Transcript::CDS
        UTR3           => undef, # MyBio::Transcript::UTR3
        CDNA           => undef, # MyBio::Transcript::CDNA
        BIOTYPE        => undef,
        INTERNAL_ID    => undef,
        INTERNAL_GID   => undef,
        EXTRA_INFO     => undef,
    });</pre>
</div>
<div id="sep"></div>
<a name="DESCRIPTION" id="DESCRIPTION"></a>
<div id="descTitle">Description</div>
<div id="descArea"><pre id="podParagraph">    The Transcript class describes a transcript of a gene. It has a backreference back to the gene where it belongs
    and contains functional regions such as 5'UTR, CDS and 3'UTR for protein coding genes. If the gene is not protein
    coding then the CDNA region is set and the above remain undefined. It's up to the user to check if the attributes
    are defined or not. The transcript class inherits the SplicedLocus class so it also describes a genomic region
    where Introns and Exons are defined.</pre>
</div>
<div id="sep"></div>
<a name="Methods" id="Methods"></a>
<div id="descTitle">Methods</div>
<table id="methIndArea" width="100%" cellspacing="0"><tr><td id="methIndEntry">_add_to_all</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE1">Code</a></td></tr>
<tr><td id="methIndEntry">_delete_from_all</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE2">Code</a></td></tr>
<tr><td id="methIndEntry">_init</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE3">Code</a></td></tr>
<tr><td id="methIndEntry">_read_accessibility_from_fasta_file_and_update_transcript_objects</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE4">Code</a></td></tr>
<tr><td id="methIndEntry">_read_exon_info_file</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE5">Code</a></td></tr>
<tr><td id="methIndEntry">_read_file_with_region_info_for_transcripts</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE6">Code</a></td></tr>
<tr><td id="methIndEntry">_read_file_with_transcripts</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE7">Code</a></td></tr>
<tr><td id="methIndEntry">_read_gtf_with_transcripts</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE8">Code</a></td></tr>
<tr><td id="methIndEntry">_read_transcript_internal_IDs_from_file</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE9">Code</a></td></tr>
<tr><td id="methIndEntry">allow_database_access</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE10">Code</a></td></tr>
<tr><td id="methIndEntry">create_cdna</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE11">Code</a></td></tr>
<tr><td id="methIndEntry">create_cds</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE12">Code</a></td></tr>
<tr><td id="methIndEntry">create_new_transcript_from_database</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE13">Code</a></td></tr>
<tr><td id="methIndEntry">create_utr3</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE14">Code</a></td></tr>
<tr><td id="methIndEntry">create_utr5</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE15">Code</a></td></tr>
<tr><td id="methIndEntry">database_access</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE16">Code</a></td></tr>
<tr><td id="methIndEntry">delete</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE17">Code</a></td></tr>
<tr><td id="methIndEntry">delete_all</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE18">Code</a></td></tr>
<tr><td id="methIndEntry">deny_database_access</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE19">Code</a></td></tr>
<tr><td id="methIndEntry">get_all</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE20">Code</a></td></tr>
<tr><td id="methIndEntry">get_biotype</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE21">Code</a></td></tr>
<tr><td id="methIndEntry">get_by_enstid</td><td id="methIndEntry"><a href="#POD1">Description</a></td><td id="methIndEntry"><a href="#CODE22">Code</a></td></tr>
<tr><td id="methIndEntry">get_cdna</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE23">Code</a></td></tr>
<tr><td id="methIndEntry">get_cds</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE24">Code</a></td></tr>
<tr><td id="methIndEntry">get_coding_start</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE25">Code</a></td></tr>
<tr><td id="methIndEntry">get_coding_stop</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE26">Code</a></td></tr>
<tr><td id="methIndEntry">get_db_connector</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE27">Code</a></td></tr>
<tr><td id="methIndEntry">get_enstid</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE28">Code</a></td></tr>
<tr><td id="methIndEntry">get_exons_split_by_function</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE29">Code</a></td></tr>
<tr><td id="methIndEntry">get_gene</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE30">Code</a></td></tr>
<tr><td id="methIndEntry">get_internalGID</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE31">Code</a></td></tr>
<tr><td id="methIndEntry">get_internalID</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE32">Code</a></td></tr>
<tr><td id="methIndEntry">get_utr3</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE33">Code</a></td></tr>
<tr><td id="methIndEntry">get_utr5</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE34">Code</a></td></tr>
<tr><td id="methIndEntry">is_coding</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE35">Code</a></td></tr>
<tr><td id="methIndEntry">read_region_info_for_transcripts</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE36">Code</a></td></tr>
<tr><td id="methIndEntry">read_transcript_internal_IDs</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE37">Code</a></td></tr>
<tr><td id="methIndEntry">read_transcripts</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE38">Code</a></td></tr>
<tr><td id="methIndEntry">set_biotype</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE39">Code</a></td></tr>
<tr><td id="methIndEntry">set_cdna</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE40">Code</a></td></tr>
<tr><td id="methIndEntry">set_cds</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE41">Code</a></td></tr>
<tr><td id="methIndEntry">set_coding_start</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE42">Code</a></td></tr>
<tr><td id="methIndEntry">set_coding_stop</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE43">Code</a></td></tr>
<tr><td id="methIndEntry">set_enstid</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE44">Code</a></td></tr>
<tr><td id="methIndEntry">set_gene</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE45">Code</a></td></tr>
<tr><td id="methIndEntry">set_internalGID</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE46">Code</a></td></tr>
<tr><td id="methIndEntry">set_internalID</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE47">Code</a></td></tr>
<tr><td id="methIndEntry">set_sequences_from_genome</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE48">Code</a></td></tr>
<tr><td id="methIndEntry">set_utr3</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE49">Code</a></td></tr>
<tr><td id="methIndEntry">set_utr5</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE50">Code</a></td></tr>
<tr><td id="methIndEntry">update_transcripts_with_accessibility</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE51">Code</a></td></tr>
</table>
<div id="sep"></div>
<a name="MethDesc" id="MethDesc"></a>
<div id="mainTitle">Methods description</div>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_get_by_enstid" id="_pod_get_by_enstid"></a><a name="POD1" id="POD1"></a>get_by_enstid</td><td ><a href="#CODE22">code</a></td><td >&nbsp;&nbsp;&nbsp;&nbsp;</td><td ><a href="#POD2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : string $enstid
               The primary id of the transcript.
  Example    : <B>MyBio::Transcript</B>->get_by_enstid;
  Description: Class method that returns the object which corresponds to the provided primary transcript id.
               If no object is found, then depending on the database access policy the method either attempts
               to create a new object or returns NULL
  Returntype : <B>MyBio::Transcript</B> / NULL
  Caller     : ?
  Status     : Stable</pre></td></tr></table>
<div id="sep"></div>
<a name="MethCode" id="MethCode"></a>
<div id="mainTitle">Methods code</div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE1" id="CODE1"></a>_add_to_all</td><td >description</td><td >prev</td><td ><a href="#CODE2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_add_to_all</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$obj</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="var">$allTranscripts</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_enstid</span><span id="braces">}</span> = <span id="var">$obj</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE2" id="CODE2"></a>_delete_from_all</td><td >description</td><td ><a href="#CODE1">prev</a></td><td ><a href="#CODE3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_delete_from_all</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$obj</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlFunc">delete</span> <span id="var">$allTranscripts</span><span id="braces">{</span><span id="var">$obj</span>-&gt;<span id="method">get_enstid</span><span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE3" id="CODE3"></a>_init</td><td >description</td><td ><a href="#CODE2">prev</a></td><td ><a href="#CODE4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_init</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$data</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="var">$self</span>-&gt;<span id="method">SUPER</span>::<span id="method">_init</span><span id="braces">(</span><span id="var">$data</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_enstid</span><span id="braces">(</span>$$data<span id="braces">{</span>ENSTID<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_biotype</span><span id="braces">(</span>$$data<span id="braces">{</span>BIOTYPE<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_internalID</span><span id="braces">(</span>$$data<span id="braces">{</span>INTERNAL_ID<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_internalGID</span><span id="braces">(</span>$$data<span id="braces">{</span>INTERNAL_GID<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_coding_start</span><span id="braces">(</span>$$data<span id="braces">{</span>CODING_START<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_coding_stop</span><span id="braces">(</span>$$data<span id="braces">{</span>CODING_STOP<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_gene</span><span id="braces">(</span>$$data<span id="braces">{</span>GENE<span id="braces">}</span><span id="braces">)</span>; <span id="comment"># MyBio::Gene</span><br />	<span id="var">$self</span>-&gt;<span id="method">set_cdna</span><span id="braces">(</span>$$data<span id="braces">{</span>CDNA<span id="braces">}</span><span id="braces">)</span>; <span id="comment"># MyBio::Transcript::CDNA</span><br />	<span id="var">$self</span>-&gt;<span id="method">set_utr5</span><span id="braces">(</span>$$data<span id="braces">{</span>UTR5<span id="braces">}</span><span id="braces">)</span>; <span id="comment"># MyBio::Transcript::UTR5</span><br />	<span id="var">$self</span>-&gt;<span id="method">set_cds</span><span id="braces">(</span>$$data<span id="braces">{</span>CDS<span id="braces">}</span><span id="braces">)</span>;   <span id="comment"># MyBio::Transcript::CDS</span><br />	<span id="var">$self</span>-&gt;<span id="method">set_utr3</span><span id="braces">(</span>$$data<span id="braces">{</span>UTR3<span id="braces">}</span><span id="braces">)</span>; <span id="comment"># MyBio::Transcript::UTR3</span><br />	
	<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
	<span id="var">$class</span>-&gt;<span id="method">_add_to_all</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span>;
	
	<span id="perlKey">return</span> <span id="var">$self</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE4" id="CODE4"></a>_read_accessibility_from_fasta_file_and_update_transcript_objects</td><td >description</td><td ><a href="#CODE3">prev</a></td><td ><a href="#CODE5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_read_accessibility_from_fasta_file_and_update_transcript_objects</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$file</span><span id="braces">)</span>=<span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">$transcript</span>;
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$FASTA</span>,<span id="dqStr">"&lt;"</span>,<span id="var">$file</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file <span id="var">$file</span>: $!"</span>;
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$line</span>=&lt;<span id="var">$FASTA</span>&gt;<span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">chomp</span><span id="braces">(</span><span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,0,1<span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'&gt;'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$enstid</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,1<span id="braces">)</span>;
				<span id="var">$transcript</span> = <span id="var">$class</span>-&gt;<span id="method">get_by_enstid</span><span id="braces">(</span><span id="var">$enstid</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,0,4<span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'UTR5'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$what</span>,<span id="var">$accessibility</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
				<span id="var">$transcript</span>-&gt;<span id="method">get_utr5</span>-&gt;<span id="method">set_accessibility</span><span id="braces">(</span><span id="var">$accessibility</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,0,3<span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'CDS'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$what</span>,<span id="var">$accessibility</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
				<span id="var">$transcript</span>-&gt;<span id="method">get_cds</span>-&gt;<span id="method">set_accessibility</span><span id="braces">(</span><span id="var">$accessibility</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,0,4<span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'UTR3'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$what</span>,<span id="var">$accessibility</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
				<span id="var">$transcript</span>-&gt;<span id="method">get_utr3</span>-&gt;<span id="method">set_accessibility</span><span id="braces">(</span><span id="var">$accessibility</span><span id="braces">)</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlFunc">close</span> <span id="var">$FASTA</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE5" id="CODE5"></a>_read_exon_info_file</td><td >description</td><td ><a href="#CODE4">prev</a></td><td ><a href="#CODE6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_read_exon_info_file</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$file</span><span id="braces">)</span>=<span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">%transcripts_for_genename</span>;
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$IN</span>,<span id="dqStr">"&lt;"</span>,<span id="var">$file</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file <span id="var">$file</span>: $!"</span>;
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$line</span>=&lt;<span id="var">$IN</span>&gt;<span id="braces">)</span><span id="braces">{</span>
			<span id="perlFunc">chomp</span><span id="braces">(</span><span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="braces">(</span><span id="var">$line</span> !~ <span id="regExp">/^#/</span><span id="braces">)</span> and <span id="braces">(</span><span id="var">$line</span> <span id="perlKey">ne</span> <span id="sqStr">''</span><span id="braces">)</span> and <span id="braces">(</span><span id="var">$line</span> !~ <span id="regExp">/^\s*$/</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$tid</span>,<span id="var">$genename</span>,<span id="var">$exon_id</span>,<span id="var">$chr</span>,<span id="var">$start</span>,<span id="var">$stop</span>,<span id="var">$id</span>,<span id="var">$score</span>,<span id="var">$strand</span>,<span id="var">$UTR5</span>,<span id="var">$UTR3</span>,<span id="var">$CDS</span>,<span id="var">$coding</span>,<span id="var">$UTR5_CDS_break</span>,<span id="var">$UTR3_CDS_break</span>,<span id="var">$length</span>,<span id="var">$description</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
				<span id="var">$stop</span> = <span id="var">$stop</span>-1;
				
				<span id="perlKey">my</span> <span id="var">$transcriptObj</span> = <span id="var">$class</span>-&gt;<span id="method">get_by_enstid</span><span id="braces">(</span><span id="var">$tid</span><span id="braces">)</span>;
				<span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$transcriptObj</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$transcriptObj</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
						ENSTID   =&gt; <span id="var">$tid</span>,
						CHR      =&gt; <span id="var">$chr</span>,
						STRAND   =&gt; <span id="var">$strand</span>,
						BIOTYPE  =&gt; <span id="sqStr">'non coding'</span>,
					<span id="braces">}</span><span id="braces">)</span>;
					<span id="perlFunc">push</span> @<span id="braces">{</span><span id="var">$transcripts_for_genename</span><span id="braces">{</span><span id="var">$genename</span><span id="braces">}</span><span id="braces">}</span>,<span id="var">$transcriptObj</span>;
					<span id="var">$transcriptObj</span>-&gt;<span id="braces">{</span>TEMP_DESCRIPTION<span id="braces">}</span> = <span id="var">$description</span>;
				<span id="braces">}</span>
				
				<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$transcriptObj</span>-&gt;<span id="method">get_start</span> or <span id="braces">(</span><span id="var">$start</span> &lt; <span id="var">$transcriptObj</span>-&gt;<span id="method">get_start</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$transcriptObj</span>-&gt;<span id="method">set_start</span><span id="braces">(</span><span id="var">$start</span><span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$transcriptObj</span>-&gt;<span id="method">get_stop</span> or <span id="braces">(</span><span id="var">$stop</span> &gt; <span id="var">$transcriptObj</span>-&gt;<span id="method">get_stop</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$transcriptObj</span>-&gt;<span id="method">set_stop</span><span id="braces">(</span><span id="var">$stop</span><span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="var">$transcriptObj</span>-&gt;<span id="method">push_splice_start_stop_pair</span><span id="braces">(</span><span id="var">$start</span>,<span id="var">$stop</span><span id="braces">)</span>;
				
				<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$coding</span> == 1<span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$transcriptObj</span>-&gt;<span id="method">set_biotype</span><span id="braces">(</span><span id="sqStr">'coding'</span><span id="braces">)</span>;
				<span id="braces">}</span>
				
				<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$CDS</span> == 1<span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="var">@breakpoints</span> = <span id="braces">(</span><span id="var">$start</span><span id="braces">)</span>;
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$UTR5</span> == 1<span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">if</span>    <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="sqStr">'+'</span><span id="braces">)</span> <span id="braces">{</span><span id="perlFunc">push</span> <span id="var">@breakpoints</span>, <span id="var">$UTR5_CDS_break</span> + 1;<span id="braces">}</span>
						<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span><span id="perlFunc">push</span> <span id="var">@breakpoints</span>, <span id="var">$UTR5_CDS_break</span>;<span id="braces">}</span>
					<span id="braces">}</span>
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$UTR3</span> == 1<span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">if</span>    <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="sqStr">'+'</span><span id="braces">)</span> <span id="braces">{</span><span id="perlFunc">push</span> <span id="var">@breakpoints</span>, <span id="var">$UTR3_CDS_break</span>;<span id="braces">}</span>
						<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span><span id="perlFunc">push</span> <span id="var">@breakpoints</span>, <span id="var">$UTR3_CDS_break</span> + 1;<span id="braces">}</span>
					<span id="braces">}</span>
					<span id="perlFunc">push</span> <span id="var">@breakpoints</span>, <span id="var">$stop</span>+1;
					<span id="var">@breakpoints</span> = <span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$a</span> &lt;=&gt; <span id="var">$b</span><span id="braces">}</span> <span id="var">@breakpoints</span>;
					
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$UTR5</span> == 1<span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="sqStr">'+'</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="perlFunc">shift</span> <span id="var">@breakpoints</span>;
						<span id="braces">}</span>
						<span id="perlKey">else</span> <span id="braces">{</span>
							<span id="perlFunc">pop</span> <span id="var">@breakpoints</span>;
						<span id="braces">}</span>
					<span id="braces">}</span>
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$UTR3</span> == 1<span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="sqStr">'+'</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="perlFunc">pop</span> <span id="var">@breakpoints</span>;
						<span id="braces">}</span>
						<span id="perlKey">else</span> <span id="braces">{</span>
							<span id="perlFunc">shift</span> <span id="var">@breakpoints</span>;
						<span id="braces">}</span>
					<span id="braces">}</span>
					
					<span id="perlKey">my</span> <span id="var">$set_start</span> = <span id="var">$breakpoints</span><span id="braces">[</span>0<span id="braces">]</span>;
					<span id="perlKey">my</span> <span id="var">$set_stop</span> = <span id="var">$breakpoints</span><span id="braces">[</span>1<span id="braces">]</span> - 1;
					
					<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$transcriptObj</span>-&gt;<span id="method">get_coding_start</span> or <span id="var">$set_start</span> &lt; <span id="var">$transcriptObj</span>-&gt;<span id="method">get_coding_start</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="var">$transcriptObj</span>-&gt;<span id="method">set_coding_start</span><span id="braces">(</span><span id="var">$set_start</span><span id="braces">)</span>;
					<span id="braces">}</span>
					
					<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$transcriptObj</span>-&gt;<span id="method">get_coding_stop</span> or <span id="var">$set_stop</span> &gt; <span id="var">$transcriptObj</span>-&gt;<span id="method">get_coding_stop</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="var">$transcriptObj</span>-&gt;<span id="method">set_coding_stop</span><span id="braces">(</span><span id="var">$set_stop</span><span id="braces">)</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlFunc">close</span> <span id="var">$IN</span>;
		
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$genename</span> <span id="braces">(</span><span id="perlFunc">keys</span> <span id="var">%transcripts_for_genename</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$merged_loci</span>,<span id="var">$included_transcripts</span><span id="braces">)</span> = <span id="module"><a href="Helper/Locus.html">MyBio::Helper::Locus</a></span>::<span id="method">merge</span><span id="braces">(</span><span id="var">$transcripts_for_genename</span><span id="braces">{</span><span id="var">$genename</span><span id="braces">}</span><span id="braces">)</span>;
			<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span>=0;<span id="var">$i</span>&lt;@$merged_loci;$i++<span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$gene</span> = <span id="module"><a href="Gene.html">MyBio::Gene</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span>$$merged_loci<span id="braces">[</span><span id="var">$i</span><span id="braces">]</span><span id="braces">)</span>;
				<span id="var">$gene</span>-&gt;<span id="method">set_name</span><span id="braces">(</span><span id="var">$genename</span><span id="braces">)</span>;
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span>$$included_transcripts<span id="braces">[</span><span id="var">$i</span><span id="braces">]</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$gene</span>-&gt;<span id="method">set_description</span><span id="braces">(</span><span id="perlFunc">delete</span> <span id="var">$transcript</span>-&gt;<span id="braces">{</span>TEMP_DESCRIPTION<span id="braces">}</span><span id="braces">)</span>;
					<span id="var">$gene</span>-&gt;<span id="method">add_transcript</span><span id="braces">(</span><span id="var">$transcript</span><span id="braces">)</span>;
					<span id="var">$transcript</span>-&gt;<span id="method">set_gene</span><span id="braces">(</span><span id="var">$gene</span><span id="braces">)</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
		
		<span id="perlKey">return</span> <span id="var">%allTranscripts</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE6" id="CODE6"></a>_read_file_with_region_info_for_transcripts</td><td >description</td><td ><a href="#CODE5">prev</a></td><td ><a href="#CODE7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_read_file_with_region_info_for_transcripts</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$file</span><span id="braces">)</span>=<span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">$transcript</span>;
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$FASTA</span>,<span id="dqStr">"&lt;"</span>,<span id="var">$file</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file <span id="var">$file</span>: $!"</span>;
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$line</span>=&lt;<span id="var">$FASTA</span>&gt;<span id="braces">)</span><span id="braces">{</span>
			<span id="perlFunc">chomp</span><span id="braces">(</span><span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,0,1<span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'&gt;'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$line</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,1<span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$enstid</span>,<span id="var">$strand</span>,<span id="var">$chr</span>,<span id="var">$ensgid</span>,<span id="var">$species</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\|/</span>,<span id="var">$line</span><span id="braces">)</span>;
				
				<span id="comment"># Search if the gene has already been defined. If not create it</span><br />				<span id="perlKey">my</span> <span id="var">$geneObj</span> = <span id="module"><a href="Gene.html">MyBio::Gene</a></span>-&gt;<span id="method">get_by_ensgid</span><span id="braces">(</span><span id="var">$ensgid</span><span id="braces">)</span>;
				<span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$geneObj</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$geneObj</span> = <span id="module"><a href="Gene.html">MyBio::Gene</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
								ENSGID   =&gt; <span id="var">$ensgid</span>,
								<span id="braces">}</span><span id="braces">)</span>;
				<span id="braces">}</span>
				
				<span id="var">$transcript</span> = <span id="var">$class</span>-&gt;<span id="method">get_by_enstid</span><span id="braces">(</span><span id="var">$enstid</span><span id="braces">)</span>;
				<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$transcript</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_strand</span><span id="braces">)</span>  <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_strand</span><span id="braces">(</span><span id="var">$strand</span><span id="braces">)</span>;<span id="braces">}</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_chr</span><span id="braces">)</span>     <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_chr</span><span id="braces">(</span><span id="var">$chr</span><span id="braces">)</span>;<span id="braces">}</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_gene</span><span id="braces">)</span>    <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_gene</span><span id="braces">(</span><span id="var">$geneObj</span><span id="braces">)</span>;<span id="braces">}</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_species</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_species</span><span id="braces">(</span><span id="var">$species</span><span id="braces">)</span>;<span id="braces">}</span>
				<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span>
					<span id="var">$transcript</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
								ENSTID           =&gt; <span id="var">$enstid</span>,
								STRAND           =&gt; <span id="var">$strand</span>,
								CHR              =&gt; <span id="var">$chr</span>,
								SPECIES          =&gt; <span id="var">$species</span>,
								GENE             =&gt; <span id="var">$geneObj</span>,
								<span id="braces">}</span><span id="braces">)</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,0,4<span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'UTR5'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$what</span>,<span id="var">$splice_starts</span>,<span id="var">$splice_stops</span>,<span id="var">$sequence</span>,<span id="var">$accessibility</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="var">$utr5Obj</span> = <span id="module"><a href="Transcript/UTR5.html">MyBio::Transcript::UTR5</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
									TRANSCRIPT       =&gt; <span id="var">$transcript</span>,
									SPLICE_STARTS    =&gt; <span id="var">$splice_starts</span>,
									SPLICE_STOPS     =&gt; <span id="var">$splice_stops</span>,
									SEQUENCE         =&gt; <span id="var">$sequence</span>,
									ACCESSIBILITY    =&gt; <span id="var">$accessibility</span>,
									<span id="braces">}</span><span id="braces">)</span>;
				<span id="var">$transcript</span>-&gt;<span id="method">set_utr5</span><span id="braces">(</span><span id="var">$utr5Obj</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,0,3<span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'CDS'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$what</span>,<span id="var">$splice_starts</span>,<span id="var">$splice_stops</span>,<span id="var">$sequence</span>,<span id="var">$accessibility</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="var">$cdsObj</span> = <span id="module"><a href="Transcript/CDS.html">MyBio::Transcript::CDS</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
									TRANSCRIPT       =&gt; <span id="var">$transcript</span>,
									SPLICE_STARTS    =&gt; <span id="var">$splice_starts</span>,
									SPLICE_STOPS     =&gt; <span id="var">$splice_stops</span>,
									SEQUENCE         =&gt; <span id="var">$sequence</span>,
									ACCESSIBILITY    =&gt; <span id="var">$accessibility</span>,
									<span id="braces">}</span><span id="braces">)</span>;
				<span id="var">$transcript</span>-&gt;<span id="method">set_cds</span><span id="braces">(</span><span id="var">$cdsObj</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,0,4<span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'UTR3'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$what</span>,<span id="var">$splice_starts</span>,<span id="var">$splice_stops</span>,<span id="var">$sequence</span>,<span id="var">$accessibility</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="var">$utr3Obj</span> = <span id="module"><a href="Transcript/UTR3.html">MyBio::Transcript::UTR3</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
									TRANSCRIPT       =&gt; <span id="var">$transcript</span>,
									SPLICE_STARTS    =&gt; <span id="var">$splice_starts</span>,
									SPLICE_STOPS     =&gt; <span id="var">$splice_stops</span>,
									SEQUENCE         =&gt; <span id="var">$sequence</span>,
									ACCESSIBILITY    =&gt; <span id="var">$accessibility</span>,
									<span id="braces">}</span><span id="braces">)</span>;
				<span id="var">$transcript</span>-&gt;<span id="method">set_utr3</span><span id="braces">(</span><span id="var">$utr3Obj</span><span id="braces">)</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlFunc">close</span> <span id="var">$FASTA</span>;
		
		<span id="perlKey">return</span> <span id="var">%allTranscripts</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE7" id="CODE7"></a>_read_file_with_transcripts</td><td >description</td><td ><a href="#CODE6">prev</a></td><td ><a href="#CODE8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_read_file_with_transcripts</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$file</span><span id="braces">)</span>=<span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">$transcript</span>;
		<span id="perlKey">my</span> <span id="var">$species</span>;
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$IN</span>,<span id="dqStr">"&lt;"</span>,<span id="var">$file</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file <span id="var">$file</span>: $!"</span>;
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$line</span>=&lt;<span id="var">$IN</span>&gt;<span id="braces">)</span><span id="braces">{</span>
			<span id="perlFunc">chomp</span><span id="braces">(</span><span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,0,1<span id="braces">)</span> <span id="perlKey">ne</span> <span id="sqStr">'#'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$ensgid</span>,<span id="var">$enstid</span>,<span id="var">$chr</span>,<span id="var">$strand</span>,<span id="var">$start</span>,<span id="var">$stop</span>,<span id="var">$biotype</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>,<span id="var">$line</span><span id="braces">)</span>;
				
				<span id="comment"># Search if the gene has already been defined. If not create it</span><br />				<span id="perlKey">my</span> <span id="var">$geneObj</span> = <span id="module"><a href="Gene.html">MyBio::Gene</a></span>-&gt;<span id="method">get_by_ensgid</span><span id="braces">(</span><span id="var">$ensgid</span><span id="braces">)</span>;
				<span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$geneObj</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$geneObj</span> = <span id="module"><a href="Gene.html">MyBio::Gene</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
								ENSGID   =&gt; <span id="var">$ensgid</span>,
								<span id="braces">}</span><span id="braces">)</span>;
				<span id="braces">}</span>
				
				<span id="var">$transcript</span> = <span id="var">$class</span>-&gt;<span id="method">get_by_enstid</span><span id="braces">(</span><span id="var">$enstid</span><span id="braces">)</span>;
				<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$transcript</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_enstid</span><span id="braces">)</span>  <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_enstid</span><span id="braces">(</span><span id="var">$enstid</span><span id="braces">)</span>;<span id="braces">}</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_species</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_species</span><span id="braces">(</span><span id="var">$species</span><span id="braces">)</span>;<span id="braces">}</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_strand</span><span id="braces">)</span>  <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_strand</span><span id="braces">(</span><span id="var">$strand</span><span id="braces">)</span>;<span id="braces">}</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_chr</span><span id="braces">)</span>     <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_chr</span><span id="braces">(</span><span id="var">$chr</span><span id="braces">)</span>;<span id="braces">}</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_start</span><span id="braces">)</span>   <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_start</span><span id="braces">(</span><span id="var">$start</span><span id="braces">)</span>;<span id="braces">}</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_stop</span><span id="braces">)</span>    <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_stop</span><span id="braces">(</span><span id="var">$stop</span><span id="braces">)</span>;<span id="braces">}</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_biotype</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_biotype</span><span id="braces">(</span><span id="var">$biotype</span><span id="braces">)</span>;<span id="braces">}</span>
					<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span>-&gt;<span id="method">get_gene</span><span id="braces">)</span>    <span id="braces">{</span><span id="var">$transcript</span>-&gt;<span id="method">set_gene</span><span id="braces">(</span><span id="var">$geneObj</span><span id="braces">)</span>;<span id="braces">}</span>
					
				<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span>
					<span id="var">$transcript</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
						ENSTID           =&gt; <span id="var">$enstid</span>,
						SPECIES          =&gt; <span id="var">$species</span>,
						STRAND           =&gt; <span id="var">$strand</span>,
						CHR              =&gt; <span id="var">$chr</span>,
						START            =&gt; <span id="var">$start</span>,
						STOP             =&gt; <span id="var">$stop</span>,
						BIOTYPE          =&gt; <span id="var">$biotype</span>,
						GENE             =&gt; <span id="var">$geneObj</span>,
					<span id="braces">}</span><span id="braces">)</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$line</span>,0,1<span id="braces">)</span> <span id="perlKey">eq</span> <span id="sqStr">'#'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$line</span> =~ <span id="regExp">/species=&quot;(.+)&quot;/</span>;
				<span id="var">$species</span> = <span id="var">$1</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlFunc">close</span> <span id="var">$IN</span>;
		
		<span id="perlKey">return</span> <span id="var">%allTranscripts</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE8" id="CODE8"></a>_read_gtf_with_transcripts</td><td >description</td><td ><a href="#CODE7">prev</a></td><td ><a href="#CODE9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_read_gtf_with_transcripts</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$file</span><span id="braces">)</span>=<span id="var">@_</span>;
		
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$IN</span>,<span id="dqStr">"&lt;"</span>,<span id="var">$file</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file <span id="var">$file</span>: $!"</span>;
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$line</span>=&lt;<span id="var">$IN</span>&gt;<span id="braces">)</span><span id="braces">{</span>
			<span id="perlFunc">chomp</span><span id="braces">(</span><span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="braces">(</span><span id="var">$line</span> !~ <span id="regExp">/^#/</span><span id="braces">)</span> and <span id="braces">(</span><span id="var">$line</span> <span id="perlKey">ne</span> <span id="sqStr">''</span><span id="braces">)</span> and <span id="braces">(</span><span id="var">$line</span> !~ <span id="regExp">/^\s*$/</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$chr</span>, <span id="var">$genome</span>, <span id="var">$type</span>, <span id="var">$start</span>, <span id="var">$stop</span>, <span id="var">$score</span>, <span id="var">$strand</span>, <span id="perlFunc">undef</span>, <span id="var">$nameinfo</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\t/</span>, <span id="var">$line</span><span id="braces">)</span>;
				<span id="var">$start</span> = <span id="var">$start</span>-1; <span id="comment">#GTF is one based closed =&gt; convert to 0-based closed.</span><br />				<span id="var">$stop</span> = <span id="var">$stop</span>-1;
				<span id="var">$nameinfo</span> =~ <span id="regExp">/gene_id\s+\&quot;(.+)\&quot;\;\s+transcript_id\s+\&quot;(.+)\&quot;/</span>;
				<span id="perlKey">my</span> <span id="var">$ensgid</span> = <span id="var">$1</span>;
				<span id="perlKey">my</span> <span id="var">$enstid</span> = <span id="var">$2</span>;
				
				<span id="perlKey">my</span> <span id="var">$geneObj</span> = <span id="module"><a href="Gene.html">MyBio::Gene</a></span>-&gt;<span id="method">get_by_ensgid</span><span id="braces">(</span><span id="var">$ensgid</span><span id="braces">)</span>;
				<span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$geneObj</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$geneObj</span> = <span id="module"><a href="Gene.html">MyBio::Gene</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
						ENSGID   =&gt; <span id="var">$ensgid</span>,
					<span id="braces">}</span><span id="braces">)</span>;
				<span id="braces">}</span>
				
				<span id="perlKey">my</span> <span id="var">$transcriptObj</span> = <span id="var">$class</span>-&gt;<span id="method">get_by_enstid</span><span id="braces">(</span><span id="var">$enstid</span><span id="braces">)</span>;
				<span id="perlKey">unless</span> <span id="braces">(</span><span id="var">$transcriptObj</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$transcriptObj</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
						ENSTID   =&gt; <span id="var">$enstid</span>,
						GENE     =&gt; <span id="var">$geneObj</span>,
						CHR      =&gt; <span id="var">$chr</span>,
						STRAND   =&gt; <span id="var">$strand</span>,
						BIOTYPE  =&gt; <span id="sqStr">'non coding'</span>,
					<span id="braces">}</span><span id="braces">)</span>;
					<span id="var">$geneObj</span>-&gt;<span id="method">add_transcript</span><span id="braces">(</span><span id="var">$transcriptObj</span><span id="braces">)</span>;
				<span id="braces">}</span>
				
				<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$transcriptObj</span>-&gt;<span id="method">get_start</span> or <span id="braces">(</span><span id="var">$start</span> &lt; <span id="var">$transcriptObj</span>-&gt;<span id="method">get_start</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$transcriptObj</span>-&gt;<span id="method">set_start</span><span id="braces">(</span><span id="var">$start</span><span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$transcriptObj</span>-&gt;<span id="method">get_stop</span> or <span id="braces">(</span><span id="var">$stop</span> &gt; <span id="var">$transcriptObj</span>-&gt;<span id="method">get_stop</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$transcriptObj</span>-&gt;<span id="method">set_stop</span><span id="braces">(</span><span id="var">$stop</span><span id="braces">)</span>;
				<span id="braces">}</span>
				
				<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$type</span> =~ <span id="regExp">/exon/</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$transcriptObj</span>-&gt;<span id="method">push_splice_start_stop_pair</span><span id="braces">(</span><span id="var">$start</span>,<span id="var">$stop</span><span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$type</span> =~ <span id="regExp">/codon/</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$transcriptObj</span>-&gt;<span id="method">set_biotype</span><span id="braces">(</span><span id="sqStr">'coding'</span><span id="braces">)</span>;
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$type</span> <span id="perlKey">eq</span> <span id="sqStr">'start_codon'</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="sqStr">'+'</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$transcriptObj</span>-&gt;<span id="method">set_coding_start</span><span id="braces">(</span><span id="var">$start</span><span id="braces">)</span>;
						<span id="braces">}</span>
						<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$transcriptObj</span>-&gt;<span id="method">set_coding_stop</span><span id="braces">(</span><span id="var">$stop</span><span id="braces">)</span>;
						<span id="braces">}</span>
					<span id="braces">}</span>
					<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$type</span> <span id="perlKey">eq</span> <span id="sqStr">'stop_codon'</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="sqStr">'+'</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$transcriptObj</span>-&gt;<span id="method">set_coding_stop</span><span id="braces">(</span><span id="var">$stop</span><span id="braces">)</span>;
						<span id="braces">}</span>
						<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$strand</span> <span id="perlKey">eq</span> <span id="sqStr">'-'</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$transcriptObj</span>-&gt;<span id="method">set_coding_start</span><span id="braces">(</span><span id="var">$start</span><span id="braces">)</span>;
						<span id="braces">}</span>
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlFunc">close</span> <span id="var">$IN</span>;
		<span id="perlKey">return</span> <span id="var">%allTranscripts</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE9" id="CODE9"></a>_read_transcript_internal_IDs_from_file</td><td >description</td><td ><a href="#CODE8">prev</a></td><td ><a href="#CODE10">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_read_transcript_internal_IDs_from_file</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$file</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$IDS</span>,<span id="dqStr">"&lt;"</span>,<span id="var">$file</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file <span id="var">$file</span>: $!"</span>;
		<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$line</span>=&lt;<span id="var">$IDS</span>&gt;<span id="braces">)</span><span id="braces">{</span>
			<span id="perlFunc">chomp</span><span id="braces">(</span><span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$internalID</span>,<span id="var">$enstid</span>,<span id="var">$ensgid</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\|/</span>,<span id="var">$line</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="var">$transcript</span> = <span id="var">$class</span>-&gt;<span id="method">get_by_enstid</span><span id="braces">(</span><span id="var">$enstid</span><span id="braces">)</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$transcript</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$transcript</span>-&gt;<span id="method">set_internalID</span><span id="braces">(</span><span id="var">$internalID</span><span id="braces">)</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlFunc">close</span> <span id="braces">(</span><span id="var">$IDS</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE10" id="CODE10"></a>allow_database_access</td><td >description</td><td ><a href="#CODE9">prev</a></td><td ><a href="#CODE11">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">allow_database_access</span>
{<pre>		<span id="var">$accessPolicy</span> = <span id="sqStr">'ALLOW'</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE11" id="CODE11"></a>create_cdna</td><td >description</td><td ><a href="#CODE10">prev</a></td><td ><a href="#CODE12">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">create_cdna</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="var">$self</span>-&gt;<span id="braces">{</span>CDNA<span id="braces">}</span> = <span id="module"><a href="Transcript/CDNA.html">MyBio::Transcript::CDNA</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
		START         =&gt; <span id="var">$self</span>-&gt;<span id="method">get_start</span>,
		STOP          =&gt; <span id="var">$self</span>-&gt;<span id="method">get_stop</span>,
		SPLICE_STARTS =&gt; <span id="var">$self</span>-&gt;<span id="method">get_splice_starts</span>,
		SPLICE_STOPS  =&gt; <span id="var">$self</span>-&gt;<span id="method">get_splice_stops</span>,
		TRANSCRIPT    =&gt; <span id="var">$self</span>
	<span id="braces">}</span><span id="braces">)</span>;
	<span id="perlKey">return</span> 0;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE12" id="CODE12"></a>create_cds</td><td >description</td><td ><a href="#CODE11">prev</a></td><td ><a href="#CODE13">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">create_cds</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_coding_start</span> and <span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_coding_stop</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>CDS<span id="braces">}</span> = <span id="module"><a href="Transcript/CDS.html">MyBio::Transcript::CDS</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
			START      =&gt; <span id="var">$self</span>-&gt;<span id="method">get_coding_start</span>,
			STOP       =&gt; <span id="var">$self</span>-&gt;<span id="method">get_coding_stop</span>,
			TRANSCRIPT =&gt; <span id="var">$self</span>
		<span id="braces">}</span><span id="braces">)</span>;
		<span id="var">$self</span>-&gt;<span id="method">get_cds</span>-&gt;<span id="method">set_splicing_info</span><span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_splice_starts</span>,<span id="var">$self</span>-&gt;<span id="method">get_splice_stops</span><span id="braces">)</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE13" id="CODE13"></a>create_new_transcript_from_database</td><td >description</td><td ><a href="#CODE12">prev</a></td><td ><a href="#CODE14">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">create_new_transcript_from_database</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$enstid</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">$DBconnector</span> = <span id="var">$class</span>-&gt;<span id="method">get_db_connector</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$DBconnector</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$dbh</span> = <span id="var">$DBconnector</span>-&gt;<span id="method">get_handle</span><span id="braces">(</span><span id="braces">)</span>;
			<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$select_all_from_transcripts_where_enstid</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$select_all_from_transcripts_where_enstid</span> = <span id="var">$dbh</span>-&gt;<span id="method">prepare</span><span id="braces">(</span><span id="var">$select_all_from_transcripts_where_enstid_Query</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="var">$select_all_from_transcripts_where_enstid</span>-&gt;<span id="method">execute</span><span id="braces">(</span><span id="var">$enstid</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="var">$fetch_hash_ref</span> = <span id="var">$select_all_from_transcripts_where_enstid</span>-&gt;<span id="method">fetchrow_hashref</span>;
			<span id="var">$select_all_from_transcripts_where_enstid</span>-&gt;<span id="method">finish</span><span id="braces">(</span><span id="braces">)</span>; <span id="comment"># there should be only one result so I have to indicate that fetching is over</span><br />			
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> $$fetch_hash_ref<span id="braces">{</span>internal_tid<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$transcript</span> = <span id="var">$class</span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
							   INTERNAL_ID      =&gt; $$fetch_hash_ref<span id="braces">{</span>internal_tid<span id="braces">}</span>,
							   INTERNAL_GID     =&gt; $$fetch_hash_ref<span id="braces">{</span>internal_gid<span id="braces">}</span>,
							   ENSTID           =&gt; $$fetch_hash_ref<span id="braces">{</span>enstid<span id="braces">}</span>,
							   SPECIES          =&gt; $$fetch_hash_ref<span id="braces">{</span>species<span id="braces">}</span>,
							   STRAND           =&gt; $$fetch_hash_ref<span id="braces">{</span>strand<span id="braces">}</span>,
							   CHR              =&gt; $$fetch_hash_ref<span id="braces">{</span>chromosome<span id="braces">}</span>,
							   START            =&gt; $$fetch_hash_ref<span id="braces">{</span>start<span id="braces">}</span>,
							   STOP             =&gt; $$fetch_hash_ref<span id="braces">{</span>stop<span id="braces">}</span>,
							   BIOTYPE          =&gt; $$fetch_hash_ref<span id="braces">{</span>biotype<span id="braces">}</span>,
							<span id="braces">}</span><span id="braces">)</span>;
				<span id="perlKey">return</span> <span id="var">$transcript</span>;
			<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="perlFunc">warn</span> <span id="dqStr">"Transcript\&quot; $enstid\&quot; could not be found in database. Please check that the transcript already exists\n"</span>;
				<span id="perlKey">return</span> <span id="perlFunc">undef</span>;
			<span id="braces">}</span>
			
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE14" id="CODE14"></a>create_utr3</td><td >description</td><td ><a href="#CODE13">prev</a></td><td ><a href="#CODE15">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">create_utr3</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_coding_start</span> and <span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_coding_stop</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$utr3_start</span> = <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_strand</span> == 1<span id="braces">)</span> ? <span id="var">$self</span>-&gt;<span id="method">get_coding_stop</span> + 1 : <span id="var">$self</span>-&gt;<span id="method">get_start</span>;
		<span id="perlKey">my</span> <span id="var">$utr3_stop</span> = <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_strand</span> == 1<span id="braces">)</span> ? <span id="var">$self</span>-&gt;<span id="method">get_stop</span> : <span id="var">$self</span>-&gt;<span id="method">get_coding_start</span> - 1;
		<span id="var">$self</span>-&gt;<span id="braces">{</span>UTR3<span id="braces">}</span> = <span id="module"><a href="Transcript/UTR3.html">MyBio::Transcript::UTR3</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
			START      =&gt; <span id="var">$utr3_start</span>,
			STOP       =&gt; <span id="var">$utr3_stop</span>,
			TRANSCRIPT =&gt; <span id="var">$self</span>
		<span id="braces">}</span><span id="braces">)</span>;
		<span id="var">$self</span>-&gt;<span id="method">get_utr3</span>-&gt;<span id="method">set_splicing_info</span><span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_splice_starts</span>,<span id="var">$self</span>-&gt;<span id="method">get_splice_stops</span><span id="braces">)</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE15" id="CODE15"></a>create_utr5</td><td >description</td><td ><a href="#CODE14">prev</a></td><td ><a href="#CODE16">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">create_utr5</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_coding_start</span> and <span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_coding_stop</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$utr5_start</span> = <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_strand</span> == 1<span id="braces">)</span> ? <span id="var">$self</span>-&gt;<span id="method">get_start</span> : <span id="var">$self</span>-&gt;<span id="method">get_coding_stop</span> + 1;
		<span id="perlKey">my</span> <span id="var">$utr5_stop</span> = <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_strand</span> == 1<span id="braces">)</span> ? <span id="var">$self</span>-&gt;<span id="method">get_coding_start</span> - 1 : <span id="var">$self</span>-&gt;<span id="method">get_stop</span>;
		<span id="var">$self</span>-&gt;<span id="braces">{</span>UTR5<span id="braces">}</span> = <span id="module"><a href="Transcript/UTR5.html">MyBio::Transcript::UTR5</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
			START      =&gt; <span id="var">$utr5_start</span>,
			STOP       =&gt; <span id="var">$utr5_stop</span>,
			TRANSCRIPT =&gt; <span id="var">$self</span>
		<span id="braces">}</span><span id="braces">)</span>;
		<span id="var">$self</span>-&gt;<span id="method">get_utr5</span>-&gt;<span id="method">set_splicing_info</span><span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_splice_starts</span>,<span id="var">$self</span>-&gt;<span id="method">get_splice_stops</span><span id="braces">)</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE16" id="CODE16"></a>database_access</td><td >description</td><td ><a href="#CODE15">prev</a></td><td ><a href="#CODE17">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">database_access</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">while</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$accessPolicy</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">print</span> STDERR <span id="dqStr">"Would you like to enable database access to retrieve data for class <span id="var">$class</span>? (y/n) [n]"</span>;
			<span id="perlKey">my</span> <span id="var">$userChoice</span> = &lt;&gt;;
			<span id="perlFunc">chomp</span> <span id="braces">(</span><span id="var">$userChoice</span><span id="braces">)</span>;
			<span id="perlKey">if</span>    <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">''</span><span id="braces">)</span>  <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">deny_database_access</span>;<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">'y'</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">allow_database_access</span>;<span id="braces">}</span>
			<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">'n'</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">deny_database_access</span>;<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span><span id="perlFunc">print</span> STDERR <span id="sqStr">'Choice not recognised. Please specify (y/n)'</span>.<span id="dqStr">"\n"</span>;<span id="braces">}</span>
		<span id="braces">}</span>
		
		<span id="perlKey">return</span> <span id="var">$accessPolicy</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE17" id="CODE17"></a>delete</td><td >description</td><td ><a href="#CODE16">prev</a></td><td ><a href="#CODE18">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">delete</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
	<span id="perlKey">my</span> <span id="var">$gene_transcripts</span> = <span id="var">$self</span>-&gt;<span id="method">get_gene</span>-&gt;<span id="method">get_transcripts</span>;
	<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span>=0;<span id="var">$i</span>&lt;@$gene_transcripts;$i++<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$self</span> <span id="perlKey">eq</span> $$gene_transcripts<span id="braces">[</span><span id="var">$i</span><span id="braces">]</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">splice</span> @$gene_transcripts,$i,1;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="var">$class</span>-&gt;<span id="method">_delete_from_all</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE18" id="CODE18"></a>delete_all</td><td >description</td><td ><a href="#CODE17">prev</a></td><td ><a href="#CODE19">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">delete_all</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="var">%allTranscripts</span> = <span id="braces">(</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE19" id="CODE19"></a>deny_database_access</td><td >description</td><td ><a href="#CODE18">prev</a></td><td ><a href="#CODE20">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">deny_database_access</span>
{<pre>		<span id="var">$accessPolicy</span> = <span id="sqStr">'DENY'</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE20" id="CODE20"></a>get_all</td><td >description</td><td ><a href="#CODE19">prev</a></td><td ><a href="#CODE21">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_all</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlKey">return</span> <span id="var">%allTranscripts</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE21" id="CODE21"></a>get_biotype</td><td >description</td><td ><a href="#CODE20">prev</a></td><td ><a href="#CODE22">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_biotype</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>BIOTYPE<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE22" id="CODE22"></a>get_by_enstid</td><td ><a href="#POD1">description</a></td><td ><a href="#CODE21">prev</a></td><td ><a href="#CODE23">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_by_enstid</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$enstid</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$allTranscripts</span><span id="braces">{</span><span id="var">$enstid</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="var">$allTranscripts</span><span id="braces">{</span><span id="var">$enstid</span><span id="braces">}</span>;
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$class</span>-&gt;<span id="method">database_access</span> <span id="perlKey">eq</span> <span id="sqStr">'ALLOW'</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="var">$class</span>-&gt;<span id="method">create_new_transcript_from_database</span><span id="braces">(</span><span id="var">$enstid</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="perlKey">return</span> <span id="perlFunc">undef</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE23" id="CODE23"></a>get_cdna</td><td >description</td><td ><a href="#CODE22">prev</a></td><td ><a href="#CODE24">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_cdna</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>CDNA<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>CDNA<span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">create_cdna</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>CDNA<span id="braces">}</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE24" id="CODE24"></a>get_cds</td><td >description</td><td ><a href="#CODE23">prev</a></td><td ><a href="#CODE25">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_cds</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>CDS<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>CDS<span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_biotype</span> <span id="perlKey">eq</span> <span id="sqStr">'coding'</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">create_cds</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>CDS<span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$class</span>-&gt;<span id="method">database_access</span> <span id="perlKey">eq</span> <span id="sqStr">'ALLOW'</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">set_cds</span><span id="braces">(</span><span id="module"><a href="Transcript/CDS.html">MyBio::Transcript::CDS</a></span>-&gt;<span id="method">create_new_CDS_from_database</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span><span id="braces">)</span>;
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>CDS<span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="perlFunc">undef</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE25" id="CODE25"></a>get_coding_start</td><td >description</td><td ><a href="#CODE24">prev</a></td><td ><a href="#CODE26">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_coding_start</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>CODING_START<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE26" id="CODE26"></a>get_coding_stop</td><td >description</td><td ><a href="#CODE25">prev</a></td><td ><a href="#CODE27">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_coding_stop</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>CODING_STOP<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE27" id="CODE27"></a>get_db_connector</td><td >description</td><td ><a href="#CODE26">prev</a></td><td ><a href="#CODE28">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_db_connector</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> = <span id="var">@_</span>;
		<span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$class</span><span id="braces">)</span> || <span id="var">$class</span>;
		
		<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$DBconnector</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">while</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$accessPolicy</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">print</span> STDERR <span id="dqStr">"Would you like to enable database access to retrieve data for class <span id="var">$class</span>? (y/n) [n]"</span>;
				<span id="perlKey">my</span> <span id="var">$userChoice</span> = &lt;&gt;;
				<span id="perlFunc">chomp</span> <span id="braces">(</span><span id="var">$userChoice</span><span id="braces">)</span>;
				<span id="perlKey">if</span>    <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">''</span><span id="braces">)</span>  <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">deny_database_access</span>;<span id="braces">}</span>
				<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">'y'</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">allow_database_access</span>;<span id="braces">}</span>
				<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$userChoice</span> <span id="perlKey">eq</span> <span id="sqStr">'n'</span><span id="braces">)</span> <span id="braces">{</span><span id="var">$class</span>-&gt;<span id="method">deny_database_access</span>;<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span><span id="perlFunc">print</span> STDERR <span id="sqStr">'Choice not recognised. Please specify (y/n)'</span>.<span id="dqStr">"\n"</span>;<span id="braces">}</span>
			<span id="braces">}</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$accessPolicy</span> <span id="perlKey">eq</span> <span id="sqStr">'ALLOW'</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="module"><a href="DBconnector.html">MyBio::DBconnector</a></span>-&gt;<span id="perlFunc">exists</span><span id="braces">(</span><span id="dqStr">"core"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$DBconnector</span> = <span id="module"><a href="DBconnector.html">MyBio::DBconnector</a></span>-&gt;<span id="method">get_dbconnector</span><span id="braces">(</span><span id="dqStr">"core"</span><span id="braces">)</span>;
				<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span>
					<span id="perlFunc">print</span> STDERR <span id="dqStr">"\nRequesting database connector for class $class\n"</span>;
					<span id="var">$DBconnector</span> = <span id="module"><a href="DBconnector.html">MyBio::DBconnector</a></span>-&gt;<span id="method">get_dbconnector</span><span id="braces">(</span><span id="var">$class</span><span id="braces">)</span>;
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlKey">return</span> <span id="var">$DBconnector</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE28" id="CODE28"></a>get_enstid</td><td >description</td><td ><a href="#CODE27">prev</a></td><td ><a href="#CODE29">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_enstid</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>ENSTID<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE29" id="CODE29"></a>get_exons_split_by_function</td><td >description</td><td ><a href="#CODE28">prev</a></td><td ><a href="#CODE30">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_exons_split_by_function</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">is_coding</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">@exons</span>;
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_utr5</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span> <span id="var">@exons</span>,@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_utr5</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span>;
		<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_cds</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span> <span id="var">@exons</span>,@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_cds</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span>;
		<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="method">get_utr3</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span> <span id="var">@exons</span>,@<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">get_utr3</span>-&gt;<span id="method">get_exons</span><span id="braces">}</span>;
		<span id="braces">}</span>
		<span id="perlKey">return</span>\@ exons;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="method">get_cdna</span>-&gt;<span id="method">get_exons</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE30" id="CODE30"></a>get_gene</td><td >description</td><td ><a href="#CODE29">prev</a></td><td ><a href="#CODE31">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_gene</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>GENE<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE31" id="CODE31"></a>get_internalGID</td><td >description</td><td ><a href="#CODE30">prev</a></td><td ><a href="#CODE32">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_internalGID</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>INTERNAL_GID<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE32" id="CODE32"></a>get_internalID</td><td >description</td><td ><a href="#CODE31">prev</a></td><td ><a href="#CODE33">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_internalID</span>
{<pre>	<span id="perlKey">return</span> <span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="braces">{</span>INTERNAL_ID<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE33" id="CODE33"></a>get_utr3</td><td >description</td><td ><a href="#CODE32">prev</a></td><td ><a href="#CODE34">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_utr3</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>UTR3<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>UTR3<span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_biotype</span> <span id="perlKey">eq</span> <span id="sqStr">'coding'</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">create_utr3</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>UTR3<span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$class</span>-&gt;<span id="method">database_access</span> <span id="perlKey">eq</span> <span id="sqStr">'ALLOW'</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">set_utr3</span><span id="braces">(</span><span id="module"><a href="Transcript/UTR3.html">MyBio::Transcript::UTR3</a></span>-&gt;<span id="method">create_new_UTR3_from_database</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span><span id="braces">)</span>;
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>UTR3<span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="perlFunc">undef</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE34" id="CODE34"></a>get_utr5</td><td >description</td><td ><a href="#CODE33">prev</a></td><td ><a href="#CODE35">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_utr5</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">my</span> <span id="var">$class</span> = <span id="perlFunc">ref</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> || <span id="var">$self</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>UTR5<span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>UTR5<span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_biotype</span> <span id="perlKey">eq</span> <span id="sqStr">'coding'</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">create_utr5</span><span id="braces">(</span><span id="braces">)</span>;
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>UTR5<span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$class</span>-&gt;<span id="method">database_access</span> <span id="perlKey">eq</span> <span id="sqStr">'ALLOW'</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">set_utr5</span><span id="braces">(</span><span id="module"><a href="Transcript/UTR5.html">MyBio::Transcript::UTR5</a></span>-&gt;<span id="method">create_new_UTR5_from_database</span><span id="braces">(</span><span id="var">$self</span><span id="braces">)</span><span id="braces">)</span>;
		<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>UTR5<span id="braces">}</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> <span id="perlFunc">undef</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE35" id="CODE35"></a>is_coding</td><td >description</td><td ><a href="#CODE34">prev</a></td><td ><a href="#CODE36">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">is_coding</span>
{<pre>	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$_</span><span id="braces">[</span>0<span id="braces">]</span>-&gt;<span id="method">get_biotype</span> <span id="perlKey">eq</span> <span id="sqStr">'coding'</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE36" id="CODE36"></a>read_region_info_for_transcripts</td><td >description</td><td ><a href="#CODE35">prev</a></td><td ><a href="#CODE37">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">read_region_info_for_transcripts</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"FILE"</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$filename</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>;
			<span id="perlKey">return</span> <span id="var">$class</span>-&gt;<span id="method">_read_file_with_region_info_for_transcripts</span><span id="braces">(</span><span id="var">$filename</span><span id="braces">)</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE37" id="CODE37"></a>read_transcript_internal_IDs</td><td >description</td><td ><a href="#CODE36">prev</a></td><td ><a href="#CODE38">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">read_transcript_internal_IDs</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"FILE"</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$filename</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>;
			<span id="perlKey">return</span> <span id="var">$class</span>-&gt;<span id="method">_read_transcript_internal_IDs_from_file</span><span id="braces">(</span><span id="var">$filename</span><span id="braces">)</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE38" id="CODE38"></a>read_transcripts</td><td >description</td><td ><a href="#CODE37">prev</a></td><td ><a href="#CODE39">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">read_transcripts</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"FILE"</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$filename</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>;
			<span id="perlKey">return</span> <span id="var">$class</span>-&gt;<span id="method">_read_file_with_transcripts</span><span id="braces">(</span><span id="var">$filename</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"GTF"</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$filename</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>;
			<span id="perlKey">return</span> <span id="var">$class</span>-&gt;<span id="method">_read_gtf_with_transcripts</span><span id="braces">(</span><span id="var">$filename</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"EXON_INFO_FILE"</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$filename</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>;
			<span id="perlKey">return</span> <span id="var">$class</span>-&gt;<span id="method">_read_exon_info_file</span><span id="braces">(</span><span id="var">$filename</span><span id="braces">)</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE39" id="CODE39"></a>set_biotype</td><td >description</td><td ><a href="#CODE38">prev</a></td><td ><a href="#CODE40">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_biotype</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>BIOTYPE<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE40" id="CODE40"></a>set_cdna</td><td >description</td><td ><a href="#CODE39">prev</a></td><td ><a href="#CODE41">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_cdna</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>CDNA<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE41" id="CODE41"></a>set_cds</td><td >description</td><td ><a href="#CODE40">prev</a></td><td ><a href="#CODE42">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_cds</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>CDS<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE42" id="CODE42"></a>set_coding_start</td><td >description</td><td ><a href="#CODE41">prev</a></td><td ><a href="#CODE43">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_coding_start</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>CODING_START<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="var">$self</span>-&gt;<span id="method">set_biotype</span><span id="braces">(</span><span id="sqStr">'coding'</span><span id="braces">)</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE43" id="CODE43"></a>set_coding_stop</td><td >description</td><td ><a href="#CODE42">prev</a></td><td ><a href="#CODE44">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_coding_stop</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>CODING_STOP<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="var">$self</span>-&gt;<span id="method">set_biotype</span><span id="braces">(</span><span id="sqStr">'coding'</span><span id="braces">)</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE44" id="CODE44"></a>set_enstid</td><td >description</td><td ><a href="#CODE43">prev</a></td><td ><a href="#CODE45">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_enstid</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$value</span> =~ <span id="regExp">s/&gt;//</span>;
		<span id="var">$self</span>-&gt;<span id="braces">{</span>ENSTID<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE45" id="CODE45"></a>set_gene</td><td >description</td><td ><a href="#CODE44">prev</a></td><td ><a href="#CODE46">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_gene</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>GENE<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="method">weaken</span><span id="braces">(</span><span id="var">$self</span>-&gt;<span id="braces">{</span>GENE<span id="braces">}</span><span id="braces">)</span>; <span id="comment"># circular reference needs to be weakened to avoid memory leaks</span><br />		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE46" id="CODE46"></a>set_internalGID</td><td >description</td><td ><a href="#CODE45">prev</a></td><td ><a href="#CODE47">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_internalGID</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>INTERNAL_GID<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE47" id="CODE47"></a>set_internalID</td><td >description</td><td ><a href="#CODE46">prev</a></td><td ><a href="#CODE48">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_internalID</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>INTERNAL_ID<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE48" id="CODE48"></a>set_sequences_from_genome</td><td >description</td><td ><a href="#CODE47">prev</a></td><td ><a href="#CODE49">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_sequences_from_genome</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">my</span> <span id="var">$chr_folder</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'CHR_FOLDER'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'CHR_FOLDER'</span><span id="braces">}</span> : <span id="perlFunc">die</span> <span id="dqStr">"Chromosome folder must be provided"</span>;
		
		<span id="perlKey">my</span> <span id="var">%in_chromosomes</span>;
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcipt</span> <span id="braces">(</span><span id="perlFunc">values</span> <span id="var">%allTranscripts</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span> @<span id="braces">{</span><span id="var">$in_chromosomes</span><span id="braces">{</span><span id="var">$transcipt</span>-&gt;<span id="method">get_chr</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$transcipt</span>;
		<span id="braces">}</span>
		
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> <span id="var">%in_chromosomes</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$chr_file</span> = <span id="var">$chr_folder</span>.<span id="dqStr">"/chr<span id="var">$chr</span>.fa"</span>;
			<span id="perlKey">unless</span> <span id="braces">(</span>-e <span id="var">$chr_file</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">warn</span> <span id="dqStr">"Skipping chromosome. File <span id="var">$chr_file</span> does not exist"</span>;
				<span id="perlKey">next</span>;
			<span id="braces">}</span>
			<span id="perlKey">my</span> <span id="var">$chr_seq</span> = <span id="module"><a href="MySub.html">MyBio::MySub</a></span>::<span id="method">read_fasta</span><span id="braces">(</span><span id="var">$chr_file</span>,<span id="dqStr">"chr<span id="var">$chr</span>"</span><span id="braces">)</span>;
			
			<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$chr_seq</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">die</span> <span id="dqStr">"No Chromosome Sequence chr$chr\n"</span>;
			<span id="braces">}</span>
			
			<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$transcript</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$in_chromosomes</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$seq</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$chr_seq</span>,<span id="var">$transcript</span>-&gt;<span id="method">get_start</span>,<span id="var">$transcript</span>-&gt;<span id="method">get_length</span><span id="braces">)</span>;
				<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$transcript</span>-&gt;<span id="method">get_strand</span> == -1<span id="braces">)</span> <span id="braces">{</span>
					<span id="var">$seq</span> = <span id="perlFunc">reverse</span><span id="braces">(</span><span id="var">$seq</span><span id="braces">)</span>;
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$seq</span> =~ <span id="regExp">/U/i</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="var">$seq</span> =~ <span id="regExp">tr/ATGCUatgcu/UACGAuacga/</span>;
					<span id="braces">}</span>
					<span id="perlKey">else</span> <span id="braces">{</span>
						<span id="var">$seq</span> =~ <span id="regExp">tr/ATGCUatgcu/TACGAtacga/</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
				<span id="var">$transcript</span>-&gt;<span id="method">set_sequence</span><span id="braces">(</span><span id="var">$seq</span><span id="braces">)</span>;
			<span id="braces">}</span>
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE49" id="CODE49"></a>set_utr3</td><td >description</td><td ><a href="#CODE48">prev</a></td><td ><a href="#CODE50">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_utr3</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>UTR3<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE50" id="CODE50"></a>set_utr5</td><td >description</td><td ><a href="#CODE49">prev</a></td><td ><a href="#CODE51">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_utr5</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$value</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="braces">{</span>UTR5<span id="braces">}</span> = <span id="var">$value</span>;
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE51" id="CODE51"></a>update_transcripts_with_accessibility</td><td >description</td><td ><a href="#CODE50">prev</a></td><td >next</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">update_transcripts_with_accessibility</span>
{<pre>		<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$class</span>,<span id="var">$method</span>,<span id="var">@attributes</span><span id="braces">)</span> = <span id="var">@_</span>;
		
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="dqStr">"FILE"</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$filename</span> = <span id="var">$attributes</span><span id="braces">[</span>0<span id="braces">]</span>;
			<span id="var">$class</span>-&gt;<span id="method">_read_accessibility_from_fasta_file_and_update_transcript_objects</span><span id="braces">(</span><span id="var">$filename</span><span id="braces">)</span>;
		<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<a name="General" id="General"></a>
<div id="mainTitle">General documentation</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_EXAMPLES" id="_pod_EXAMPLES"></a>EXAMPLES</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"><pre id="podParagraph">    my %transcripts = <B>MyBio::Transcript</B>->read_region_info_for_transcripts('FILE',"$database/Ensembl_release_54/CDS_and_3UTR_sequences_CLEAN.txt");</pre></div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_AUTHOR - Manolis Maragkakis, Panagiotis Alexiou" id="_pod_AUTHOR - Manolis Maragkakis, Panagiotis Alexiou"></a>AUTHOR - Manolis Maragkakis, Panagiotis Alexiou</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea">Email <a href="mailto:em.maragkakis@gmail.com" id="podEmail">em.maragkakis@gmail.com</a>, <a href="mailto:pan.alexiou@fleming.gr" id="podEmail">pan.alexiou@fleming.gr</a></div>
<div id="sep"></div>
</body>
</html>
