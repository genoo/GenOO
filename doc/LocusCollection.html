<head>
<!-- Generated by perlmod2www.pl -->
<title>
LocusCollection documentation.
</title>
<link rel="stylesheet" type="text/css" href="perl.css">
</head>
<body bgcolor="white">
<span id="modRootPath">GenOO</span>
<span id="modName">LocusCollection</span>
<div id="sep"></div>
<a name="TOP" id="TOP"></a>
<table id="daArea" width="100%"><tr><td id="daEntry" ><a href="#SUMMARY">Summary</a></td><td id="daEntry" ><a href="#libs">Included libraries</a></td><td id="daEntry" ><a href="#vardefs">Package variables</a></td><td id="daEntry" ><a href="#SYNOPSIS">Synopsis</a></td><td id="daEntry" ><a href="#DESCRIPTION">Description</a></td><td id="daEntry" ><a href="#General">General documentation</a></td><td id="daEntry" ><a href="#Methods">Methods</a></td></tr></table>
<div id="sep"></div>
<div id="descTitle">Summary</div>
<div id="descArea"><B>GenOO::LocusCollection</B> - Object for a collection of GenOO::Locus objects, with features</div>
<div id="sep"></div>
<a name="vardefs" id="vardefs"></a><div id="descTitle">Package variables</div>
<div id="descArea"><div id="libEntry">No package variables defined.</div>
</div>
<div id="sep"></div>
<div id="descTitle">Included modules</div>
<div id="descArea"><div id="libEntry"><span id="use"><a href="Locus.html">GenOO::Locus</a></span> </div>
<div id="libEntry"><span id="use"><a href="LocusCollection/Stats.html">GenOO::LocusCollection::Stats</a></span> </div>
<div id="libEntry"><span id="use"><a href="MySub.html">GenOO::MySub</a></span> </div>
</div>
<div id="sep"></div>
<a name="libs" id="libs"></a>
<div id="descTitle">Inherit</div>
<div id="descArea"><span id="isa"><a href="_Initializable.html">GenOO::_Initializable</a></span> </div>
<div id="sep"></div>
<a name="SYNOPSIS" id="SYNOPSIS"></a>
<div id="descTitle">Synopsis</div>
<div id="descArea"><pre id="podParagraph">    # Object that manages a collection of GenOO::Locus objects. 

    # To initialize 
    my $locus_collection = <B>GenOO::LocusCollection</B>->new({
        NAME            => undef,
        SPECIES         => undef,
        DESCRIPTION     => undef,
        ENTRIES         => undef,
        EXTRA_INFO      => undef,
    });</pre>
</div>
<div id="sep"></div>
<a name="DESCRIPTION" id="DESCRIPTION"></a>
<div id="descTitle">Description</div>
<div id="descArea"><pre id="podParagraph">    The primary data structure of this object is a 2D hash whose primary key is the strand 
    and its secondary key is the chromosome name. Each such pair of keys correspond to an
    array reference which stores objects of the class <a href="Locus.html" target="urlWin" id="podUrl"><b>GenOO::Locus</b></a> sorted by start position.</pre>
</div>
<div id="sep"></div>
<a name="Methods" id="Methods"></a>
<div id="descTitle">Methods</div>
<table id="methIndArea" width="100%" cellspacing="0"><tr><td id="methIndEntry">_init</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE1">Code</a></td></tr>
<tr><td id="methIndEntry">add_entry</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE2">Code</a></td></tr>
<tr><td id="methIndEntry">annotate_entries_contained_in_collection</td><td id="methIndEntry"><a href="#POD1">Description</a></td><td id="methIndEntry"><a href="#CODE3">Code</a></td></tr>
<tr><td id="methIndEntry">annotate_entries_overlapping_with_collection</td><td id="methIndEntry"><a href="#POD2">Description</a></td><td id="methIndEntry"><a href="#CODE4">Code</a></td></tr>
<tr><td id="methIndEntry">chromosomes_for_all_strands</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE5">Code</a></td></tr>
<tr><td id="methIndEntry">chromosomes_for_strand</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE6">Code</a></td></tr>
<tr><td id="methIndEntry">collapse</td><td id="methIndEntry"><a href="#POD3">Description</a></td><td id="methIndEntry"><a href="#CODE7">Code</a></td></tr>
<tr><td id="methIndEntry">compare_value_to_the_two_others</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE8">Code</a></td></tr>
<tr><td id="methIndEntry">entries</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE9">Code</a></td></tr>
<tr><td id="methIndEntry">entries_count</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE10">Code</a></td></tr>
<tr><td id="methIndEntry">entries_iterator</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE11">Code</a></td></tr>
<tr><td id="methIndEntry">find_closest_entry_index_to_position</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE12">Code</a></td></tr>
<tr><td id="methIndEntry">get_description</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE13">Code</a></td></tr>
<tr><td id="methIndEntry">get_name</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE14">Code</a></td></tr>
<tr><td id="methIndEntry">get_species</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE15">Code</a></td></tr>
<tr><td id="methIndEntry">increment_entries_count</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE16">Code</a></td></tr>
<tr><td id="methIndEntry">init</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE17">Code</a></td></tr>
<tr><td id="methIndEntry">init_entries</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE18">Code</a></td></tr>
<tr><td id="methIndEntry">init_stats</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE19">Code</a></td></tr>
<tr><td id="methIndEntry">is_empty</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE20">Code</a></td></tr>
<tr><td id="methIndEntry">is_not_empty</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE21">Code</a></td></tr>
<tr><td id="methIndEntry">length_for_longest_entry</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE22">Code</a></td></tr>
<tr><td id="methIndEntry">merge</td><td id="methIndEntry"><a href="#POD4">Description</a></td><td id="methIndEntry"><a href="#CODE23">Code</a></td></tr>
<tr><td id="methIndEntry">merge_entries_in_array</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE24">Code</a></td></tr>
<tr><td id="methIndEntry">merge_overlaping_entries</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE25">Code</a></td></tr>
<tr><td id="methIndEntry">print</td><td id="methIndEntry"><a href="#POD5">Description</a></td><td id="methIndEntry"><a href="#CODE26">Code</a></td></tr>
<tr><td id="methIndEntry">print_in_bed_format</td><td id="methIndEntry"><a href="#POD6">Description</a></td><td id="methIndEntry"><a href="#CODE27">Code</a></td></tr>
<tr><td id="methIndEntry">print_in_fasta_format</td><td id="methIndEntry"><a href="#POD7">Description</a></td><td id="methIndEntry"><a href="#CODE28">Code</a></td></tr>
<tr><td id="methIndEntry">print_in_wiggle_format</td><td id="methIndEntry"><a href="#POD8">Description</a></td><td id="methIndEntry"><a href="#CODE29">Code</a></td></tr>
<tr><td id="methIndEntry">reset_stats</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE30">Code</a></td></tr>
<tr><td id="methIndEntry">set_description</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE31">Code</a></td></tr>
<tr><td id="methIndEntry">set_name</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE32">Code</a></td></tr>
<tr><td id="methIndEntry">set_sequence_for_all_entries</td><td id="methIndEntry"><a href="#POD9">Description</a></td><td id="methIndEntry"><a href="#CODE33">Code</a></td></tr>
<tr><td id="methIndEntry">set_species</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE34">Code</a></td></tr>
<tr><td id="methIndEntry">sort_entries</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE35">Code</a></td></tr>
<tr><td id="methIndEntry">stats</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE36">Code</a></td></tr>
<tr><td id="methIndEntry">strands</td><td id="methIndEntry"><div id="error">No description</div></td><td id="methIndEntry"><a href="#CODE37">Code</a></td></tr>
</table>
<div id="sep"></div>
<a name="MethDesc" id="MethDesc"></a>
<div id="mainTitle">Methods description</div>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_annotate_entries_contained_in_collection" id="_pod_annotate_entries_contained_in_collection"></a><a name="POD1" id="POD1"></a>annotate_entries_contained_in_collection</td><td ><a href="#CODE3">code</a></td><td >&nbsp;&nbsp;&nbsp;&nbsp;</td><td ><a href="#POD2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : GenOO::LocusCollection. A locus collection against which $self is compared.
  Example    : $locus_collection->annotate_entries_contained_in_collection($locus_collection2)
  Description: Sets for all entries in the $self locus collection the overlap attribute.
               This attribute indicates whether the entry overlaps with any of the entries on the reference locus collection.
               A entry is said to overlap with another entry if it is contained within (both start and end position) the other entry.
  Returntype : NULL
  Caller     : ?
  Status     : Experimental / Unstable</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_annotate_entries_overlapping_with_collection" id="_pod_annotate_entries_overlapping_with_collection"></a><a name="POD2" id="POD2"></a>annotate_entries_overlapping_with_collection</td><td ><a href="#CODE4">code</a></td><td ><a href="#POD1">prev</a></td><td ><a href="#POD3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : GenOO::LocusCollection. A locus collection against which $self is compared. 
  Arg [2]    : hash reference. Defines parameters for the overlap.
  Example    : $locus_collection->annotate_entries_overlapping_with_collection($locus_collection2, {OFFSET  => 0})
  Description: Sets the overlap attribute for entries. This indicates if the entry overlaps with any entry on the reference locus collection.
               A entry is said to overlap with another entry if it is located within OFFSET distance from the other entry.
  Returntype : NULL</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_collapse" id="_pod_collapse"></a><a name="POD3" id="POD3"></a>collapse</td><td ><a href="#CODE7">code</a></td><td ><a href="#POD2">prev</a></td><td ><a href="#POD4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Example    : $locus_collection->collapse
  Description: Entries with the same start and stop positions are collapsed into a single entry.</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_merge" id="_pod_merge"></a><a name="POD4" id="POD4"></a>merge</td><td ><a href="#CODE23">code</a></td><td ><a href="#POD3">prev</a></td><td ><a href="#POD5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1..]  : hash reference. Defines parameters for merging.
  Example    : $locus_collection->merge({OFFSET  => 0}) 
  Description: Merges loci which overlap or are closer than a given distance with each other (entries are replaced by merged ones)
  Returntype : NULL</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_print" id="_pod_print"></a><a name="POD5" id="POD5"></a>print</td><td ><a href="#CODE26">code</a></td><td ><a href="#POD4">prev</a></td><td ><a href="#POD6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : hash reference. Defines parameters for the output. The type of output (BED, FASTA, WIG) must be specified!
  Example    : $locus_collection->print({METHOD=>"BED"})
  Description: Prints all entries.
  Returntype : NULL</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_print_in_bed_format" id="_pod_print_in_bed_format"></a><a name="POD6" id="POD6"></a>print_in_bed_format</td><td ><a href="#CODE27">code</a></td><td ><a href="#POD5">prev</a></td><td ><a href="#POD7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : hash reference. Defines parameters for the output
               Required parameters are:
                  1/ OUTPUT: STDOUT or filename
  Example    : $locus_collection->print({OUTPUT => 'STDOUT'})      
  Description: Prints all entries in BED format.
  Returntype : NULL</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_print_in_fasta_format" id="_pod_print_in_fasta_format"></a><a name="POD7" id="POD7"></a>print_in_fasta_format</td><td ><a href="#CODE28">code</a></td><td ><a href="#POD6">prev</a></td><td ><a href="#POD8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : hash reference. Defines parameters for the output
               Required parameters are:
                  1/ OUTPUT: STDOUT or filename
                  2/ CHR_FOLDER: The folder containing the fasta files of the chromosomes
  Example    : $locus_collection->print({
                  OUTPUT           => "STDOUT",
                  CHR_FOLDER       => "/chromosomes/hg19/"
               })
  Description: Prints all entries in FASTA format.
  Returntype : NULL</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_print_in_wiggle_format" id="_pod_print_in_wiggle_format"></a><a name="POD8" id="POD8"></a>print_in_wiggle_format</td><td ><a href="#CODE29">code</a></td><td ><a href="#POD7">prev</a></td><td ><a href="#POD9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : hash reference. Defines parameters for the output
               Required parameters are:
                  1/ OUTPUT: STDOUT or filename
                  2/ WINDOW: The size in nucleotides of each bin in the WIG
                  3/ STEP: The distance in nucleotides between adjacent bins in the WIG file
  Example    : $locus_collection->print({
                  OUTPUT       => "STDOUT",
                  WINDOW       => 1000,
                  STEP         => 100,
               })
  Description: Prints all entries in WIG format.
  Returntype : NULL</pre></td></tr></table>
<div id="sep"></div>
<table id="methDescTitle" width="100%"><tr><td WIDTH="200"><a name="_pod_set_sequence_for_all_entries" id="_pod_set_sequence_for_all_entries"></a><a name="POD9" id="POD9"></a>set_sequence_for_all_entries</td><td ><a href="#CODE33">code</a></td><td ><a href="#POD8">prev</a></td><td ><a href="#POD10">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<table id="methDescArea" width="100%"><tr><td><pre id="podParagraph">  Arg [1]    : hash reference
               A hash reference containing the parameters for the output.
               Required parameters are:
                  1/ CHR_FOLDER: The folder containing the fasta files of the chromosomes
  Example    : set_sequence_for_all_entries({
                 CHR_FOLDER       => "/chromosomes/hg19/"
               })
  Description: Sets the SEQUENCE for all entries in the LocusCollection.
  Returntype : NULL
  Caller     : ?
  Status     : Stable</pre></td></tr></table>
<div id="sep"></div>
<a name="MethCode" id="MethCode"></a>
<div id="mainTitle">Methods code</div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE1" id="CODE1"></a>_init</td><td >description</td><td >prev</td><td ><a href="#CODE2">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="privSubName">_init</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$data</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="var">$self</span>-&gt;<span id="method">set_name</span><span id="braces">(</span>$$data<span id="braces">{</span>NAME<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_species</span><span id="braces">(</span>$$data<span id="braces">{</span>SPECIES<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_description</span><span id="braces">(</span>$$data<span id="braces">{</span>DESCRIPTION<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">set_extra</span><span id="braces">(</span>$$data<span id="braces">{</span>EXTRA_INFO<span id="braces">}</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">init</span>;
	
	<span id="perlKey">return</span> <span id="var">$self</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE2" id="CODE2"></a>add_entry</td><td >description</td><td ><a href="#CODE1">prev</a></td><td ><a href="#CODE3">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">add_entry</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$entry</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlFunc">push</span> @<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">entries</span>-&gt;<span id="braces">{</span><span id="var">$entry</span>-&gt;<span id="method">get_strand</span><span id="braces">}</span>-&gt;<span id="braces">{</span><span id="var">$entry</span>-&gt;<span id="method">get_chr</span><span id="braces">}</span><span id="braces">}</span>,<span id="var">$entry</span>;
	<span id="var">$self</span>-&gt;<span id="method">increment_entries_count</span><span id="braces">(</span><span id="braces">)</span>;
	<span id="var">$self</span>-&gt;<span id="method">stats</span>-&gt;<span id="perlFunc">reset</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE3" id="CODE3"></a>annotate_entries_contained_in_collection</td><td ><a href="#POD1">description</a></td><td ><a href="#CODE2">prev</a></td><td ><a href="#CODE4">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">annotate_entries_contained_in_collection</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$locus_collection2</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$entries_ref</span> = <span id="var">$self</span>-&gt;<span id="method">entries</span>;
	<span id="perlKey">my</span> <span id="var">$entries2_ref</span> = <span id="var">$locus_collection2</span>-&gt;<span id="method">entries</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$entries_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$entries2_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$entry</span> <span id="braces">(</span>@<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$entry2</span> <span id="braces">(</span>@<span id="braces">{</span>$$entries2_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$entry</span>-&gt;<span id="method">get_stop</span> &lt; <span id="var">$entry2</span>-&gt;<span id="method">get_start</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="perlKey">last</span>;
							<span id="braces">}</span>
							<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$entry2</span>-&gt;<span id="method">contains</span><span id="braces">(</span><span id="var">$entry</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="var">$entry</span>-&gt;<span id="method">set_overlap</span><span id="braces">(</span><span id="var">$locus_collection2</span>-&gt;<span id="method">get_id</span>,1<span id="braces">)</span>;
							<span id="braces">}</span>
						<span id="braces">}</span>
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE4" id="CODE4"></a>annotate_entries_overlapping_with_collection</td><td ><a href="#POD2">description</a></td><td ><a href="#CODE3">prev</a></td><td ><a href="#CODE5">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">annotate_entries_overlapping_with_collection</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$locus_collection2</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$offset</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OFFSET'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OFFSET'</span><span id="braces">}</span> : 0;
	
	<span id="perlKey">my</span> <span id="var">$entries_ref</span> = <span id="var">$self</span>-&gt;<span id="method">entries</span>;
	<span id="perlKey">my</span> <span id="var">$entries2_ref</span> = <span id="var">$locus_collection2</span>-&gt;<span id="method">entries</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$entries_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$entries2_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$entry</span> <span id="braces">(</span>@<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$entry2</span> <span id="braces">(</span>@<span id="braces">{</span>$$entries2_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$entry</span>-&gt;<span id="method">get_stop</span> &lt; <span id="var">$entry2</span>-&gt;<span id="method">get_start</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="perlKey">last</span>;
							<span id="braces">}</span>
							<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$entry2</span>-&gt;<span id="method">overlaps</span><span id="braces">(</span><span id="var">$entry</span>, <span id="var">$offset</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="var">$entry</span>-&gt;<span id="method">set_overlap</span><span id="braces">(</span><span id="var">$locus_collection2</span>-&gt;<span id="method">get_id</span>,1<span id="braces">)</span>;
								<span id="var">$entry2</span>-&gt;<span id="method">set_overlap</span><span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">get_id</span>,1<span id="braces">)</span>;
							<span id="braces">}</span>
						<span id="braces">}</span>
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE5" id="CODE5"></a>chromosomes_for_all_strands</td><td >description</td><td ><a href="#CODE4">prev</a></td><td ><a href="#CODE6">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">chromosomes_for_all_strands</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">%available_chrs</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">strands</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">chromosomes_for_strand</span><span id="braces">(</span><span id="var">$strand</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$available_chrs</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span> = 1;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="perlFunc">keys</span> <span id="var">%available_chrs</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE6" id="CODE6"></a>chromosomes_for_strand</td><td >description</td><td ><a href="#CODE5">prev</a></td><td ><a href="#CODE7">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">chromosomes_for_strand</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$strand</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">return</span> <span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">entries</span>-&gt;<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE7" id="CODE7"></a>collapse</td><td ><a href="#POD3">description</a></td><td ><a href="#CODE6">prev</a></td><td ><a href="#CODE8">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">collapse</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$entries_ref</span> = <span id="var">$self</span>-&gt;<span id="method">entries</span>;
	<span id="perlKey">my</span> <span id="var">%collapsed_hash</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$entries_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$collapsed_hash</span><span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span> = <span id="braces">[</span><span id="braces">]</span>;
				<span id="perlKey">my</span> <span id="var">%count</span>;
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$entry</span> <span id="braces">(</span>@<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="var">$start</span> = <span id="var">$entry</span>-&gt;<span id="method">get_start</span>;
					<span id="perlKey">my</span> <span id="var">$stop</span> = <span id="var">$entry</span>-&gt;<span id="method">get_stop</span>;
					<span id="var">$count</span><span id="braces">{</span><span id="dqStr">"<span id="var">$start</span>|<span id="var">$stop</span>"</span><span id="braces">}</span>++;
				<span id="braces">}</span>
				<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$pos</span> <span id="braces">(</span><span id="perlFunc">keys</span> <span id="var">%count</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$start</span>, <span id="var">$stop</span><span id="braces">)</span> = <span id="perlFunc">split</span><span id="braces">(</span><span id="regExp">/\|/</span>,<span id="var">$pos</span><span id="braces">)</span>;
					<span id="perlKey">my</span> <span id="var">$entryObj</span> = <span id="module"><a href="Locus.html">GenOO::Locus</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
						CHR           =&gt; <span id="var">$chr</span>,
						START         =&gt; <span id="var">$start</span>,
						STOP          =&gt; <span id="var">$stop</span>,
						STRAND        =&gt; <span id="var">$strand</span>,
						NAME          =&gt; <span id="var">$count</span><span id="braces">{</span><span id="var">$pos</span><span id="braces">}</span>,
					<span id="braces">}</span><span id="braces">)</span>;
					<span id="perlFunc">push</span> <span id="braces">(</span>@<span id="braces">{</span><span id="var">$collapsed_hash</span><span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span>, <span id="var">$entryObj</span><span id="braces">)</span>;
					
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="var">$self</span>-&gt;<span id="method">set_entries</span><span id="braces">(</span>\<span id="var">%collapsed_hash</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE8" id="CODE8"></a>compare_value_to_the_two_others</td><td >description</td><td ><a href="#CODE7">prev</a></td><td ><a href="#CODE9">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">compare_value_to_the_two_others</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$value</span>,<span id="var">$entries</span>,<span id="var">$index1</span>,<span id="var">$index2</span><span id="braces">)</span>=<span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$dif1</span>=<span id="perlFunc">abs</span><span id="braces">(</span><span id="var">$value</span>-<span id="braces">(</span>$$entries<span id="braces">[</span><span id="var">$index1</span><span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">$dif2</span>=<span id="perlFunc">abs</span><span id="braces">(</span><span id="var">$value</span>-<span id="braces">(</span>$$entries<span id="braces">[</span><span id="var">$index2</span><span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span><span id="braces">)</span>;
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$dif1</span> &lt;= <span id="var">$dif2</span><span id="braces">)</span> <span id="braces">{</span><span id="perlKey">return</span> <span id="var">$index1</span>;<span id="braces">}</span>
	<span id="perlKey">else</span>                <span id="braces">{</span><span id="perlKey">return</span> <span id="var">$index2</span>;<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE9" id="CODE9"></a>entries</td><td >description</td><td ><a href="#CODE8">prev</a></td><td ><a href="#CODE10">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">entries</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>ENTRIES<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE10" id="CODE10"></a>entries_count</td><td >description</td><td ><a href="#CODE9">prev</a></td><td ><a href="#CODE11">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">entries_count</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>ENTRY_COUNT<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE11" id="CODE11"></a>entries_iterator</td><td >description</td><td ><a href="#CODE10">prev</a></td><td ><a href="#CODE12">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">entries_iterator</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">return</span> <span id="module"><a href="LocusCollection/Iterator.html">GenOO::LocusCollection::Iterator</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
		DATA_STRUCTURE =&gt; <span id="var">$self</span>-&gt;<span id="method">entries</span>,
	<span id="braces">}</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE12" id="CODE12"></a>find_closest_entry_index_to_position</td><td >description</td><td ><a href="#CODE11">prev</a></td><td ><a href="#CODE13">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">find_closest_entry_index_to_position</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$target_value</span>,<span id="var">$entries</span>,<span id="var">$fromIndex</span>,<span id="var">$toIndex</span><span id="braces">)</span>=<span id="var">@_</span>; 
	<span id="comment">#target_value = the value we want to match</span><br />	<span id="comment">#entries = a reference to an array of entry objects. the index will match this array </span><br />	<span id="comment">#fromIndex - toIndex = range of indexes that will be used for the search</span><br />	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$toIndex</span> == -1<span id="braces">)</span><span id="braces">{</span><span id="perlKey">return</span> <span id="var">$fromIndex</span>;<span id="braces">}</span>
	<span id="perlKey">my</span> <span id="var">$closest_index</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$fromIndex</span> == <span id="var">$toIndex</span><span id="braces">)</span><span id="braces">{</span><span id="perlKey">return</span> <span id="var">$fromIndex</span>;<span id="braces">}</span>	
	
	<span id="perlKey">my</span> <span id="var">$scanIndex</span>=<span id="perlFunc">int</span><span id="braces">(</span><span id="var">$fromIndex</span>+<span id="braces">(</span><span id="var">$toIndex</span>-<span id="var">$fromIndex</span><span id="braces">)</span><span id="regExp">/2); #begin at half-way point<br /><br />	if (</span><span id="var">$toIndex</span><span id="regExp"> == </span><span id="var">$fromIndex</span><span id="regExp">+1){</span><span id="var">$closest_index</span><span id="regExp"> = </span><span id="var">$self</span><span id="regExp">-&gt;compare_value_to_the_two_others(</span><span id="var">$target_value</span><span id="regExp">,</span><span id="var">$entries</span><span id="regExp">,(</span><span id="var">$scanIndex</span><span id="regExp">+1),</span><span id="var">$scanIndex</span><span id="regExp">);} #end<br />	elsif (</span><span id="var">$target_value</span> == $$entries[$scanIndex]-&gt;get_start()) {$closest_index = $scanIndex;} #end - found exact value<br />	elsif ($target_value &lt;  $$entries[$scanIndex]-&gt;get_start()) {<br />		if   ($target_value &gt;=  $$entries[$scanIndex-1]-&gt;get_start()) {<br />		<br />			$closest_index = $self-&gt;compare_value_to_the_two_others($target_value,$entries,$scanIndex,($scanIndex-1));<br />		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="var">$closest_index</span> = <span id="var">$self</span>-&gt;<span id="method">find_closest_entry_index_to_position</span><span id="braces">(</span><span id="var">$target_value</span>,<span id="var">$entries</span>,<span id="var">$fromIndex</span>,<span id="var">$scanIndex</span><span id="braces">)</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$target_value</span> &gt;  $$entries<span id="braces">[</span><span id="var">$scanIndex</span><span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span>   <span id="braces">(</span><span id="var">$target_value</span> &lt;=  $$entries<span id="braces">[</span><span id="var">$scanIndex</span>+1<span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		
			<span id="var">$closest_index</span> = <span id="var">$self</span>-&gt;<span id="method">compare_value_to_the_two_others</span><span id="braces">(</span><span id="var">$target_value</span>,<span id="var">$entries</span>,<span id="braces">(</span><span id="var">$scanIndex</span>+1<span id="braces">)</span>,<span id="var">$scanIndex</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="var">$closest_index</span> = <span id="var">$self</span>-&gt;<span id="method">find_closest_entry_index_to_position</span><span id="braces">(</span><span id="var">$target_value</span>,<span id="var">$entries</span>,<span id="var">$scanIndex</span>,<span id="var">$toIndex</span><span id="braces">)</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> <span id="var">$closest_index</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE13" id="CODE13"></a>get_description</td><td >description</td><td ><a href="#CODE12">prev</a></td><td ><a href="#CODE14">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_description</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>DESCRIPTION<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE14" id="CODE14"></a>get_name</td><td >description</td><td ><a href="#CODE13">prev</a></td><td ><a href="#CODE15">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_name</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>NAME<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE15" id="CODE15"></a>get_species</td><td >description</td><td ><a href="#CODE14">prev</a></td><td ><a href="#CODE16">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">get_species</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>SPECIES<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE16" id="CODE16"></a>increment_entries_count</td><td >description</td><td ><a href="#CODE15">prev</a></td><td ><a href="#CODE17">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">increment_entries_count</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="var">$self</span>-&gt;<span id="braces">{</span>ENTRY_COUNT<span id="braces">}</span>++;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE17" id="CODE17"></a>init</td><td >description</td><td ><a href="#CODE16">prev</a></td><td ><a href="#CODE18">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">init</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="var">$self</span>-&gt;<span id="method">init_stats</span>;
	<span id="var">$self</span>-&gt;<span id="method">init_entries</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE18" id="CODE18"></a>init_entries</td><td >description</td><td ><a href="#CODE17">prev</a></td><td ><a href="#CODE19">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">init_entries</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="var">$self</span>-&gt;<span id="braces">{</span>ENTRIES<span id="braces">}</span> = <span id="braces">{</span><span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE19" id="CODE19"></a>init_stats</td><td >description</td><td ><a href="#CODE18">prev</a></td><td ><a href="#CODE20">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">init_stats</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="var">$self</span>-&gt;<span id="braces">{</span>STATS<span id="braces">}</span> = <span id="module"><a href="LocusCollection/Stats.html">GenOO::LocusCollection::Stats</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
		COLLECTION =&gt; <span id="var">$self</span>
	<span id="braces">}</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE20" id="CODE20"></a>is_empty</td><td >description</td><td ><a href="#CODE19">prev</a></td><td ><a href="#CODE21">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">is_empty</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">entries_count</span> == 0<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE21" id="CODE21"></a>is_not_empty</td><td >description</td><td ><a href="#CODE20">prev</a></td><td ><a href="#CODE22">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">is_not_empty</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">entries_count</span> &gt; 0<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 1;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlKey">return</span> 0;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE22" id="CODE22"></a>length_for_longest_entry</td><td >description</td><td ><a href="#CODE21">prev</a></td><td ><a href="#CODE23">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">length_for_longest_entry</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="method">stats</span>-&gt;<span id="method">get_or_find_length_for_longest_entry</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE23" id="CODE23"></a>merge</td><td ><a href="#POD4">description</a></td><td ><a href="#CODE22">prev</a></td><td ><a href="#CODE24">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">merge</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$entries_ref</span> = <span id="var">$self</span>-&gt;<span id="method">entries</span>;
	<span id="perlKey">my</span> <span id="var">%merged_hash</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$entries_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="var">$merged_hash</span><span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span> = <span id="braces">[</span><span id="braces">]</span>;
				@<span id="braces">{</span><span id="var">$merged_hash</span><span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span> = <span id="var">$self</span>-&gt;<span id="method">merge_entries_in_array</span><span id="braces">(</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span>,<span id="var">$params</span><span id="braces">)</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="var">$self</span>-&gt;<span id="method">set_entries</span><span id="braces">(</span>\<span id="var">%merged_hash</span><span id="braces">)</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE24" id="CODE24"></a>merge_entries_in_array</td><td >description</td><td ><a href="#CODE23">prev</a></td><td ><a href="#CODE25">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">merge_entries_in_array</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$entries_array_ref</span>,<span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$offset</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OFFSET'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OFFSET'</span><span id="braces">}</span> : 0;
	
	<span id="perlKey">my</span> <span id="var">@out</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">@temp</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">$region_of_overlap</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$entry</span> <span id="braces">(</span>@$entries_array_ref<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span>!<span id="perlFunc">defined</span> <span id="var">$region_of_overlap</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$region_of_overlap</span> = <span id="var">$entry</span>-&gt;<span id="method">clone</span><span id="braces">(</span><span id="braces">)</span>; 
			<span id="perlFunc">push</span><span id="braces">(</span><span id="var">@temp</span>, <span id="var">$entry</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$region_of_overlap</span>-&gt;<span id="method">overlaps</span><span id="braces">(</span><span id="var">$entry</span>,<span id="var">$offset</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">push</span><span id="braces">(</span><span id="var">@temp</span>, <span id="var">$entry</span><span id="braces">)</span>;
			<span id="perlKey">my</span> <span id="var">$start</span> = <span id="var">$region_of_overlap</span>-&gt;<span id="method">get_start</span> &lt; <span id="var">$entry</span>-&gt;<span id="method">get_start</span> ? <span id="var">$region_of_overlap</span>-&gt;<span id="method">get_start</span> : <span id="var">$entry</span>-&gt;<span id="method">get_start</span>;
			<span id="perlKey">my</span> <span id="var">$stop</span> = <span id="var">$region_of_overlap</span>-&gt;<span id="method">get_stop</span> &gt; <span id="var">$entry</span>-&gt;<span id="method">get_stop</span> ? <span id="var">$region_of_overlap</span>-&gt;<span id="method">get_stop</span> : <span id="var">$entry</span>-&gt;<span id="method">get_stop</span>;
			<span id="var">$region_of_overlap</span>-&gt;<span id="method">set_start</span><span id="braces">(</span><span id="var">$start</span><span id="braces">)</span>;
			<span id="var">$region_of_overlap</span>-&gt;<span id="method">set_stop</span><span id="braces">(</span><span id="var">$stop</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="var">$region_of_overlap</span> = <span id="var">$entry</span>-&gt;<span id="method">clone</span><span id="braces">(</span><span id="braces">)</span>;
			<span id="perlKey">if</span> <span id="braces">(</span>$#temp == 0<span id="braces">)</span> <span id="braces">{</span>
				<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@out</span>, <span id="var">$temp</span><span id="braces">[</span>0<span id="braces">]</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="perlKey">else</span> <span id="braces">{</span>
				<span id="perlFunc">push</span><span id="braces">(</span><span id="var">@out</span>,<span id="var">$self</span>-&gt;<span id="method">merge_overlaping_entries</span><span id="braces">(</span>\<span id="var">@temp</span><span id="braces">)</span><span id="braces">)</span>;
			<span id="braces">}</span>
			<span id="var">@temp</span> = <span id="braces">(</span><span id="braces">)</span>;
			<span id="perlFunc">push</span><span id="braces">(</span><span id="var">@temp</span>, <span id="var">$entry</span><span id="braces">)</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	
	<span id="perlKey">if</span> <span id="braces">(</span>$#temp == 0<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@out</span>, <span id="var">$temp</span><span id="braces">[</span>0<span id="braces">]</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlFunc">push</span><span id="braces">(</span><span id="var">@out</span>,<span id="var">$self</span>-&gt;<span id="method">merge_overlaping_entries</span><span id="braces">(</span>\<span id="var">@temp</span><span id="braces">)</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="var">@temp</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">return</span> <span id="var">@out</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE25" id="CODE25"></a>merge_overlaping_entries</td><td >description</td><td ><a href="#CODE24">prev</a></td><td ><a href="#CODE26">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">merge_overlaping_entries</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>,<span id="var">$temp</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">@entryobjects</span> = <span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$a</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span> &lt;=&gt; <span id="var">$b</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">}</span> @<span id="braces">{</span><span id="var">$temp</span><span id="braces">}</span>;
	
	<span id="perlKey">my</span> <span id="var">@out</span> = <span id="braces">(</span><span id="braces">)</span>;
	<span id="perlKey">my</span> <span id="var">$newentry</span> = <span id="var">$entryobjects</span><span id="braces">[</span>0<span id="braces">]</span>;
	<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span> = 1; <span id="var">$i</span> &lt; <span id="var">@entryobjects</span>; <span id="var">$i</span>++<span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$entryobjects</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span> &lt; <span id="var">$newentry</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$newentry</span>-&gt;<span id="method">set_start</span><span id="braces">(</span><span id="var">$entryobjects</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$entryobjects</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span> &gt; <span id="var">$newentry</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="var">$newentry</span>-&gt;<span id="method">set_stop</span><span id="braces">(</span><span id="var">$entryobjects</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span><span id="braces">)</span>;
		<span id="braces">}</span>
		<span id="var">$newentry</span>-&gt;<span id="method">set_name</span><span id="braces">(</span><span id="sqStr">''</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlFunc">push</span> <span id="braces">(</span><span id="var">@out</span>,<span id="var">$newentry</span><span id="braces">)</span>;
	<span id="perlKey">return</span> <span id="var">@out</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE26" id="CODE26"></a>print</td><td ><a href="#POD5">description</a></td><td ><a href="#CODE25">prev</a></td><td ><a href="#CODE27">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$method</span> = <span id="perlFunc">delete</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'METHOD'</span><span id="braces">}</span>;
	
	<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="sqStr">'BED'</span><span id="braces">)</span><span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">print_in_bed_format</span><span id="braces">(</span><span id="var">$params</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="sqStr">'FASTA'</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">print_in_fasta_format</span><span id="braces">(</span><span id="var">$params</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$method</span> <span id="perlKey">eq</span> <span id="sqStr">'WIG'</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="var">$self</span>-&gt;<span id="method">print_in_wiggle_format</span><span id="braces">(</span><span id="var">$params</span><span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlFunc">die</span> <span id="dqStr">"Unknown or no method specified in "</span>.<span id="braces">(</span><span id="perlFunc">caller</span><span id="braces">(</span>0<span id="braces">)</span><span id="braces">)</span><span id="braces">[</span>3<span id="braces">]</span>.<span id="dqStr">". Use one of BED, WIG, or FASTA)"</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE27" id="CODE27"></a>print_in_bed_format</td><td ><a href="#POD6">description</a></td><td ><a href="#CODE26">prev</a></td><td ><a href="#CODE28">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print_in_bed_format</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$OUT</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="braces">(</span>!<span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span> <span id="perlKey">eq</span> <span id="dqStr">"STDOUT"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;&amp;="</span>,STDOUT<span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlFunc">open</span><span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;"</span>,<span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span> or <span id="perlFunc">die</span> <span id="dqStr">"Cannot open file "</span>.<span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span>.<span id="dqStr">". $!"</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">my</span> <span id="var">$iterator</span> = <span id="var">$self</span>-&gt;<span id="method">entries_iterator</span>;
	<span id="perlKey">while</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$entry</span> = <span id="var">$iterator</span>-&gt;<span id="perlKey">next</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">print</span> <span id="var">$OUT</span> <span id="var">$entry</span>-&gt;<span id="method">to_string</span><span id="braces">(</span><span id="dqStr">"BED"</span><span id="braces">)</span>.<span id="dqStr">"\n"</span>;
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE28" id="CODE28"></a>print_in_fasta_format</td><td ><a href="#POD7">description</a></td><td ><a href="#CODE27">prev</a></td><td ><a href="#CODE29">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print_in_fasta_format</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$chr_folder</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'CHR_FOLDER'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'CHR_FOLDER'</span><span id="braces">}</span> : <span id="perlFunc">die</span> <span id="dqStr">"The method FASTA is requested in\&quot; print\&quot; but the folder with chromosome sequences is not provided"</span>;
	<span id="perlKey">my</span> <span id="var">$upflank</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'UP_FLANK'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'UP_FLANK'</span><span id="braces">}</span> : 0;
	<span id="perlKey">my</span> <span id="var">$downflank</span> = <span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'DOWN_FLANK'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'DOWN_FLANK'</span><span id="braces">}</span> : 0;
	<span id="perlKey">my</span> <span id="var">$maxflank</span> = <span id="var">$upflank</span> &gt; <span id="var">$downflank</span> ? <span id="var">$upflank</span> : <span id="var">$downflank</span>;
	
	<span id="perlKey">my</span> <span id="var">$OUT</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="braces">(</span>!<span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span> <span id="perlKey">eq</span> <span id="dqStr">"STDOUT"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;&amp;="</span>,STDOUT<span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlFunc">open</span><span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;"</span>,<span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">my</span> <span id="var">$entries_ref</span> = <span id="var">$self</span>-&gt;<span id="method">entries</span>;
	<span id="perlKey">my</span> <span id="var">@chromosomes_for_all_strands</span> = <span id="var">$self</span>-&gt;<span id="method">chromosomes_for_all_strands</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="var">@chromosomes_for_all_strands</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$chr_file</span> = <span id="var">$chr_folder</span>.<span id="dqStr">"/<span id="var">$chr</span>.fa"</span>;
		<span id="perlKey">unless</span> <span id="braces">(</span>-e <span id="var">$chr_file</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlFunc">warn</span> <span id="dqStr">"Skipping chromosome. File <span id="var">$chr_file</span> does not exist"</span>;
			<span id="perlKey">next</span>;
		<span id="braces">}</span>
		<span id="perlKey">my</span> <span id="var">$chr_seq</span> = <span id="perlFunc">join</span><span id="braces">(</span><span id="sqStr">''</span>,<span id="perlFunc">map</span><span id="braces">{</span><span id="sqStr">'N'</span><span id="braces">}</span> <span id="braces">(</span>1..<span id="var">$maxflank</span><span id="braces">)</span><span id="braces">)</span>.<span id="module"><a href="MySub.html">GenOO::MySub</a></span>::<span id="method">read_fasta</span><span id="braces">(</span><span id="var">$chr_file</span>,<span id="dqStr">"<span id="var">$chr</span>"</span><span id="braces">)</span>.<span id="perlFunc">join</span><span id="braces">(</span><span id="sqStr">''</span>,<span id="perlFunc">map</span><span id="braces">{</span><span id="sqStr">'N'</span><span id="braces">}</span> <span id="braces">(</span>1..<span id="var">$maxflank</span><span id="braces">)</span><span id="braces">)</span>;
		
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="var">$self</span>-&gt;<span id="method">strands</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$entries_array_ref</span> = $$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span>;
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$entries_array_ref</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="comment"># Unbelievable as it may be, although the if else statement is not needed, having it here speeds up the script by approximately 8 times</span><br />				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$maxflank</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$entry</span> <span id="braces">(</span>@$entries_array_ref<span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="var">$entry_seq</span>;
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$strand</span> == 1<span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$entry_seq</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$chr_seq</span>,<span id="var">$entry</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span>+<span id="var">$maxflank</span>-<span id="var">$upflank</span>,<span id="var">$entry</span>-&gt;<span id="method">get_length</span>+<span id="var">$upflank</span>+<span id="var">$downflank</span><span id="braces">)</span>;
						<span id="braces">}</span>
						<span id="perlKey">else</span> <span id="braces">{</span>
							<span id="var">$entry_seq</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$chr_seq</span>,<span id="var">$entry</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span>+<span id="var">$maxflank</span>-<span id="var">$downflank</span>,<span id="var">$entry</span>-&gt;<span id="method">get_length</span>+<span id="var">$upflank</span>+<span id="var">$downflank</span><span id="braces">)</span>;
							<span id="var">$entry_seq</span> = <span id="perlFunc">reverse</span><span id="braces">(</span><span id="var">$entry_seq</span><span id="braces">)</span>;
							<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$entry_seq</span> =~ <span id="regExp">/U/i</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="var">$entry_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/UACGAuacga/</span>;
							<span id="braces">}</span>
							<span id="perlKey">else</span> <span id="braces">{</span>
								<span id="var">$entry_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/TACGAtacga/</span>;
							<span id="braces">}</span>
						<span id="braces">}</span>
						<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'UPDATE_SEQUENCE'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span><span id="var">$entry</span>-&gt;<span id="method">set_sequence</span><span id="braces">(</span><span id="var">$entry_seq</span><span id="braces">)</span>;<span id="braces">}</span>
						<span id="perlKey">my</span> <span id="var">$header</span> = <span id="var">$entry</span>-&gt;<span id="method">to_string</span><span id="braces">(</span><span id="dqStr">"BED"</span><span id="braces">)</span>;
						<span id="var">$header</span> =~ <span id="regExp">s/\t/|/g</span>;
						<span id="perlFunc">print</span> <span id="var">$OUT</span> <span id="dqStr">"&gt;$header\n$entry_seq\n"</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
				<span id="perlKey">else</span> <span id="braces">{</span>
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$entry</span> <span id="braces">(</span>@$entries_array_ref<span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="var">$entry_seq</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$chr_seq</span>,<span id="var">$entry</span>-&gt;<span id="method">get_start</span>,<span id="var">$entry</span>-&gt;<span id="method">get_length</span><span id="braces">)</span>;
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$strand</span> == -1<span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$entry_seq</span> = <span id="perlFunc">reverse</span><span id="braces">(</span><span id="var">$entry_seq</span><span id="braces">)</span>;
							<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$entry_seq</span> =~ <span id="regExp">/U/i</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="var">$entry_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/UACGAuacga/</span>;
							<span id="braces">}</span>
							<span id="perlKey">else</span> <span id="braces">{</span>
								<span id="var">$entry_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/TACGAtacga/</span>;
							<span id="braces">}</span>
						<span id="braces">}</span>
						<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'UPDATE_SEQUENCE'</span><span id="braces">}</span><span id="braces">)</span><span id="braces">{</span><span id="var">$entry</span>-&gt;<span id="method">set_sequence</span><span id="braces">(</span><span id="var">$entry_seq</span><span id="braces">)</span>;<span id="braces">}</span>
						<span id="perlKey">my</span> <span id="var">$header</span> = <span id="var">$entry</span>-&gt;<span id="method">to_string</span><span id="braces">(</span><span id="dqStr">"BED"</span><span id="braces">)</span>;
						<span id="var">$header</span> =~ <span id="regExp">s/\t/|/g</span>;
						<span id="perlFunc">print</span> <span id="var">$OUT</span> <span id="dqStr">"&gt;$header\n$entry_seq\n"</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE29" id="CODE29"></a>print_in_wiggle_format</td><td ><a href="#POD8">description</a></td><td ><a href="#CODE28">prev</a></td><td ><a href="#CODE30">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">print_in_wiggle_format</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$OUT</span>;
	<span id="perlKey">if</span> <span id="braces">(</span><span id="braces">(</span>!<span id="perlFunc">exists</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span> or <span id="braces">(</span><span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span> <span id="perlKey">eq</span> <span id="dqStr">"STDOUT"</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">open</span> <span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;&amp;="</span>,STDOUT<span id="braces">)</span>;
	<span id="braces">}</span>
	<span id="perlKey">else</span> <span id="braces">{</span>
		<span id="perlFunc">open</span><span id="braces">(</span><span id="var">$OUT</span>,<span id="dqStr">"&gt;"</span>,<span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'OUTPUT'</span><span id="braces">}</span><span id="braces">)</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">my</span> <span id="var">$window</span> = <span id="perlFunc">defined</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'WINDOW'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'WINDOW'</span><span id="braces">}</span> : 1000;
	<span id="perlKey">my</span> <span id="var">$step</span> = <span id="perlFunc">defined</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'STEP'</span><span id="braces">}</span> ? <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'STEP'</span><span id="braces">}</span> : 100;
	<span id="perlKey">my</span> <span id="var">$entries_ref</span> = <span id="var">$self</span>-&gt;<span id="method">entries</span>;
	<span id="var">$self</span>-&gt;<span id="method">sort_entries</span><span id="braces">(</span><span id="braces">)</span>;
	
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$entries_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">my</span> <span id="var">$lastend</span> = <span id="braces">(</span><span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$a</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span> &lt;=&gt; <span id="var">$b</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span><span id="braces">}</span> @<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span><span id="braces">[</span>-1<span id="braces">]</span>-&gt;<span id="method">get_stop</span><span id="braces">(</span><span id="braces">)</span>;
				<span id="perlKey">my</span> <span id="var">$last_positive_entry_index</span> = 0;
				<span id="perlFunc">print</span> <span id="var">$OUT</span> <span id="dqStr">"variableStep chrom=chr<span id="var">$chr</span> span=$step\n"</span>;
				<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$start</span> = <span id="var">$window</span>; <span id="var">$start</span> &lt; <span id="var">$lastend</span>; <span id="var">$start</span> += <span id="var">$step</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="var">$wiglocus</span> = <span id="module"><a href="Locus.html">GenOO::Locus</a></span>-&gt;<span id="perlKey">new</span><span id="braces">(</span><span id="braces">{</span>
						STRAND       =&gt; <span id="var">$strand</span>,
						CHR          =&gt; <span id="var">$chr</span>,
						START        =&gt; <span id="var">$start</span>,
						STOP         =&gt; <span id="braces">(</span><span id="var">$start</span>+<span id="var">$window</span>-1<span id="braces">)</span>
					<span id="braces">}</span><span id="braces">)</span>;
					<span id="perlKey">my</span> <span id="var">$score</span> = 0;
					<span id="perlKey">for</span> <span id="braces">(</span><span id="perlKey">my</span> <span id="var">$i</span> = <span id="var">$last_positive_entry_index</span>; <span id="var">$i</span>&lt; $#<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span>; <span id="var">$i</span>++<span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="var">$entry</span> = $<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span><span id="braces">[</span><span id="var">$i</span><span id="braces">]</span>;
						
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$wiglocus</span>-&gt;<span id="method">overlaps</span><span id="braces">(</span><span id="var">$entry</span><span id="braces">)</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$score</span>++;
							<span id="var">$last_positive_entry_index</span> = <span id="var">$i</span>;
						<span id="braces">}</span>
						<span id="perlKey">elsif</span> <span id="braces">(</span><span id="var">$wiglocus</span>-&gt;<span id="method">get_stop</span> &lt; <span id="var">$entry</span>-&gt;<span id="method">get_start</span><span id="braces">)</span> <span id="braces">{</span>
							<span id="perlKey">last</span>;
						<span id="braces">}</span>
					<span id="braces">}</span>
					<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$score</span> &gt; 0<span id="braces">)</span><span id="braces">{</span>
						<span id="perlFunc">print</span> <span id="var">$OUT</span> <span id="var">$wiglocus</span>-&gt;<span id="method">get_start</span>.<span id="dqStr">"\t"</span>.<span id="var">$score</span>.<span id="dqStr">"\n"</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> 0;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE30" id="CODE30"></a>reset_stats</td><td >description</td><td ><a href="#CODE29">prev</a></td><td ><a href="#CODE31">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">reset_stats</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="var">$self</span>-&gt;<span id="method">stats</span>-&gt;<span id="perlFunc">reset</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE31" id="CODE31"></a>set_description</td><td >description</td><td ><a href="#CODE30">prev</a></td><td ><a href="#CODE32">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_description</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="var">$self</span>-&gt;<span id="braces">{</span>DESCRIPTION<span id="braces">}</span>=<span id="var">$value</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$value</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE32" id="CODE32"></a>set_name</td><td >description</td><td ><a href="#CODE31">prev</a></td><td ><a href="#CODE33">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_name</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="var">$self</span>-&gt;<span id="braces">{</span>NAME<span id="braces">}</span>=<span id="var">$value</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$value</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE33" id="CODE33"></a>set_sequence_for_all_entries</td><td ><a href="#POD9">description</a></td><td ><a href="#CODE32">prev</a></td><td ><a href="#CODE34">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_sequence_for_all_entries</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$params</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$chr_folder</span> = <span id="perlFunc">delete</span> <span id="var">$params</span>-&gt;<span id="braces">{</span><span id="sqStr">'CHR_FOLDER'</span><span id="braces">}</span>;
	<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$chr_folder</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlFunc">die</span> <span id="dqStr">"Error. The CHR_FOLDER must be specified in "</span>.<span id="braces">(</span><span id="perlFunc">caller</span><span id="braces">(</span>0<span id="braces">)</span><span id="braces">)</span><span id="braces">[</span>3<span id="braces">]</span>.<span id="dqStr">"\n"</span>;
	<span id="braces">}</span>
	
	<span id="perlKey">my</span> <span id="var">$entries_ref</span> = <span id="var">$self</span>-&gt;<span id="method">entries</span>;
	<span id="perlKey">my</span> <span id="var">@chromosomes_for_all_strands</span> = <span id="var">$self</span>-&gt;<span id="method">chromosomes_for_all_strands</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="var">@chromosomes_for_all_strands</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">my</span> <span id="var">$chr_file</span> = <span id="var">$chr_folder</span>.<span id="dqStr">"/chr<span id="var">$chr</span>.fa"</span>;
		<span id="perlKey">if</span> <span id="braces">(</span>-e <span id="var">$chr_file</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">my</span> <span id="var">$chr_seq</span> = <span id="module"><a href="MySub.html">GenOO::MySub</a></span>::<span id="method">read_fasta</span><span id="braces">(</span><span id="var">$chr_file</span>,<span id="dqStr">"chr<span id="var">$chr</span>"</span><span id="braces">)</span>;
			<span id="perlKey">unless</span> <span id="braces">(</span><span id="perlFunc">defined</span> <span id="var">$chr_seq</span><span id="braces">)</span><span id="braces">{</span><span id="perlFunc">die</span> <span id="dqStr">"No Chromosome Sequence chr$chr\n"</span>;<span id="braces">}</span>
			
			<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$entries_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
					<span id="perlKey">my</span> <span id="var">$entries_array_ref</span> = $$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span>;
					<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$entry</span> <span id="braces">(</span>@$entries_array_ref<span id="braces">)</span> <span id="braces">{</span>
						<span id="perlKey">my</span> <span id="var">$entry_seq</span> = <span id="perlFunc">substr</span><span id="braces">(</span><span id="var">$chr_seq</span>,<span id="var">$entry</span>-&gt;<span id="method">get_start</span>,<span id="var">$entry</span>-&gt;<span id="method">get_length</span><span id="braces">)</span>;
						<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$strand</span> == -1<span id="braces">)</span> <span id="braces">{</span>
							<span id="var">$entry_seq</span> = <span id="perlFunc">reverse</span><span id="braces">(</span><span id="var">$entry_seq</span><span id="braces">)</span>;
							<span id="perlKey">if</span> <span id="braces">(</span><span id="var">$entry_seq</span> =~ <span id="regExp">/U/i</span><span id="braces">)</span> <span id="braces">{</span>
								<span id="var">$entry_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/UACGAuacga/</span>;
							<span id="braces">}</span>
							<span id="perlKey">else</span> <span id="braces">{</span>
								<span id="var">$entry_seq</span> =~ <span id="regExp">tr/ATGCUatgcu/TACGAtacga/</span>;
							<span id="braces">}</span>
						<span id="braces">}</span>
						<span id="var">$entry</span>-&gt;<span id="method">set_sequence</span><span id="braces">(</span><span id="var">$entry_seq</span><span id="braces">)</span>;
					<span id="braces">}</span>
				<span id="braces">}</span>
			<span id="braces">}</span>
		<span id="braces">}</span>
		<span id="perlKey">else</span> <span id="braces">{</span>
			<span id="perlFunc">warn</span> <span id="dqStr">"Skipping chromosome. File <span id="var">$chr_file</span> does not exist"</span>;
			<span id="perlKey">next</span>;
		<span id="braces">}</span>
	<span id="braces">}</span>
	<span id="perlKey">return</span> 0;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE34" id="CODE34"></a>set_species</td><td >description</td><td ><a href="#CODE33">prev</a></td><td ><a href="#CODE35">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">set_species</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span>, <span id="var">$value</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="var">$self</span>-&gt;<span id="braces">{</span>SPECIES<span id="braces">}</span>=<span id="var">$value</span> <span id="perlKey">if</span> <span id="perlFunc">defined</span> <span id="var">$value</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE35" id="CODE35"></a>sort_entries</td><td >description</td><td ><a href="#CODE34">prev</a></td><td ><a href="#CODE36">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">sort_entries</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	
	<span id="perlKey">my</span> <span id="var">$entries_ref</span> = <span id="var">$self</span>-&gt;<span id="method">entries</span>;
	<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$strand</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$entries_ref</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
		<span id="perlKey">foreach</span> <span id="perlKey">my</span> <span id="var">$chr</span> <span id="braces">(</span><span id="perlFunc">keys</span> %<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
			<span id="perlKey">if</span> <span id="braces">(</span><span id="perlFunc">exists</span> $$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">)</span> <span id="braces">{</span>
				@<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span> = <span id="perlFunc">sort</span> <span id="braces">{</span><span id="var">$a</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span> &lt;=&gt; <span id="var">$b</span>-&gt;<span id="method">get_start</span><span id="braces">(</span><span id="braces">)</span><span id="braces">}</span> @<span id="braces">{</span>$$entries_ref<span id="braces">{</span><span id="var">$strand</span><span id="braces">}</span><span id="braces">{</span><span id="var">$chr</span><span id="braces">}</span><span id="braces">}</span>;
			<span id="braces">}</span>
		<span id="braces">}</span>
	<span id="braces">}</span></pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE36" id="CODE36"></a>stats</td><td >description</td><td ><a href="#CODE35">prev</a></td><td ><a href="#CODE37">next</a></td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">stats</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">return</span> <span id="var">$self</span>-&gt;<span id="braces">{</span>STATS<span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<table id="methCodeTitle" width="100%"><tr><td width="200"><a name="CODE37" id="CODE37"></a>strands</td><td >description</td><td ><a href="#CODE36">prev</a></td><td >next</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="methCodeArea"><td ><span id="sub">sub</span> <span id="subName">strands</span>
{<pre>	<span id="perlKey">my</span> <span id="braces">(</span><span id="var">$self</span><span id="braces">)</span> = <span id="var">@_</span>;
	<span id="perlKey">return</span> <span id="perlFunc">keys</span> %<span id="braces">{</span><span id="var">$self</span>-&gt;<span id="method">entries</span><span id="braces">}</span>;</pre>}</td></div>
<div id="sep"></div>
<a name="General" id="General"></a>
<div id="mainTitle">General documentation</div>
<div id="sep"></div>
<table id="genInfoTitle" width="100%"><tr><td><a name="_pod_EXAMPLES" id="_pod_EXAMPLES"></a>EXAMPLES</td><td align="right"><a href="#TOP">Top</a></td></tr></table>
<div id="genInfoArea"><pre id="podParagraph">    # Print entries in FASTA format
    $locus_collection->print("FASTA",'STDOUT',"/data1/data/UCSC/hg19/chromosomes/");
    
    # ditto
    $locus_collection->print_in_fasta_format('STDOUT',"/data1/data/UCSC/hg19/chromosomes/");</pre></div>
<div id="sep"></div>
</body>
</html>
